/**
 * CONFIDENTIAL MATERIAL. DO NOT DISTRIBUTE.
 * Copyright (c) 2013-2020, Flipboard, Inc. All Rights Reserved.
 */
!function(){var e={},t={};window.require=function(n){if(!t[n]){var i={},r={},o=e[n];t[n]={},o(i,r),t[n]=i.exports||r}return t[n]},window.require.define=function(t,n){e[t]=n}}(),require.define("blend/tick",function(e){var t,n,i,r;i=function(e){return setTimeout(e,0)},"function"==typeof("undefined"!=typeof process&&null!==process?process.nextTick:void 0)?n=process.nextTick:"function"==typeof setImmediate?n=setImmediate:"function"==typeof MessageChannel?(r=[],t=new MessageChannel,t.port1.onmessage=function(){var e,t;for(t=null,e=0;t=r[e++];)t();return r=[]},n=function(e){return r.push(e),t.port2.postMessage("")}):n=i,e.exports=n}),require.define("blend/async",function(e,t){var n,i,r,o,s,a,l,u,c={}.hasOwnProperty,d=function(e,t){function n(){this.constructor=e}for(var i in t)c.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};u=require("blend/tick"),t.defer=s=function(){var e,t,r,o,a,l,c;return c=null,o=[],t=[],l="pending",e=function(e,n){var i;if(void 0!==o)return i=o,o=void 0,c=e,l=n?"rejected":"fulfilled",u(function(){var e,n,r;for(n=0,r=i.length;r>n;n++)e=i[n],e();return t=void 0})},r=function(e){return void 0!==o&&void 0!==t?u(function(){var n,i,r,o;for(o=[],i=0,r=t.length;r>i;i++)n=t[i],o.push(n(e));return o}):void 0},a=function(e){return void 0!==t&&"function"==typeof e?t.push(e):void 0},{resolve:function(t){return e(t,!1)},reject:function(t){return e(t,!0)},notify:function(e){return r(e)},promise:{then:function(e,t,n){var r,d;return r=s(),d=function(){var n,o,s,a,u;if(a="rejected"===l,n=a?t:e,"function"!=typeof n)return a?r.reject(c):r.resolve(c);s=void 0;try{return u=n.call(void 0,c)}catch(d){return o=d,s=o,r.reject(s),"undefined"!=typeof console&&null!==console?"function"==typeof console.error?console.error(null!=o?o.stack:void 0):void 0:void 0}finally{void 0===s&&i(r,u)}},a(function(e){var t;return t=null!=n?n(e):e,r.notify(t)}),void 0===o?u(d):o.push(d),r.promise},progress:function(e){return a(e),this},"catch":function(e){return this.then(void 0,e)},cancel:function(){var t;return"pending"===l?(t=new n,e(t,!0)):void 0},tap:function(e){return this.then(function(t){return e(t),t})}}}},n=function(e){function t(e){this.message=e,this.name="CancellationError",this.stack=(new Error).stack}return d(t,e),t}(Error),t.CancellationError=n,i=function(e,t){var n,r,o,s,u,c;if(l(t))return t.then(function(t){return e.resolve(t)},function(t){return e.reject(t)});if(!a(t))return e.resolve(t);n=void 0,o=void 0;try{return n=t.then}catch(d){return r=d,o=r,e.reject(o)}finally{if(!o)if("function"==typeof n){c=!1,u=function(t){return c?void 0:(c=!0,i(e,t))},s=function(t){return c?void 0:(c=!0,e.reject(t))};try{n.call(t,u,s)}catch(d){r=d,c||e.reject(r)}}else e.resolve(t)}},t.resolve=function(e){var t,n,i;return i=s(),n=i.resolve,t=i.promise,n(e),t},t.reject=function(e){var t,n,i;return i=s(),n=i.reject,t=i.promise,n(e),t},t.props=function(e){var n,i,r,s,a;null==e&&(e={}),i=[],s=[];for(n in e)a=e[n],r=a,l(a)||(r=t.resolve(r)),s.push(r),i.push(n);return o(s).then(function(e){var t,n,r,o;for(n={},t=r=0,o=e.length;o>r;t=++r)a=e[t],n[i[t]]=a;return n})},t.all=o=function(e){var t,i,r,o,a,l,u,c;return null==e&&(e=[]),u=s(),i=u.promise,t=u.notify,o=u.resolve,r=u.reject,c=[0,[]],a=c[0],l=c[1],e=e.filter(function(e){return"function"==typeof(null!=e?e.then:void 0)}),e.forEach(function(n,i){return n.progress(function(e){return t({index:i,value:e})}).then(function(t){return l[i]=t,++a===e.length?o(l):void 0})["catch"](r)}),i["catch"](function(t){return t instanceof n?e.forEach(function(e){return e.cancel()}):void 0}),i},r=function(e){function t(e){this.message=e,this.name="TimeoutError",this.stack=(new Error).stack}return d(t,e),t}(Error),t.TimeoutError=r,t.timeout=function(e,t,i){var o,a,l,u,c,d,p;return null==t&&(t=5e3),null==i&&(i="timed out"),p=s(),a=p.promise,o=p.notify,c=p.resolve,l=p.reject,u=function(){return l(new r(i))},d=setTimeout(u,t),a["catch"](function(e){return e instanceof n?clearTimeout(d):void 0}),e.then(function(e){return clearTimeout(d),c(e)},function(e){return clearTimeout(d),l(e)},o),a},a=function(e){return"function"==typeof e||"object"==typeof e&&null!==e},l=function(e){return"function"==typeof(null!=e?e.then:void 0)}}),require.define("blend/lang",function(e,t){var n,i=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};t.mixin=function(e,t){var n,i,r;for(n in t)i=t[n],e[n]=i;r=t.prototype;for(n in r)i=r[n],e.prototype?e.prototype[n]=i:e[n]=i;return e},t.deepCopy=function(e){var t,n;t=void 0;try{t=JSON.parse(JSON.stringify(e))}catch(i){n=i,console.log("Error parsing object",e)}return t},t.merge=function(e,t){var n,i;if("object"==typeof e&&"object"==typeof t){for(n in t)i=t[n],t.hasOwnProperty(n)&&(void 0===e[n]||null===e[n])&&(e[n]=i);return e}},t.shallowEquals=function(e,t){var n,i,r;try{for(i in e)if(r=e[i],r!==t[i])return!1;for(i in t)if(r=t[i],r!==e[i])return!1}catch(o){return n=o,!1}return!0},t.values=function(e){return null==e&&(e={}),Object.keys(e).map(function(t){return e[t]})},t.arrayCopy=function(e){return Array.prototype.slice.apply(e)},t.arrayShuffle=function(e){var t,n,i;for(t=e.length;--t>0;)n=~~(Math.random()*(t+1)),i=e[n],e[n]=e[t],e[t]=i;return e},t.arrayCompare=function(e,t){var n,i,r,o;if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(n=r=0,o=e.length;o>r;n=++r)if(i=e[n],t[n]!==i)return!1;return!0},t.isArray=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},t.defaultCmp=function(e,t){switch(!1){case!(t>e):return-1;case!(e>t):return 1;default:return 0}},n=function(e,t,n){var i,r,o,s,a;for(null==n&&(n=defaultCmp),a=0,s=e.length-1;s>=a;)switch(r=0|(a+s)/2,i=e[r],o=n(i,t)){case-1:a=r+1;break;case 1:s=r-1;break;default:return r}return r},t.binarySearch=function(e,t,i){var r;return null==i&&(i=defaultCmp),r=n(e,t,i),0===i(e[r],t)?r:-1},t.sortedInsert=function(e,t,i){var r,o,s;return null==i&&(i=defaultCmp),0===e.length?e.push(t):(o=n(e,t,i),r=e[o],s=function(){switch(i(r,t)){case-1:return o+1;case 1:return o;case 0:return o}}(),e.splice(s,0,t)),e},t.sortedGetRange=function(e,t,i,r){var o,s;if(null==r&&(r=defaultCmp),1===r(t,i))throw new Error("lower element is greater than upper lement");return 0===e.length?[]:1===r(t,e[e.length-1])?[]:-1===r(i,e[0])?[]:(o=n(e,t,r),s=n(e,i,r),-1===r(e[o],t)&&(o=Math.min(o+1,e.length-1)),1===r(e[s],i)&&(s=Math.max(s-1,0)),e.slice(o,+s+1||9e9))},t.flatten=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},t.intersection=function(e,t){var n,r,o,s,a;for(e.length>t.length&&(s=[t,e],e=s[0],t=s[1]),a=[],r=0,o=e.length;o>r;r++)n=e[r],i.call(t,n)>=0&&a.push(n);return a},t.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},t.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t,n;return t=0|16*Math.random(),n="x"===e?t:8|3&t,n.toString(16)})},t.throttled=function(e,t){var n,i;return i=null,n=function(){return i&&clearTimeout(i),i=setTimeout(e,t)}},t.htmlEncode=function(e){var t;return e?(t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},e.toString().replace(/[&<>"'\/]/g,function(e){return t[e]||""})):e},t.strExistMatch=function(e,t){return null==e||null==t?!1:e.toString()===t.toString()},t.truncateStr=function(e,t){return e.length>t?e.substr(0,t)+"...":e},t.regexEscape=function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},t.stringToNumber=function(e){var t,n,i,r,o;if(n=0,0===e.length)return n;for(i=r=0,o=e.length;o>=0?o>r:r>o;i=o>=0?++r:--r)t=e.charCodeAt(i),n=(n<<5)-n+t,n|=0;return Math.abs(n)},t.stringArrayDedupe=function(e){var t,n,i,r;for(null==e&&(e=[]),t=[],i=0,r=e.length;r>i;i++)n=e[i],-1===t.indexOf(n)&&t.push(n);return t}}),require.define("blend/http",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C,T,q,P,E;i=require("blend/async"),v=require("blend/lang"),g=!1,l=null,s={},y=null,d=function(e){return T("GET",e)},C=function(e){var t;return null==e.headers&&(e.headers={}),null==(t=e.headers)["Content-Type"]&&(t["Content-Type"]="application/x-www-form-urlencoded"),T("POST",e)},c=function(e){var t;return null==e.headers&&(e.headers={}),null==(t=e.headers)["Content-Type"]&&(t["Content-Type"]="application/x-www-form-urlencoded"),T("DELETE",e)},T=function(e,t){var n,o,s,l,c,d,p,h,f,m,x;if(t=b(t),p={},t=u(t,e),g&&(t.cache||(t.params._=Date.now())),h=k(t,e),s=t.headers,s=v.merge(s,a(h)),t.streaming&&t.backgroundWorkerUrl&&"undefined"!=typeof Worker&&null!==Worker&&(c=r(e,h,s,t.backgroundWorkerUrl),null!=c))return c;n=i.defer(),m=new XMLHttpRequest;try{m.open(e,h.href,!0);for(l in s)f=s[l],m.setRequestHeader(l,f);m.withCredentials=!0,m.onreadystatechange=function(){return 4===m.readyState?(y&&y(""+e+" Response "+m.status+" "+h.href+" jobid="+m.getResponseHeader("fl-job-id")+" tuuid="+t.params.tuuid+" udid="+t.params.udid),t.streaming&&_(t,m,p,n),w(t,m,n)):3===m.readyState&&t.streaming?_(t,m,p,n):void 0},y&&y(""+e+" Request "+h.href+" tuuid="+t.params.tuuid+" udid="+t.params.udid),"POST"===e?m.send(null!=(x=t.body)?x:E(t.params,!0)):m.send()}catch(S){o=S,n.reject(o)}return n.promise.abort=function(){return m.abort()},n.promise.getResponseHeader=function(e){return m.getResponseHeader(e)},c=n.promise,t.streaming?(d=[],c.progress(function(e){return d.push(e)}),c.then(function(){return d})):c},r=function(e,t,n,r){var o,s,a;o=i.defer();try{a=new Worker(r),a.onmessage=function(e){return e.data.error?o.reject(e.data.error):e.data.complete?200===e.data.status?o.resolve():o.reject(e.data.status):o.notify(e.data.item)},a.onerror=function(e){return o.reject(e)},a.postMessage({method:e,url:t,headers:n}),o.promise.abort=function(){return a.postMessage("abort")}}catch(l){return s=l,null}return o.promise},I=function(e,t){var n;return null==t&&(t=!1),n={},null!=e&&e.replace(/(^|[?&]+)([^=&?]+)=([^&]*)/gi,function(e,i,r,o){return n[r]=t?decodeURIComponent(o):o}),n},E=function(e,t){var n,i,r,o,s,a,l;null==e&&(e={}),null==t&&(t=!1),r="",i=0;for(n in e)for(s=e[n],s=Array.isArray(s)?s:[s],a=0,l=s.length;l>a;a++){switch(o=s[a],o=encodeURIComponent(o),i){case 0:r+=""+(t?"":"?")+n+"="+o;break;default:r+="&"+n+"="+o}i++}return r},n=function(e,t,n){var i,r,o,s;return null==e&&(e=""),s=e.split("?"),i=s[0],o=s[1],r=I(o,!0),r[t]=n,""+i+E(r)},m=["host","hostname","port","protocol","search","pathname","href"],o=function(e,t){var n,i;return i=""+e+":"+t,n=window.btoa(i),"Basic "+n},u=function(e,t){var n,i,r,o,s,a;null==e&&(e={}),null==t&&(t="GET"),null==e.path&&(e.path="/"),null==e.params&&(e.params={}),null==e.headers&&(e.headers={}),null==e.streaming&&(e.streaming=!1),"undefined"==typeof(null!=(s=e.params)?s.lang:void 0)&&("undefined"!=typeof window&&null!==window?window.location:void 0)&&(i=I(window.location.search).lang,i&&(e.params.lang=i)),!g||"GET"!==t&&"HEAD"!==t||null==e.cache&&(e.cache=!1),r={},a=e.params;for(n in a)o=a[n],null!=o&&(r[n]=o);return e.params=r,e},a=function(e){var t;return t={},(e.host===window.location.host||e.host===(null!=l?l.host:void 0))&&(t["X-Requested-With"]="XMLHttpRequest"),e.host===(null!=l?l.host:void 0)&&null!=(null!=s?s.user:void 0)&&null!=(null!=s?s.password:void 0)&&(t.Authorization=o(s.user,s.password)),t},p=function(e){var t,n,i,r;n={},t=document.createElement("a"),t.href=e;for(i in t)r=t[i],m.indexOf(i)>-1&&(n[i]=r);return n},b=function(e){var t;return"string"==typeof e&&(t=e,e={},e["/"===t[0]?"path":"url"]=t),e},k=function(e,t){var n,i,r,o,s,a,u,c;return null==e&&(e={}),null==t&&(t="GET"),(null!=(r=e.url)?r.length:void 0)>0?i=p(e.url):(n=null!=l?l:window.location,i={},i.host=null!=(o=e.host)?o:n.host,i.hostname=null!=(s=e.hostname)?s:n.hostname,i.port=null!=(a=e.port)?a:n.port,i.protocol=null!=(u=e.protocol)?u:n.protocol,(null!=e.body||-1!==["GET","DELETE"].indexOf(t))&&(i.search=E(e.params)),i.pathname=null!=(c=e.path)?c:"/","/"!==i.pathname[0]&&(i.pathname="/"+i.pathname),i.href=""+i.protocol+"//"+i.host+i.pathname+(i.search||"")),i},x=function(e){return k(b(e))},q=function(e,t){return null==t&&(t={}),(null!=e?e.length:void 0)>0?(l=p(e),s=t):void 0},w=function(e,t,n){var i,r,o;if(200===t.status){if(o=t.responseText,h(t)&&!e.streaming)try{o=JSON.parse(o)}catch(s){i=s,n.reject(i)}return n.resolve(o)}try{r=JSON.parse(t.responseText)}catch(s){i=s,r=t.responseText}return n.reject({response:r,status:t.status})},_=function(e,t,n,i){var r,o,s,a;for(null==n.currentPosition&&(n.currentPosition=0),null==n.buffer&&(n.buffer=""),n.buffer=t.responseText.substr(n.currentPosition),s=n.buffer.indexOf("\n"),a=[];-1!==s;){o=n.buffer.slice(0,s),n.currentPosition+=s+1;try{o=JSON.parse(o)}catch(l){r=l,i.reject(r)}i.notify(o),n.buffer=t.responseText.substr(n.currentPosition),a.push(s=n.buffer.indexOf("\n"))}return a},h=function(e){var t;return t=e.getResponseHeader("Content-Type"),/application\/json/.test(t)},P=function(e){return y=e},f="#!",S=function(){var e,t,n,i;return e={path:null,params:{}},t=window.location.hash.indexOf(f),t>-1&&(i=window.location.hash.substr(t+f.length),n=i.split("?"),e.path=n[0].replace(/^\//,""),n.length>1&&(e.params=I("?"+n[1]))),e},t.get=d,t.post=C,t.del=c,t.parseQuery=I,t.parseUrl=k,t.parseAndNormalizeUrlOptions=x,t.defaultOptions=u,t.stringifyQuery=E,t.setDefaultLocation=q,t.parseHashbang=S,t.addOrReplaceQueryParam=n,t.setLogger=P}),require.define("blend/jsonp",function(e,t){var n,i,r,o,s;o=require("blend/http"),r=require("blend/async"),i=1,n="data-fl-jsonp",s=null,t.request=function(e){var t,a,l,u;return a=r.defer(),l=document.createElement("script"),null==e.params&&(e.params={}),e.params.jsonp=1,t="jsonpcallback"+i,e.params.callback=t,window[t]=function(e){return a.resolve(e),a=void 0,document.getElementsByTagName("head")[0].removeChild(l),delete window[t]},i+=1,u=e.url+o.stringifyQuery(e.params),l.src=u,l.setAttribute(n,"1"),s&&s("JSONP request: "+u),l.onerror=function(){return a.reject(),a=void 0,s?s("JSONP script onerror: "+u):void 0},document.getElementsByTagName("head")[0].appendChild(l),a.promise},t.scriptIsJSONP=function(e){return"1"===(null!=e?e.getAttribute(n):void 0)},t.setLogger=function(e){return s=e}}),require.define("blend/events",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g;d=require("blend/lang"),n=function(){function e(){}return e.prototype.handles=null,e.prototype.on=function(e,t,n){var i,r,o,s,a,l,u=this;for(null==n&&(n=t),null==this.handles&&(this.handles={}),null==(o=this.handles)[e]&&(o[e]=[]),i={detach:function(){return u.off(e,t,n)}},l=this.handles[e],s=0,a=l.length;a>s;s++)if(r=l[s],r.handle===t&&r.scope===n)return i;return this.handles[e].push({handle:t,scope:n}),i},e.prototype.off=function(e,t,n){var i,r,o,s,a,l,u;if("*"===e)return this.handles={},void 0;for(null==n&&(n=t),null==this.handles&&(this.handles={}),l=null!=(a=this.handles[e])?a:[],u=[],r=o=0,s=l.length;s>o;r=++o){if(i=l[r],i.handle===t&&i.scope===n){this.handles[e].splice(r,1);break}u.push(void 0)}return u},e.prototype.once=function(e,t,n){var i,r=this;return null==n&&(n=t),null==this.handles&&(this.handles={}),i=function(o){return t(o),r.off(e,i,n)},this.on(e,i,n)},e.prototype.emit=function(e,t){var n,i,r,o,s,a,l,u,c;for(null==t&&(t={}),null==t.target&&(t.target=this),null==t.type&&(t.type=e),n=!1,o=!1,null==t.preventDefault&&(t.preventDefault=function(){return n=!0}),null==t.stopPropagation&&(t.stopPropagation=function(){return o=!0}),null==t.halted&&(t.halted=function(){return n}),r=d.arrayCopy(null!=(l=null!=(u=this.handles)?u[e]:void 0)?l:[]),r=r.reverse(),c=[],s=0,a=r.length;a>s;s++)i=r[s],o?c.push(void 0):c.push(i.handle.call(i.scope,t));return c},e}(),i=function(e,t,n,i){var r;return null==i&&(i=!1),"string"==typeof e&&(e=document.querySelector(e)),s[t]?(s[t][0](e,t,n,i),r=function(){return s[t][1](e,t,n,i)}):(null!=e&&e.addEventListener(t,n,i),r=function(){return e.removeEventListener(t,n,i)}),{detach:r}},u=function(e,t,n,i){return null==i&&(i=!1),"string"==typeof e&&(e=document.querySelector(e)),e.removeEventListener(t,n,i)},r=function(e,t,n,r){var o,s;return null==r&&(r=!1),"string"==typeof e&&(e=document.querySelector(e)),s=function(e){return n(e),o.detach()},o=i(e,t,s,r)},l=[],c=function(e,t){var n,i,r;for(i=0,r=l.length;r>i;i++)if(n=l[i],n.node===e&&n.type===t)return n;return void 0},a=function(e,t,n,r){var o,s,a,u,d;return"string"==typeof e&&(e=document.querySelector(e)),a=document.documentElement,o=c(a,n),o||(o={node:a,type:n,handles:[],event:void 0},l.push(o),u=function(e){var t,n,i,r,s,a,l,c,d;for(t=e.target,r=!1,d=[];t&&!r;){for(l=o.handles.slice().reverse(),s=0,a=l.length;a>s;s++)if(u=l[s],null!=(c=u.node)?c.contains(t):void 0){if(r)break;"function"==typeof u.fn&&p.call(t,u.sel)&&(i=function(){return Event.prototype.stopPropagation.call(e)},e.stopPropagation=function(){return r=!0,i()},e.matchedTarget=t,n=u.fn(e),r||(r=n===!1))}if(r)break;d.push(t=t.parentNode)}return d},o.event=i(a,n,u,!0)),s={sel:t,node:e,fn:r},o.handles.push(s),d={detach:function(){var e;return o.handles=o.handles.filter(function(e){return e!==s}),0===o.handles.length?(o.event.detach(),e=l.indexOf(o),l.splice(e,1)):void 0}}},p=null!=(f=null!=(m=null!=(g=Element.prototype.matches)?g:Element.prototype.webkitMatchesSelector)?m:Element.prototype.mozMatchesSelector)?f:Element.prototype.msMatchesSelector,s={},o=function(e,t){var n,i,r;null==t&&(t={}),n=void 0,"click"===e?(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null)):(n=document.createEvent("Event"),n.initEvent(e,!0,!0,window));for(i in t)r=t[i],n[i]=r;return n.generated=!0,n},h=function(e,t,n){return s[e]&&console.warn("Overwriting existing "+e+" event registration."),s[e]=[t,n]},t.Emitter=n,t.on=i,t.off=u,t.once=r,t.delegate=a,t.create=o,t.register=h}),require.define("blend/features",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C,T,q,P,E,L,A,N,R,F,M,O,B,U,D,z,H,G,j,W,V=[].slice;o=require("blend/events"),p=require("blend/tick"),l=require("blend/http"),F=window,S=document.createElement("div"),x=function(e,t){return null==t&&(t=S),void 0!==t.style[e]?e:void 0},t.test=function(){return x(prop)},t.touch="ontouchstart"in window,t.pointer=navigator.pointerEnabled||navigator.msPointerEnabled,t.arm=null!=(G=navigator.cpuClass)?G.match(/arm/i):void 0,t.ie=/Trident/i.test(navigator.userAgent),t.webkit=/WebKit/i.test(navigator.userAgent),t.moz=/Firefox/i.test(navigator.userAgent),t.safari=/Safari/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent),t.chrome=/(Chrome|CriOS)/i.test(navigator.userAgent),t.android=/Android/i.test(navigator.userAgent),t.iphone=/iP(hone|od)/i.test(navigator.userAgent),t.ipad=/iP(ad)/i.test(navigator.userAgent),t.winphone=/IEMobile/i.test(navigator.userAgent),t.win8=/Windows NT 6.3/i.test(navigator.userAgent),t.ios=t.iphone||t.ipad,N="",t.ie&&(N="ie"),t.moz&&(N="moz"),t.safari&&(N="safari"),t.chrome&&(N="chrome"),t.android&&(N="android"),t.iphone&&(N="iphone"),t.ipad&&(N="ipad"),t.ua=N,navigator.pointerEnabled?(t.pointerDown="pointerdown",t.pointerMove="pointermove",t.pointerUp="pointerup",t.pointerOut="pointerout",t.pointerCancel="pointercancel"):navigator.msPointerEnabled&&(t.pointerDown="MSPointerDown",t.pointerMove="MSPointerMove",t.pointerUp="MSPointerUp",t.pointerOut="MSPointerOut",t.pointerCancel="MSPointerCancel"),I=x("webkitTransform"),null==I&&(I=x("mozTransform")),null==I&&(I=x("msTransform")),null==I&&(I=x("transform")),t.transform=I,C=x("webkitTransformOrigin"),null==C&&(C=x("mozTransformOrigin")),null==C&&(C=x("msTransformOrigin")),null==C&&(C=x("transformOrigin")),t.transformOrigin=C,m=x("webkitPerspective"),null==m&&(m=x("mozPerspective")),null==m&&(m=x("msPerspective")),null==m&&(m=x("perspective")),t.perspective=m,k=m,t.chrome&&"function"==typeof F.matchMedia&&(k=F.matchMedia("(transform-3d),(-webkit-transform-3d)").matches),t.transform3d=k,E=x("WebkitTransition")?"webkitTransitionEnd":void 0,null==E&&(E=x("MozTransition")?"transitionend":void 0),null==E&&(E=x("transition")?"transitionend":void 0),t.transitionEnd=E,t.transitions=void 0!==E,L=x("webkitTransitionProperty"),null==L&&(L=x("mozTransitionProperty")),null==L&&(L=x("msTransitionProperty")),null==L&&(L=x("transitionProperty")),t.transitionProperty=L,P=x("webkitTransitionDuration"),null==P&&(P=x("mozTransitionDuration")),null==P&&(P=x("msTransitionDuration")),null==P&&(P=x("transitionDuration")),t.transitionDuration=P,q=x("webkitTransitionDelay"),null==q&&(q=x("mozTransitionDelay")),null==q&&(q=x("msTransitionDelay")),null==q&&(q=x("transitionDelay")),t.transitionDelay=q,A=x("webkitTransitionTimingFunction"),null==A&&(A=x("mozTransitionTimingFunction")),null==A&&(A=x("msTransitionTimingFunction")),null==A&&(A=x("transitionTimingFunction")),t.transitionTimingFunction=A,T=x("webkitTransition"),null==T&&(T=x("mozTransition")),null==T&&(T=x("msTransition")),null==T&&(T=x("transition")),t.transition=T,n=x("webkitAnimation"),null==n&&(n=x("mozAnimation")),null==n&&(n=x("animation")),r=x("WebkitAnimation")?"webkitAnimationName":void 0,null==r&&(r=x("MozAnimation")?"mozAnimationName":void 0),null==r&&(r=x("animation")?"animationName":void 0),i=x("WebkitAnimation")?"webkitAnimationEnd":void 0,null==i&&(i=x("MozAnimation")?"animationend":void 0),null==i&&(i=x("animation")?"animationend":void 0),t.animation=n,t.animationName=r,t.animationEnd=i,t.animations=void 0!==n,c=x("WebkitAnimation")?"-webkit-keyframes":void 0,null==c&&(c=x("MozAnimation")?"-moz-keyframes":void 0),null==c&&(c=x("animation")?"keyframes":void 0),t.keyframesCSS=c,t.forceAnimSetupLayout=t.ie||t.moz,g=F.webkitRequestAnimationFrame,null==g&&(g=F.mozRequestAnimationFrame),null==g&&(g=F.requestAnimationFrame),t.requestAnimationFrame=g,f={},"undefined"!=typeof document.mozHidden?(f.hidden="mozHidden",f.change="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(f.hidden="msHidden",f.change="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(f.hidden="webkitHidden",f.change="webkitvisibilitychange"):"undefined"!=typeof document.hidden&&(f.hidden="hidden",f.change="visibilitychange"),t.pageVisibility=f,R=x("webkitUserSelect"),null==R&&(R=x("mozUserSelect")),null==R&&(R=x("msUserSelect")),null==R&&(R=x("userSelect")),t.userSelect=R,_=0,w=document.createElement("div"),w.style.cssText="width:100%;height:100px;overflow:scroll;",document.body.appendChild(w),b=w.clientHeight,document.body.removeChild(w),t.scrollbarSize=100-b,t.innerWidth=function(){return F.innerWidth-t.scrollbarSize},t.jsToCss=function(e){var t,n,i,r;for(t="",n=i=0,r=e.length;r>=0?r>i:i>r;n=r>=0?++i:--i)t+=e[n]===e[n].toUpperCase()?"-"+e[n].toLowerCase():e[n];return t=t.replace(/^webkit\-/,"-webkit-"),t=t.replace(/^moz\-/,"-moz-"),t=t.replace(/^ms\-/,"-ms-")},t.cssToJs=function(e){var t;return t="","-"===e[0]&&(e=e.substr(1)),t=e.replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},null==(M=Function.prototype).bind&&(M.bind=function(){var e,t,n=this;return e=arguments[0],t=2<=arguments.length?V.call(arguments,1):[],null==e&&(e=this),function(){var i;return i=1<=arguments.length?V.call(arguments,0):[],n.apply(e,t.concat(i))}}),y=0,v=null,null==F.requestAnimationFrame&&(F.requestAnimationFrame=F.webkitRequestAnimationFrame),null==F.requestAnimationFrame&&(F.requestAnimationFrame=F.mozRequestAnimationFrame),null==F.requestAnimationFrame&&(F.requestAnimationFrame=function(e){var t,n;return t=Date.now(),n=Math.max(0,1e3/60-(t-y)),v=setTimeout(function(){return e(t+n)},n),y=t+n,v}),null==F.cancelAnimationFrame&&(F.cancelAnimationFrame=F.webkitCancelAnimationFrame),null==F.cancelAnimationFrame&&(F.cancelAnimationFrame=F.mozCancelAnimationFrame),null==F.cancelAnimationFrame&&(F.cancelAnimationFrame=function(e){return clearTimeout(e)}),t.fullscreenElement=function(){var e,t,n;return null!=(e=null!=(t=null!=(n=document.fullscreenElement)?n:document.webkitFullscreenElement)?t:document.mozFullScreenElement)?e:document.msFullscreenElement},t.requestFullscreen=function(e){return e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():void 0},t.exitFullscreen=function(){return document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():void 0},s="fullscreenchange",document.webkitExitFullscreen?s="webkitfullscreenchange":document.msExitFullscreen?s="MSFullscreenChange":document.mozCancelFullScreen&&(s="mozfullscreenchange"),t.fullscreenchange=s,!t.winphone||"onorientationchange"in F||(F.orientation=F.innerWidth>F.innerHeight?90:0,o.on(F,"resize",function(){var e;return e=F.innerWidth>F.innerHeight?90:0,e!==F.orientation?(F.orientation=e,p(function(){return F.dispatchEvent(o.create("orientationchange"))})):void 0}),a={get:function(){var e;return null!=(e=this._onorientationchange)?e:null},set:function(e){return this._onorientationchange=e,o.on(F,"orientationchange",e)}},Object.defineProperty(F,"onorientationchange",a),Object.defineProperty(F,"onOrientationChange",a)),null==window.console&&(window.console={}),h=function(){},d=function(){return console.log.apply(console,arguments)},null==window.console.log&&(d=h),j=["debug","dir","dirxml","error","info","log","trace","warn"];for(U=0,z=j.length;z>U;U++)u=j[U],null==(O=window.console)[u]&&(O[u]=d);for(W=["assert","clear","count","group","groupCollapsed","groupEnd","profile","profileEnd","time","timeEnd","timeStamp"],D=0,H=W.length;H>D;D++)u=W[D],null==(B=window.console)[u]&&(B[u]=h)}),require.define("blend/dom",function(e,t){var n,i,r,o,s=[].slice;r=require("blend/features"),i=document,t.create=function(e){var n;return n=document.createElement("div"),t.setInnerHTML(n,e),1===n.children.length?n.children[0]:n},t.createFragment=function(e){var n,i;for(i=document.createElement("div"),n=document.createDocumentFragment(),t.setInnerHTML(i,e);i.firstChild;)n.appendChild(i.firstChild);return n},t.one=function(e,t){return null==t&&(t=i),"object"==typeof e?e:t.querySelector(e)},t.all=function(e,t){return null==t&&(t=i),Array.prototype.slice.apply(t.querySelectorAll(e))},t.childNodes=function(e){return Array.prototype.slice.apply(e.childNodes)},t.siblings=function(e){return t.childNodes(e.parentNode).filter(function(t){return t!==e})},t.createCSSRule=function(e){var t,n,i,r;return n=document.styleSheets[document.styleSheets.length-1],null==n.cssRules&&(r=document.createElement("style"),document.head.appendChild(r),n=document.styleSheets[document.styleSheets.length-1]),n.insertRule(e,n.cssRules.length),i=n.cssRules[n.cssRules.length-1],t=function(){var e,t,r;for(e=t=r=n.cssRules.length-1;t>=0;e=t+=-1)if(n.cssRules[e]===i)return n.deleteRule(e),void 0},{rule:i,destroy:t}},t.setInnerHTML=function(e,n){return"string"==typeof e&&(e=t.one(e)),null!=e?e.innerHTML=n:void 0},t.ancestor=function(e,n){return e===document.documentElement?null:n(e)?e:e?t.ancestor(e.parentNode,n):void 0},t.ancestorByClassName=function(e,n){var i;return i=function(e){var t;return null!=e?null!=(t=e.classList)?t.contains(n):void 0:void 0},t.ancestor(e,i)},t.ancestorByTagName=function(e,n){var i;return i=function(e){var t;return(null!=e?null!=(t=e.tagName)?t.toLowerCase():void 0:void 0)===n.toLowerCase()},t.ancestor(e,i)},t.ancestorByAttribute=function(e,n,i){var r;return r=function(e){return(null!=e?"function"==typeof e.getAttribute?e.getAttribute(n):void 0:void 0)===i},t.ancestor(e,r)},t.append=function(e,t){return null==t&&(t=i.body),e=o(e),t.appendChild(e)},t.prepend=function(e,t){return null==t&&(t=i.body),e=o(e),null!=t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},t.remove=function(e){var t;return e=o(e),null!=e?null!=(t=e.parentNode)?t.removeChild(e):void 0:void 0},n="data-fl",t.getCustomAttribute=function(e,t){return e.getAttribute(""+n+"-"+t)},t.hasCustomAttribute=function(e,t){return e.hasAttribute(""+n+"-"+t)},t.setCustomAttribute=function(e,t,i){null==i&&(i=""),e.setAttribute(""+n+"-"+t,i)},t.removeCustomAttribute=function(e,t){e.removeAttribute(""+n+"-"+t)},o=function(e){return"string"==typeof e?t.one(e):e},"classList"in document.documentElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){var e,t,n=this;return e=function(){return n.className.split(/\s+/)},t={add:function(){var t,i,r,o,a;for(i=1<=arguments.length?s.call(arguments,0):[],r=e(),o=0,a=i.length;a>o;o++)t=i[o],n.classList.contains(t)||r.push(t);return n.className=r.join(" ")},remove:function(t){return n.className=e().filter(function(e){return e!==t}).join(" ")},toggle:function(e){return n.classList.contains(e)?n.classList.remove(e):n.classList.add(e)},contains:function(t){return-1!==e().indexOf(t)},item:function(t){var n;return n=e(),n.length>t?n[t]:null}},Object.defineProperty(t,"length",{get:function(){return e().length}}),t}}),t.parseDataNode=function(e){var n,i,r;return i=t.one("#"+e),(null!=i?i.innerHTML:void 0)?(n=null!=(r=i.innerText)?r:i.innerHTML,JSON.parse(n)):{}},t.setTextSelectable=function(e,t){return t?(e.style[r.userSelect]="",e.onselectstart=""):(e.style[r.userSelect]="none",e.onselectstart="return false;")}}),require.define("lib/i18n",function(e,t){var n=[].slice;t.translate=function(){var e,t,i,r,o,s,a;return i=arguments[0],a=arguments[1],e=3<=arguments.length?n.call(arguments,2):[],a=null!=(o=i[a])?o:a,0===e.length?a:("object"==typeof a&&(r=parseInt(e[0]),a=1===r?null!=(s=a.one)?s:a.other:a.other),t=0,null!=a?a.replace(/[%$1-9]+[ds1-9]/g,function(n){var i,r;return i=null!=(r=n.match(/\d+/))?r[0]:void 0,i&&i<=e.length?e[Number(i)-1]:t<e.length?e[t++]:""}):void 0)}}),require.define("blend/i18n",function(e,t){var n,i,r,o,s=[].slice;n=require("blend/dom"),i=require("lib/i18n"),o={},t.load=function(e){return null==e&&(e=n.parseDataNode("i18n-data")),o=e},t.languageCode=function(){return o.lang},t.locale=function(){return o.locale},t.t=function(){var e;return e=1<=arguments.length?s.call(arguments,0):[],e.unshift(o),i.translate.apply(this,e)},t.n=function(e,n,i){return 1===i?t.t(e,i):t.t(n,i)},t.cleanStr=function(e){return null==e?e:e.replace(/(\\n)+/g,"<br/>")},r=function(e,n){var i,r;return r=e.includes(t.t("locale")),i=t.t("lang")===n&&void 0===t.locale(),r||i},t.getLocale=function(){var e;return null!=(e=t.t("locale"))?e.replace("-","_"):void 0},t.isEnglish=function(){return r(["en-US","en-CA","en-GB","en-IN"],"en")},t.isGerman=function(){return r(["de-DE","de-AT","de-CH"],"de")},t.isFrench=function(){return r(["fr-FR","fr-BE","fr-CH"],"fr")},t.isItalian=function(){return r(["it-IT"],"it")},t.isPortuguese=function(){return r(["pt-BR"],"pt-BR")},t.isSpanish=function(){return r(["es-ES"],"es")},t.isTurkish=function(){return r(["tr-TR"],"tr")},t.isRussian=function(){return r(["ru-RU"],"ru")},t.isKorean=function(){return r(["ko-KR"],"ko")}}),require.define("blend/cookie",function(e,t){var n,i,r,o,s,a;a=function(e){return e.replace(/^\s+|\s+$/g,"")},r=function(){return document.cookie.split(";").map(function(e){return a(e).split("=")}).reduce(function(e,t){return 1!==t.length?(t.length>2&&(t[1]=t.slice(1).join("=")),e[t[0]]=t[1],e):void 0},{})},i=function(e){var t,n,i;i=r();for(t in i)if(n=i[t],t===e)return n;return null},o=function(e){var t,n,i,o;n={},o=r();for(t in o)i=o[t],t.substr(0,e.length)===e&&(n[t]=i);return n},s=function(e,t){return null!=t?document.cookie=""+e+"="+t+"; path=/":void 0},n=function(e){return null!=e?(document.cookie=""+e+"=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie=""+e+"=; path=/; domain=.flipboard.com; expires=Thu, 01 Jan 1970 00:00:01 GMT;"):void 0},t.getAll=r,t.get=i,t.getWithPrefix=o,t.set=s,t.del=n}),require.define("blend/cache",function(e,t){var n,i,r,o,s;try{o=window.localStorage}catch(a){r=a,console.error('cache exception accessing localStorage. exception name "'+r.name+'" and message "'+(r.message||r.description)+"]",r)}i=function(e){var t,n;return n=new RegExp("^"+e+":"),t={get:function(t){var n,i;try{n=o.getItem(""+e+":"+t)}catch(s){return r=s,null
}try{i=JSON.parse(n)}catch(s){r=s,i=n}return i},set:function(n,i){if("undefined"==typeof i||null===i)return t.del(n),void 0;"object"==typeof i&&(i=JSON.stringify(i));try{return o.setItem(""+e+":"+n,i)}catch(s){return r=s,console.error('cache.set exception, clearing cache. exception name "'+r.name+'" and message "'+(r.message||r.description)+"]",r),t.clear()}},del:function(t){try{return o.removeItem(""+e+":"+t)}catch(n){return r=n,console.error("cache.del exception",r)}},clear:function(){var e,t,i,s,a,l,u,c;t=[];try{for(i=s=0,u=o.length;u>=0?u>s:s>u;i=u>=0?++s:--s)e=o.key(i),(null!=e?e.match(n):void 0)&&t.push(e);for(c=[],a=0,l=t.length;l>a;a++)e=t[a],c.push(o.removeItem(e));return c}catch(d){return r=d,console.error("cache.clear exception",r)}}}},n=function(){try{return o.clear()}catch(e){return r=e,console.error("cache.clearAll exception",r)}},s=function(e){var t,n,i,r;for(r=["getItem","setItem","removeItem","clear"],n=0,i=r.length;i>n;n++)if(t=r[n],"function"!=typeof(null!=e?e[t]:void 0))return console.warn("localStorage override does not implement Storage interface",e),void 0;return o=e},t.create=i,t.clearAll=n,t.setStorage=s}),require.define("blend/router",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f;u=require("blend/lang"),a=require("blend/events"),l=require("blend/http"),i="",r=null,f=[],h={},c=null,s=!1,o=function(e,t,i){var r,o,s,a;if(null==t&&(t={}),e!==c){for(c=e,r=!1,s=0,a=f.length;a>s;s++)if(o=f[s],o.match(e)){n.emit("route:change",{route:o,path:o.path,url:e,context:o.context,params:o.params,query:o.query,data:t,replace:i}),o.reset(),r=!0;break}return r?void 0:n.emit("route:unknown",{url:e})}},p=function(e){return n.navigate(""+window.location.pathname+window.location.search,e.state,!1,!1),s?d(e):void 0},d=function(){var e,t,n;return t=window.scrollY,n=Date.now(),e=function(i){var r;return r=Date.now()-n,window.removeEventListener("scroll",e,!0),window.scrollY!==t&&1e3>r?(i.preventDefault(),window.scrollTo(0,t)):void 0},window.addEventListener("scroll",e,!0)},n={preservedParams:[],setBaseURL:function(e){return null==e&&(e=""),i=e,r=new RegExp("^"+i)},enableScrollCorrection:function(){return s=!0},getLastPath:function(){return null!=c?c.split("?")[0]:void 0},addPreservedParam:function(e){return this.preservedParams.push(e)},removePreservedParam:function(e){return this.preservedParams=this.preservedParams.filter(function(t){return t!==e})},map:function(e,n){var i;return i=new t(e,n),f.push(i)},mapRedirect:function(e,t){return h[e]=t},start:function(e){var t,n;return n=(null!=e?e:window.location.pathname).replace(i,""),n+=window.location.search,this.navigate(n,{},!0,!1),t=function(){return window.addEventListener("popstate",p,!0)},setTimeout(t,300)},stop:function(){return window.removeEventListener("popstate",p,!0)},routeToURL:function(e,t,n){var i;return null==t&&(t={}),null==n&&(n={}),i=e.replace(/:(\w+)/g,function(e,n){return encodeURIComponent(t[n])}),Object.keys(n).length>0&&(i+=l.stringifyQuery(n)),i},navigate:function(e,t,n,s,a){var u,c,d,p,f,m,g,v,y;null==t&&(t={}),null==n&&(n=!1),null==s&&(s=!0),null==a&&(a={}),e in h&&(e=h[e]),f=l.parseQuery(window.location.search,!0),y=this.preservedParams;for(g=0,v=y.length;v>g;g++)p=y[g],p in f&&(e=l.addOrReplaceQueryParam(e,p,f[p]));for(c in a)m=a[c],e=l.addOrReplaceQueryParam(e,c,m);return u=e,null==r||r.test(e)?u=e.replace(r,""):e=""+i+e,s&&(d=n?"replaceState":"pushState",history[d].call(history,t,"",e)),o(null!=u?u:e,t,n)},redirect:function(e,t){return null==t&&(t={}),this.navigate(e,t,!0)}},u.mixin(n,a.Emitter),t=function(){function e(e,t){this.path=e,"/"!==this.path[0]&&(this.path="/"+e),this.context=t,this.keys=[],this.params={},this.query={},this.regexp=this.computeRegExp()}return e.prototype.match=function(e){var t,n,i,r,o,s;if(i=!1,r=e.match(this.regexp),null!=r?r.length:void 0){for(r.shift(),t=o=0,s=r.length;s>o;t=++o)n=r[t],null!=this.keys[t]&&(this.params[this.keys[t]]=decodeURIComponent(n));this.query=l.parseQuery(e),i=!0}return i},e.prototype.reset=function(){return this.params={},this.query={}},e.prototype.computeRegExp=function(){var e,t,n,i,r,o;for(i="^",n=this.path.split("/"),n.shift(),r=0,o=n.length;o>r;r++)t=n[r],i+="\\/",t.length&&(e=t.match(/^@?:/),null!=e?(this.keys.push(t.replace(e[0],"")),i+="@"===t[0]?"@(?:([^\\/]+?))":"(?:([^\\/]+?))"):i+=t);return i+="\\/?(\\?(.*))?$",new RegExp(i)},e}(),e.exports=n}),require.define("blend/animator",function(e){var t,n,i,r,o,s,a;a=require("blend/features"),i=function(e){return null==e&&(e={}),null==e.duration&&(e.duration=.3),null==e.from&&(e.from=0),null==e.to&&(e.to=1),null!=e.step?e.step:e.step=function(){}},s=function(e,t,n,i){return e/=i,-n*e*(e-2)+t},r=function(e,t,n,i){return e/=i,n*e*e+t},o=function(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)},t=function(){function e(e){if(i(e),this.from=e.from,this.to=e.to,this.duration=e.duration,this.step=e.step,this.startTime=0,this.value=this.from,this.timing=s,"string"==typeof e.timing)switch(e.timing){case"ease-in":this.timing=r;break;case"ease-in-out":this.timing=o;break;default:this.timing=s}this.callbacks=[]}return e.prototype.finished=function(){return this.currentTime>=this.duration},e.prototype.done=function(){var e,t,n,i;for(i=this.callbacks,t=0,n=i.length;n>t;t++)e=i[t],e();return this.callbacks=[]},e.prototype.then=function(e){return this.callbacks.push(e)},e}(),n=function(){function e(){this.pool=[]}return e.prototype.create=function(e){var n,i=this;return n=new t(e),n.run=function(){return i.add(n),n},n.cancel=function(){return i.remove(n),n},n},e.prototype.add=function(e){return this.pool.push(e),1===this.pool.length?this.run():void 0},e.prototype.remove=function(e){var t;return t=this.pool.indexOf(e),t>-1?this.pool.splice(t,1):void 0},e.prototype.run=function(){return requestAnimationFrame(this.step.bind(this))},e.prototype.step=function(e){var t,n,i,r,o;for(n=[],o=this.pool,i=0,r=o.length;r>i;i++)t=o[i],t.startTime||(t.startTime=e),t.currentTime=(e-t.startTime)/1e3,t.value=t.timing(t.currentTime,t.from,t.to-t.from,t.duration),t.step(t.value),t.finished()&&(n.push(t),t.done());return this.pool=this.pool.filter(function(e){return-1===n.indexOf(e)}),this.pool.length>0?this.run():void 0},e}(),e.exports=new n}),require.define("blend/date",function(e,t){var n,i,r,o,s,a,l,u,c,d;u=require("blend/i18n"),s=1,r=60*s,i=60*r,n=24*i,a=7*n,o=30*n,l=364.25*n,c=[[s,"TIME_AGO_FORMAT_JUST_NOW"],[r,"TIME_FORMAT_MINUTE"],[i,"TIME_FORMAT_HOUR"],[n,"TIME_FORMAT_DAY"],[a,"TIME_FORMAT_WEEK"],[o,"TIME_FORMAT_MONTH"],[l,"TIME_FORMAT_YEAR"]],d=[[s,"s"],[r,"m"],[i,"h"],[n,"d"]],t.timeAgoInWords=function(e){var t,n,i,r,o,s,a,l,d,p,h;if(null==e)return"";for(s="number"==typeof e?e:e.getTime()/1e3,t=Date.now()/1e3-s,1>t&&(t=1),i=a=0,l=c.length;l>a;i=++a)if(d=c[i],o=d[0],r=d[1],n=null!=(p=null!=(h=c[i+1])?h[0]:void 0)?p:Number.MAX_VALUE,t>=o&&n>=t)return u.t(r,Math.floor(t/o))},t.timeAgoShort=function(e){var t,n,i,r,o,s,a,l,u,c,p;if(null==e)return"";for(s="number"==typeof e?e:"string"==typeof e?parseInt(e):e.getTime()/1e3,t=Date.now()/1e3-s,1>t&&(t=1),i=a=0,l=d.length;l>a;i=++a)if(u=d[i],o=u[0],r=u[1],n=null!=(c=null!=(p=d[i+1])?p[0]:void 0)?c:Number.MAX_VALUE,t>=o&&n>=t)return Math.floor(t/o)+r}}),require.define("blend/gestures/gesture",function(e){var t,n,i,r,o,s;s=require("blend/lang"),r=require("blend/events"),t=0,n=function(){function e(n,i){var r,o;null==i&&(i={}),"string"==typeof n&&(n=document.querySelector(n)),this.node=n,this.listeners=[],this.state=e.state.begin,this.enabled=!0,i=s.merge(i,this.defaults());for(r in i)o=i[r],this[r]=o;this.node.setAttribute("data-gesture","g-"+t++),this.setup()}return e.prototype.destroy=function(){var e,t,n,i;for(this.node.removeAttribute("data-gesture"),i=this.listeners,t=0,n=i.length;n>t;t++)e=i[t],e.detach();return this.off("*")},e.types=[],e}(),s.mixin(n,r.Emitter),n.state={begin:1,change:2,end:3,cancel:4},n.prototype.shouldBegin=function(){return!0},n.prototype.cancel=function(){return this.state===n.state.change?this.state=n.state.cancel:void 0},n.prototype.publish=function(e,t){return t.type=e,this.emit(e,t)},n.prototype.setup=function(){throw new Error("setup() not implemented")},n.prototype.defaults=function(){return{minPoints:1,maxPoints:1,mouseInput:!0,touchInput:!0,pointerInput:!0}},i=[],o=function(e,t){var n,r,o,s;for(r=0,o=i.length;o>r;r++)if(n=i[r],(null!=(s=n[e])?s.gesture.node:void 0)===t)return n;return void 0},n.prototype.listen=function(e,t,n,i){var o,s;return null==i&&(i=!0),null==e&&(e=this.node),("function"==typeof e.hasAttribute?e.hasAttribute("data-gesture"):void 0)?(s='[data-gesture="'+e.getAttribute("data-gesture")+'"]',o=r.delegate(document.body,s,t,n.bind(this))):o=r.on(e,t,n.bind(this),i),this.listeners.push(o)},n.register=function(e,t,n){var s,a,l,u,c,d;for(d=[],u=0,c=t.length;c>u;u++)l=t[u],s=function(t,r,s){var a;return a=o(e,t),void 0===a&&(a={},a[e]={gesture:new n(t),events:[]},i.push(a)),a[e].events.push(r),a[e].gesture.on(r,s)},a=function(t,n,r){var s;return s=o(e,t),void 0!==s&&s[e]?(s[e].events=s[e].events.filter(function(e){return e!==n}),s[e].gesture.off(n,r),0===s[e].events.length&&(s[e].gesture.destroy(),s[e]=null,0===Object.keys(s).length)?i.splice(i.indexOf(s),1):void 0):void 0},d.push(r.register(l,s,a));return d},e.exports=n}),require.define("blend/gestures/hold",function(e){var t,n,i,r,o,s,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("blend/lang"),i=require("blend/events"),r=require("blend/features"),t=require("blend/gestures/gesture"),n=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments)}return l(t,e),t}(t),n.prototype.defaults=function(){var e;return e={mouseInput:!1,delay:400},o.merge(e,n.__super__.defaults.apply(this,arguments))},n.prototype.setup=function(){return this.touchInput&&r.touch&&this.listen(this.node,"touchstart",this.touchstart),this.pointerInput&&r.pointer&&(this.capturedPointers=[],this.listen(this.node,r.pointerDown,this.pointerdown)),this.mouseInput?this.listen(this.node,"mousedown",this.mousedown):void 0},n.prototype.touchstart=function(e){var t;return this.usingTouch=!0,this.minPoints<=(t=e.touches.length)&&t<=this.maxPoints?this.begin(e.touches,e):void 0},n.prototype.pointerdown=function(e){var t;return this.usingPointer=!0,this.capturedPointers.push(e),this.minPoints<=(t=this.capturedPointers.length)&&t<=this.maxPoints?this.begin(this.capturedPointers,e):void 0},n.prototype.mousedown=function(e){return this.usingTouch||this.usingPointer?void 0:this.begin([e],e)},n.prototype.begin=function(e,t){var n,o,s,a,l,u,c=this;if(this.enabled){switch(l=[],a=function(){var e;return t.preventDefault(),t.stopPropagation(),e={srcEvent:t},c.publish("hold",e),s()},s=function(){var e,t,n;for(t=0,n=l.length;n>t;t++)e=l[t],e.detach();return c.end()},this.releaseTimer=setTimeout(a,this.delay),t.type){case"touchstart":u="touchmove",o="touchend";break;case"mousedown":u="mousemove",o="mouseup";break;case r.pointerDown:u=r.pointerMove,o=r.pointerUp}return n=function(){return clearTimeout(c.releaseTimer)},l.push(i.on(window,u,n,!0)),l.push(i.on(window,o,n,!0))}},n.prototype.end=function(){return this.usingTouch=!1,this.usingPointer=!1,this.capturedPointers=[]},t.register("hold",["hold"],n),e.exports=n}),require.define("blend/gestures/pan",function(e){var t,n,i,r,o,s,a,l,u,c,d={}.hasOwnProperty,p=function(e,t){function n(){this.constructor=e}for(var i in t)d.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};u=require("blend/lang"),r=require("blend/events"),o=require("blend/features"),n=require("blend/gestures/gesture"),a=30,l=.5,t=!1,i=function(e){function t(){return c=t.__super__.constructor.apply(this,arguments)}return p(t,e),t}(n),i.prototype.setup=function(){return this.translation={x:0,y:0},this.velocity={x:0,y:0},this.location={x:0,y:0},t&&(this.debugDots=[]),this.wheelMultiplier=l,this.pointerInput&&o.pointer&&this.listen(this.node,o.pointerDown,this.pointerdown),this.touchInput&&this.listen(this.node,"touchstart",this.touchstart),this.mouseInput&&this.listen(this.node,"mousedown",this.mousedown),this.wheelInput?(this.listen(this.node,"wheel",this.mousewheel),this.listen(this.node,"mousewheel",this.mousewheel)):void 0},i.prototype.mousedown=function(e){return this.usingTouch||this.usingPointer?void 0:this.begin(e,e)},i.prototype.touchstart=function(e){var t;return this.usingTouch=!0,this.minPoints<=(t=e.touches.length)&&t<=this.maxPoints?this.begin(e.touches[0],e):void 0},i.prototype.pointerdown=function(e){return this.discardEvent(e)?void 0:(this.usingPointer=!0,this.begin(e,e))},s=-1===navigator.userAgent.toLowerCase().indexOf("webkit"),i.prototype.mousewheel=function(e){var t,i,r,o,a,l,c,d,p;if(this.enabled)return t=null!=(d=e.wheelDeltaX)?d:e.deltaX,i=null!=(p=e.wheelDeltaY)?p:e.deltaY,a=s?-1:1,t*=.25*a,i*=.25*a,-10>i&&(i*=this.wheelMultiplier),this.state===n.state.begin||this.state===n.state.cancel?(t=u.clamp(t,-1,1),i=u.clamp(i,-1,1),this.history=[],this.history.push([Date.now(),t,i]),this.state=n.state.change,r=this.eventData("pan:start",e),r.translation.x=t,r.translation.y=i,this.publish("pan:start",r)):this.state===n.state.change?(o=this.history[this.history.length-1],l=o[1]+t,c=o[2]+i,this.history.push([Date.now(),l,c]),r=this.eventData("pan:change",e),this.publish("pan:change",r)):void 0},i.prototype.eventData=function(e,t){var n,i,r,o,s,a,l,u;return s=this.history[this.history.length-1],n={srcEvent:t},n.type=e,n.translation={x:0,y:0},n.velocity={x:0,y:0},n.location={x:s[1],y:s[2]},this.history.length>1&&(a=this.history[0],l=this.history[this.history.length-2],u=this.history[this.history.length-1],i=u[0]-l[0],r=u[1]-l[1],o=u[2]-l[2],n.translation.x=u[1]-a[1],n.translation.y=u[2]-a[2],n.velocity.x=r/i,n.velocity.y=o/i),this.translation=n.translation,this.velocity=n.velocity,this.location=n.location,n},i.prototype.discardEvent=function(e){if(!this.enabled)return!0;if(null!=e.pointerType&&!this.mouseInput&&(4===e.pointerType||"mouse"===e.pointerType))return!0;if(null!=e.pointerId){if(null!=this.activePointerId)return e.pointerId!==this.activePointerId;this.activePointerId=e.pointerId}return!1},i.prototype.relativePoint=function(e){var t,n,i;return t=this.node.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,{x:n,y:i}},t&&(i.prototype.addDebugDot=function(e,t){var n;return n=document.createElement("div"),n.style.width="4px",n.style.height="4px",n.style.left=""+(e.x-2)+"px",n.style.top=""+(e.y-2)+"px",n.style.zIndex=1e3,n.style.position="absolute",n.style.backgroundColor=t,document.body.appendChild(n),this.debugDots.push(n)}),i.prototype.begin=function(e,i){var s,l,u,c,d,p,h,f,m,g=this;if(this.enabled){switch(f=!1,e=this.relativePoint(e),this.history=[],this.history.push([Date.now(),e.x,e.y]),m=function(e){var t;return o.pointer?void 0:(e.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation(),t=r.create("touchcancel"),e.target.dispatchEvent(t))},d=function(e){var r,s,l,u;if(!g.discardEvent(e)&&(s=null!=(l=null!=(u=e.touches)?u[0]:void 0)?l:e,s=g.relativePoint(s),g.history.push([Date.now(),s.x,s.y]),t&&g.addDebugDot(s,"blue"),(o.ios||o.android)&&e.preventDefault(),(g.state===n.state.change||Math.abs(s.x-g.history[0][1])>=a||Math.abs(s.y-g.history[0][2])>=a)&&(f=!0,g.history.length>1)))switch(g.state){case n.state.begin:if(r=g.eventData("pan:start",i),g.shouldBegin(g,r)&&(e.preventDefault(),0!==r.translation.x||0!==r.translation.y))return m(e),g.publish("pan:start",r),g.state=n.state.change;break;case n.state.change:return m(e),g.change(e)}},l=function(n){var i,r,o,a;if(!g.discardEvent(n)){for(t&&(e=g.relativePoint(n),g.addDebugDot(e,"red"),setTimeout(function(){var e,t;for(t=[];g.debugDots.length>0;)e=g.debugDots.pop(),t.push(document.body.removeChild(e));return t},1500)),f&&g.end(n),a=[p,u,s],r=0,o=a.length;o>r;r++)i=a[r],null!=i&&i.detach();return g.usingTouch=!1,g.usingPointer=!1,g.activePointerId=null}},i.type){case"touchstart":h="touchmove",c="touchend";break;case"mousedown":h="mousemove",c="mouseup";break;case o.pointerDown:h=o.pointerMove,c=o.pointerUp}return p=r.on(window,h,d,!0),u=r.on(window,c,l,!0),o.pointer&&(s=r.on(window,o.pointerCancel,l,!0)),t?setTimeout(function(){return g.addDebugDot(e,"green")},100):void 0}},i.prototype.change=function(e){return this.publish("pan:change",this.eventData("pan:change",e))},i.prototype.end=function(e){return this.state=n.state.end,this.publish("pan:end",this.eventData("pan:end",e)),this.state=n.state.begin},n.register("pan",["pan:start","pan:change","pan:end"],i),e.exports=i}),require.define("blend/gestures/swipe",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C={}.hasOwnProperty,T=function(e,t){function n(){this.constructor=e}for(var i in t)C.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};y=require("blend/lang"),d=require("blend/events"),u=require("blend/dom"),p=require("blend/features"),t=require("blend/gestures/gesture"),n=require("blend/gestures/pan"),i=function(e){function t(){return k=t.__super__.constructor.apply(this,arguments)}return T(t,e),t}(t),l={up:1,down:2,left:3,right:4},i.direction=l,i.prototype.defaults=function(){return y.merge(i.__super__.defaults.apply(this,arguments),{usePanGesture:!0,wheelInput:!1,preventWheel:!0})},i.prototype.setup=function(){var e;return this.usePanGesture&&(e={minPoints:this.points,maxPoints:this.points,wheelInput:this.wheelInput,mouseInput:this.mouseInput,touchInput:this.touchInput,pointerInput:this.pointerInput},this.panGesture=new n(this.node,e),this.panGesture.on("pan:start",this.panStart.bind(this)),this.panGesture.on("pan:end",this.panEnd.bind(this))),this.wheelInput?(this.listen(window,"wheel",this.mousewheel),this.listen(window,"mousewheel",this.mousewheel)):void 0},i.prototype.destroy=function(){var e;return i.__super__.destroy.apply(this,arguments),null!=(e=this.panGesture)?e.destroy():void 0},i.prototype.panStart=function(e){return this.enabled?(this.state=t.state.begin,this.publish("swipe:start",{srcEvent:e.srcEvent})):void 0},i.prototype.panEnd=function(e){var n,i,r,o,s,a;return s=e.velocity.x,a=e.velocity.y,r=Math.abs(s),o=Math.abs(a),i=o>=r?a>=0?l.down:l.up:s>=0?l.right:l.left,n={velocity:e.velocity,srcEvent:e.srcEvent,direction:i},this.state=t.state.end,this.publish("swipe",n),this.state=t.state.begin},v=0,g=0,m=0,x=0,S=!1,w={x:0,y:0},_=0,o=void 0,a=null,h=[],i.prototype.mousewheel=function(e){if(this.enabled&&!u.ancestor(e.target,function(e){var t,n;return(null!=e?null!=(t=e.classList)?t.contains("scrollable-y"):void 0:void 0)||(null!=e?null!=(n=e.classList)?n.contains("scrollable-x"):void 0:void 0)}))switch(this.preventWheel&&(e.preventDefault(),e.stopPropagation()),x){case 0:return this.stationary(e);case 1:return this.accelerating(e);case 2:return this.decelerating(e)}},i.prototype.stationary=function(e){return x=1,w={x:0,y:0},_=0,o=void 0,S=!1,h=[],r(e),this.state=t.state.begin,this.publish("swipe:start",{srcEvent:e}),2===x?this.accelerating(e):void 0},i.prototype.accelerating=function(e){return r(e),S?void 0:(clearTimeout(a),a=setTimeout(this.decelerating.bind(this,e),100))},i.prototype.decelerating=function(e){return r(e),clearTimeout(a),S||(this.state=t.state.end,this.publish("swipe",c(e)),S=!0),a=setTimeout(function(){return x=0},60)},I=.5,f=-1===navigator.userAgent.toLowerCase().indexOf("webkit"),r=function(e){var t,n,i,r,s,a,u,c,d,p,y,S,k,C,T,q,P,E,L,A;if(i=null!=(P=e.wheelDeltaY)?P:e.deltaY,n=null!=(E=e.wheelDeltaX)?E:e.deltaX,f&&(i*=-1),f&&(n*=-1),void 0===o&&(o=Math.abs(i)>=Math.abs(n)?0>=i?l.up:l.down:0>=n?l.left:l.right),y=null!=(L=null!=(A=window.performance)?A.now():void 0)?L:Date.now(),w.x-=i,w.y-=i,o===l.up||o===l.down?h.push([y,w.y]):h.push([y,w.x]),1===h.length?(S=Math.abs(i)>0?i:n,p=S):(u=h[h.length-2],c=h[h.length-1],t=c[0]-u[0]||1,S=(c[1]-u[1])/t,p=u[3]+I*(u[2]-u[3])),Math.abs(p)>_&&(_=Math.abs(p)),1===x&&(Math.abs(p)>g||Math.abs(b())>=m)&&(x=2),h.length>8&&_>v){for(a=!0,d=h.slice(h.length-9,h.length-1),r=k=0,T=d.length;T>k;r=++k)if(c=d[r],0!==r&&(u=d[r-1],Math.abs(c[3])>Math.abs(u[3]))){a=!1;break}if(a&&(x=2),2===x){for(s=!0,r=C=0,q=d.length;q>C;r=++C)if(c=d[r],0!==r&&(u=d[r-1],Math.abs(c[3])<Math.abs(u[3]))){s=!1;break}s&&(x=0)}}return h[h.length-1].push(S),h[h.length-1].push(p),h.length>10?h.shift():void 0},s=function(){return h[h.length-1][3]},b=function(){var e,t,n;return e=0,h.length>1&&(t=h[h.length-2],n=h[h.length-1],e=n[1]-t[1]),e},c=function(e){var t;return t={srcEvent:e,translation:w,direction:o,velocity:s()}},t.register("swipe",["swipe:start","swipe"],i),e.exports=i}),require.define("blend/gestures/tap",function(e,t){var n,i,r,o,s,a,l,u;i=require("blend/features"),s=30,n=navigator.userAgent.indexOf("Android")>-1,o=function(e){var t,o,u,c,d,p,h,f,m,g,v,y,b,w,_,x;return null==e&&(e=document.body),n||!1 in window?void 0:(x=!1,u=null,v=!1,o=function(){var e,t,n;if(null!=(null!=u?u.target:void 0))return n=u.touch,t=u.target,l(t)?t.focus():(e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.synthetic=!0,t.dispatchEvent(e)),u=null},_=function(t){var n,i,r,o;return x=!0,t.touches.length>1?void 0:(n=null!=u?u.scrollTop:void 0,i=null!=(o=a(t.target,e))?o.scrollTop:void 0,"number"==typeof n&&i!==n?(u=null,void 0):(r=t.touches[0],u={moved:!1,startTime:Date.now(),startX:r.clientX,startY:r.clientY,target:t.target,touch:r,scrollTop:i}))},c=function(){return x=!1},w=function(e){var t,n,i;if(null!=u)return t=e.touches[0],n=Math.abs(t.clientX-u.startX),i=Math.abs(t.clientY-u.startY),Math.abs(n)>s||Math.abs(i)>s?u.moved=!0:void 0},b=function(e){return(null!=u?u.moved:void 0)===!1?(e.preventDefault(),e.stopPropagation(),"function"==typeof e.stopImmediatePropagation&&e.stopImmediatePropagation(),o()):void 0},y=function(){return u=null},p=function(e){var t,n;return t=!l(e.target),"mouse"===e.pointerType&&(t=t&&0===e.button),t?(n={touches:[e],target:e.target},_(n)):void 0},h=function(e){var t;return t={touches:[e],target:e.target},w(t)},m=function(e){return b(e)},d=function(e){return y(e)},f=function(e){return y(e)},t=function(e){var t,n;return n=!((e.synthetic||!x)&&!e.generated),i.pointer&&(t=r.map(function(e){return""+e+":focus"}),n=!e.synthetic&&!document.querySelector(t)),n?(e.preventDefault(),e.stopPropagation(),!1):void 0},g=function(){return u=null},e.addEventListener("mousedown",c,!0),i.touch&&(e.addEventListener("touchstart",_,!1),e.addEventListener("touchmove",w,!1),e.addEventListener("touchend",b,!1),e.addEventListener("touchcancel",y,!1)),i.pointer&&(e.addEventListener(i.pointerDown,p,!1),e.addEventListener(i.pointerMove,h,!1),e.addEventListener(i.pointerUp,m,!1),e.addEventListener(i.pointerOut,f,!1),e.addEventListener(i.pointerCancel,d,!1)),e.addEventListener("click",t,!0),window.addEventListener("scroll",g,!0))},r=["input","select","textarea"],u=["button","submit","reset","file","image","range","hidden"],l=function(e){var t;return t=~r.indexOf(e.tagName.toLowerCase()),t=t&&-1===u.indexOf(e.type)},a=function(e,t){var n,i;for(n=e;n&&n!==t;)if(n=n.parentNode,0<(i=n.clientHeight)&&i<n.scrollHeight)return n;return null},t.init=o,t.focusTags=r}),require.define("blend/gestures",function(e,t){t.Base=require("blend/gestures/gesture"),t.Hold=require("blend/gestures/hold"),t.Pan=require("blend/gestures/pan"),t.Swipe=require("blend/gestures/swipe"),t.Tap=require("blend/gestures/tap")}),require.define("blend/watch",function(e){var t,n=[].slice;e.exports=t=function(){function e(){}return e.property=function(e,t){var i,r,o,s,a,l,u;return null==t&&(t={}),null==this._properties&&(this._properties={}),this._properties[e]=t,s="_"+e,r=t.get,l=t.set,o="get"+e[0].toUpperCase()+e.substr(1),u="set"+e[0].toUpperCase()+e.substr(1),a=function(){var t,n,i,r,o;if(null!=this._watchers){for(r=this._watchers,o=[],n=0,i=r.length;i>n;n++)t=r[n],t.name===e&&o.push("function"==typeof t.callback?t.callback():void 0);return o}},i=function(e){var t,i,r,o,l,u=this;for(this[s]=e,i=function(e){return u[s][e]=function(){var t;return t=1<=arguments.length?n.call(arguments,0):[],Array.prototype[e].apply(u[s],t),a.call(u)}},l=["push","pop","shift","unshift"],r=0,o=l.length;o>r;r++)t=l[r],i(t);return this[s].clear=function(){return u[s].length=0,a.call(u)}},t.get=function(){return null==r&&(r=this[o]),"function"==typeof r?r.call(this):(null==this[s]&&(null!=t["default"]&&(this[s]=t["default"]),null!=t.collection&&(this[s]=[])),this[s])},t.set=function(){var e,r;return e=1<=arguments.length?n.call(arguments,0):[],null!=t.collection&&i.apply(this,e),"function"==typeof l?l.apply(this,e):"function"==typeof this[u]?this[u].apply(this,e):(t.parseBool&&(e[0]="1"===(r=String(e[0]).toLowerCase())||"true"===r),this[s]=e[0]),a.call(this)},Object.defineProperty(this.prototype,e,t)},e.allProperties=function(){var e;return null!=(e=this._properties)?e:{}},e.prototype.hasProperty=function(e){return Object.keys(this.constructor.allProperties()).indexOf(e)>-1},e.prototype.watch=function(e,t,n){var i;return i=arguments.length>2?t[arguments[2]].bind(t):t,null==this._watchers&&(this._watchers=[]),this._watchers.push({name:e,watcher:t,callback:i,method:n})},e.prototype.unwatch=function(e,t,n){var i,r;return"*"===e?(this._watchers=null==t?null:null!=(i=this._watchers)?i.filter(function(e){return e.watcher!==t}):void 0,void 0):this._watchers=null!=(r=this._watchers)?r.filter(function(i){var r;return i.name!==e?!0:(r=!0,"function"==typeof t?(r=i.watcher!==t,null!=n&&(r=r&&i.method!==n)):"object"==typeof t&&(r=i.watcher!==t),r)}):void 0},e}()}),require.define("blend",function(e,t){t.animator=require("blend/animator"),t.async=require("blend/async"),t.cookie=require("blend/cookie"),t.date=require("blend/date"),t.dom=require("blend/dom"),t.events=require("blend/events"),t.features=require("blend/features"),t.gestures=require("blend/gestures"),t.http=require("blend/http"),t.i18n=require("blend/i18n"),t.lang=require("blend/lang"),t.tick=require("blend/tick"),t.Watch=require("blend/watch")}),require.define("blend/node",function(e){var t,n,i,r,o,s,a,l,u=[].slice;for(i=require("blend/dom"),o=require("blend/tick"),r=/(#|\.|[\w-_]+)(.*?)/g,t={createElement:function(){var e,t,n,i,r,o,s,a,l,c,d;for(s=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],o=document.createElement(s),(null!=(d=this._parentStack)?d.length:void 0)>0&&this._parentStack[this._parentStack.length-1].appendChild(o),e=!1;n.length;)if(t=n.shift(),"string"==typeof t)e||"."!==t[0]&&"#"!==t[0]?o.textContent=t:(this.applySelector(t,o),e=!0);else if("function"==typeof t)null==this._parentStack&&(this._parentStack=[]),this._parentStack.push(o),t(),null!=this._parentStack&&(this._parentStack.pop(),this._parentStack.length>0||(this._parentStack=null));else if("object"==typeof t&&(null!=t?t._safe:void 0)&&"string"==typeof t.html)o.innerHTML=t.html;else if("object"==typeof t&&null!=t&&Object.keys(t).length)if("function"==typeof t.splice)for(l=0,c=t.length;c>l;l++)r=t[l],"string"==typeof r&&(r=document.createTextNode(r)),r instanceof HTMLElement&&o.appendChild(r);else for(i in t)a=t[i],o.setAttribute(i,a);return o},applySelector:function(e,t){var n,i;for(n=e.match(r),i=[];n.length;)"."===n[0]?(n.shift(),t.classList.add(n[0])):"#"===n[0]&&(n.shift(),t.id=n[0]),i.push(n.shift());return i},safeHTML:function(e){return"string"==typeof e&&(e={html:e,_safe:!0}),e}},n=["head","title","base","link","meta","style","script","noscript","body","section","nav","article","aside","h1","h2","h3","h4","h5","h6","header","footer","address","main","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","figure","figcaption","div","a","em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","span","br","wbr","ins","del","img","iframe","embed","object","param","video","audio","source","track","canvas","map","area","svg","math","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","fieldset","legend","label","input","button","select","datalist","optgroup","option","textarea","keygen","output","progress","meter","details","summary","menuitem","menu"],a=0,l=n.length;l>a;a++)s=n[a],t[s]=t.createElement.bind(t,s);e.exports=t}),require.define("transitions/base",function(e){var t,n,i,r,o,s;o=require("blend/lang"),n=require("blend/events"),s=require("blend/tick"),i=require("blend/features"),r=350,t=function(){function e(e,t,n){var i;this.fromNode=e,this.toNode=t,this.options=null!=n?n:{},this.reverse=this.options.reverse,this.duration=null!=(i=this.options.duration)?i:this.constructor.defaultDuration,this.setup()}return e.defaultDuration=r,e.prototype.destroy=function(){},e.prototype.setup=function(){throw new Error("Transition#setup not implemented")},e.prototype.begin=function(){var e,t=this;return this.canAnimate=!1,s(function(){return t.canAnimate=!0}),e=this.reverse?1:0,this.update(e),this.onBegin(),this},e.prototype.update=function(){throw new Error("Transition#update not implemented")},e.prototype.execute=function(){throw new Error("Transition#execute not implemented")},e.prototype.finish=function(e,t){var n,i=this;return n=function(){return i.execute(null!=e?e:!0,null!=t?t:i.duration,i.onFinish.bind(i)),i},this.canAnimate?n():(this.fromNode.offsetHeight,s(n),this)},e.prototype.onBegin=function(e){return null==e&&(e={}),this.emit("transition:begin")},e.prototype.onFinish=function(e){return null==e&&(e={}),this.emit("transition:end",e)},e}(),o.mixin(t,n.Emitter),e.exports=t}),require.define("transitions/flip",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C,T,q,P,E,L,A,N,R,F,M,O,B={}.hasOwnProperty,U=function(e,t){function n(){this.constructor=e}for(var i in t)B.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};p=require("blend/dom"),P=require("blend/lang"),h=require("blend/events"),f=require("blend/features"),E=require("blend/tick"),l=require("transitions/base"),_=1800,x=30,w=25,S=36,c=_,b=f.ie,F=!f.android,R=!(b&&f.arm),M=b,n=function(e){return Math.PI*e/180},a=function(e){return 180*e/Math.PI},t=function(e){var t;return t=0===e?0:e>0?1:-1,t*Math.pow(Math.abs(e),1/3)},i=function(e,t,n,i){return n*(-Math.pow(2,-10*e/i)+1)+t},r=function(e,t,n,i){return e/=i,-n*e*(e-2)+t},m=function(e,t){var n,i;return i=0,n=-Math.PI/2,n>e&&t===C?i=(e-n)/n:e>n&&t===T&&(i=(n-e)/n),.7*i},y=function(e,t){var n,i;return n=.1,i=0,i=t===k?e/(-Math.PI/2):(-Math.PI-e)/(-Math.PI/2),i=P.clamp(i,0,1),i*n},A=function(e,t){return"x"===e?"perspective("+c+"px) rotateY("+t+"rad)":"perspective("+c+"px) rotateX("+-t+"rad)"},C="left",T="right",k="front",I="back",s=function(){function e(e,t,n,i,r){var o,s,a,l,u,c,d,h,m,g,v,y,b,w,_;if(this.reuseNode=r,this.node=e,this.node.classList.add("fl-visible"),_=i.width,c=i.height,M&&this.node.classList.add("backface-visible"),a="",y="flap-shadow","x"===n)switch(u=Math.ceil(_/2),m=[0,u,c,0],v=[0,_,c,u],_%2>0&&(t===k?v[3]-=1:t===I&&(m[1]+=1)),h="rect("+m[0]+"px, "+m[1]+"px, "+m[2]+"px, "+m[3]+"px)",g="rect("+v[0]+"px, "+v[1]+"px, "+v[2]+"px, "+v[3]+"px)",t){case C:a=h,y+=" flat left";break;case T:a=g,y+=" flat right";break;case k:a=g,y+=" flap-gradient front";break;case I:a=h,y+=" flap-gradient back"}else switch(l=Math.ceil(c/2),w=[0,_,l,0],s=[l,_,c,0],c%2>0&&(t===k?w[2]-=1:t===I&&(s[0]+=1)),b="rect("+w[0]+"px, "+w[1]+"px, "+w[2]+"px, "+w[3]+"px)",o="rect("+s[0]+"px, "+s[1]+"px, "+s[2]+"px, "+s[3]+"px)",y+=" vertical",t){case C:a=b,y+=" flat left";break;case T:a=o,y+=" flat right";break;case k:a=o,y+=" flap-gradient front";break;case I:a=b,y+=" flap-gradient back"}this.overrideStyle("clip",a),this.overrideStyle("zIndex",x),d=f.safari&&!f.requestAnimationFrame,d&&t===C&&this.overrideStyle("zIndex",-1),this.shadowNode=document.createElement("div"),this.shadowNode.className=y,this.node.appendChild(this.shadowNode),F||(this.shadowNode.style.display="none"),p.setTextSelectable(this.node,!1),this.node.setAttribute("data-flap",t)
}return e.prototype.destroyed=!1,e.prototype.shadowNode=null,e.prototype.restoreStyles=function(){var e,t,n;n=this.oldStyles;for(e in n)t=n[e],this.node.style[e]=t;return this.oldStyles=null},e.prototype.overrideStyle=function(e,t){return null==this.oldStyles&&(this.oldStyles={}),this.oldStyles[e]=this.node.style[e],this.node.style[e]=t},e.prototype.destroy=function(){var e;if(!this.destroyed)return this.destroyed=!0,this.reuseNode?(this.node.classList.remove("fl-visible"),this.node.removeAttribute("data-flap"),this.restoreStyles(),null!=this.shadowNode&&this.node.removeChild(this.shadowNode),p.setTextSelectable(this.node,!0)):null!=(e=this.node.parentNode)?e.removeChild(this.node):void 0},e}(),o=function(e){function t(){return O=t.__super__.constructor.apply(this,arguments)}return U(t,e),t.prototype.destroy=function(){return this.leftFlap.destroy(),this.rightFlap.destroy(),this.frontFlap.destroy(),this.backFlap.destroy()},t.prototype.setup=function(){var e,t,i,r,o,a,l,u,d,p,h,f,m,g,v,y,b,w;for(d=this.fromNode.parentNode,this.axis=null!=(b=this.options.axis)?b:"x",w=[this.fromNode,this.toNode],v=0,y=w.length;y>v;v++)l=w[v],l.style.position="absolute",l.style.left="0",l.style.right="0";return o=this.fromNode.style.left,g=this.fromNode.style.top,o&&(this.toNode.setAttribute("data-left",this.toNode.style.left),this.toNode.style.left=o),g&&(this.toNode.setAttribute("data-top",this.toNode.style.top),this.toNode.style.top=g),t=this.fromNode,i=t.cloneNode(!0),f=this.toNode,m=f.cloneNode(!0),null!=this.fromNode.parentNode?u=this.fromNode.getBoundingClientRect():(d=document.body,u={width:window.innerWidth,height:window.innerHeight}),c=_,u.width>=1024?c*=1.2:Math.max(u.width,u.height)<=640&&(c/=1.5),a=this.reverse?f:t,p=this.reverse?t:f,r=this.reverse?m:i,e=this.reverse?i:m,this.leftFlap=new s(a,C,this.axis,u,!0),this.rightFlap=new s(p,T,this.axis,u,!0),this.frontFlap=new s(r,k,this.axis,u,!1),this.backFlap=new s(e,I,this.axis,u,!1),d.appendChild(this.frontFlap.node),d.appendChild(this.backFlap.node),h=this.reverse?n(-180):0,this.rotate(h)},t.prototype.update=function(e){var t;return t=-Math.PI*e,this.rotate(t),this},t.prototype.execute=function(e,t,n){var i,r,o=this;return null==t&&(t=this.duration),i=t>0,r=function(){var t,i,r,s;for(s=["left","top"],i=0,r=s.length;r>i;i++)t=s[i],o.toNode.style.removeProperty(t),o.toNode.getAttribute("data-"+t)&&(o.toNode.style[t]=o.toNode.getAttribute("data-"+t)),o.toNode.removeAttribute("data-"+t);return n({finished:e,fromPage:o.fromPage,toPage:o.toPage,reverse:o.reverse})},i?(M?this.finishWithKeyframes(e,t,r):this.finishWithTransitions(e,t,r),this):(r(),void 0)},t.prototype.finishWithKeyframes=function(e,t,i){var r,o,s,a,l,u,c,d=this;return a=null,o=!1,u=function(){return h.off(d.backFlap.node,f.animationEnd,r,!1),i()},r=function(e){return e.target===d.backFlap.node?(o=!0,u()):void 0},l=this.reverse?0:n(-180),e||(l=this.reverse?n(-180):0),g(this.axis,this.currentAngle,l,t),c=v(this.axis,this.currentAngle,l),N(this.frontFlap.node,"flip-front-"+c,t),N(this.backFlap.node,"flip-back-"+c,t),F&&(R?(N(this.leftFlap.shadowNode,"shadow-left-"+c,t),N(this.rightFlap.shadowNode,"shadow-right-"+c,t),N(this.frontFlap.shadowNode,"shadow-front-"+c,t),N(this.backFlap.shadowNode,"shadow-back-"+c,t)):(this.leftFlap.shadowNode.style.display="none",this.rightFlap.shadowNode.style.display="none",this.frontFlap.shadowNode.style.display="none",this.backFlap.shadowNode.style.display="none")),this.rotate(l),h.on(this.backFlap.node,f.animationEnd,r,!1),s=function(){return o?void 0:u()},a=setTimeout(s,t+300)},t.prototype.finishWithTransitions=function(e,t,n){var i,r,o,s,a,l,u,c,d,p,m,g,v,y,b=this;for(u=[this.frontFlap,this.backFlap,this.leftFlap,this.rightFlap],r=!1,a=function(){var e,t,r;for(h.off(b.backFlap.node,f.transitionEnd,i,!1),t=0,r=u.length;r>t;t++)e=u[t],e.node.style.removeProperty(f.jsToCss(f.transform)),e.node.style.removeProperty(f.jsToCss(f.transitionProperty)),e.node.style.removeProperty(f.jsToCss(f.transitionDuration));return n()},i=function(e){return e.target===b.backFlap.node?(r=!0,a()):void 0},y=[this.frontFlap.node,this.backFlap.node],p=0,g=y.length;g>p;p++)c=y[p],c.style[f.transitionProperty]=f.jsToCss(f.transform),c.style[f.transitionDuration]=""+t+"ms";for(m=0,v=u.length;v>m;m++)l=u[m],d=l.shadowNode,d.style[f.transitionProperty]="opacity",d.style[f.transitionDuration]=""+t+"ms";return this.reverse?(this.leftFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms",this.rightFlap.shadowNode.style[f.transitionTimingFunction]="ease-in",this.backFlap.shadowNode.style[f.transitionDuration]=""+t/6+"ms"):(this.leftFlap.shadowNode.style[f.transitionTimingFunction]="ease-in",this.rightFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms",this.frontFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms"),s=this.reverse?0:1,e||(s=1-s),this.update(s),h.on(this.backFlap.node,f.transitionEnd,i,!1),o=function(){return r?void 0:a()},setTimeout(o,t+100)},t.prototype.bounce=function(){var e=this;return document.documentElement.classList.add("flip-bounce"),"x"===this.axis&&document.documentElement.classList.add("flip-horizontal"),h.once(this.frontFlap.node,f.animationEnd,function(){return document.documentElement.classList.remove("flip-bounce"),document.documentElement.classList.remove("flip-horizontal"),e.onFinish({finished:!1,fromPage:e.fromPage,toPage:e.toPage,reverse:e.reverse})})},t.prototype.rotate=function(e){return null!=this.frontFlap?(this.currentAngle=e,this.frontFlap.node.style[f.transform]=A(this.axis,e),this.backFlap.node.style[f.transform]=A(this.axis,Math.PI+e),M&&(e<-Math.PI/2?(this.frontFlap.node.style.opacity=0,this.backFlap.node.style.opacity=1):(this.frontFlap.node.style.opacity=1,this.backFlap.node.style.opacity=0)),F?(this.leftFlap.shadowNode.style.opacity=m(e,C),this.rightFlap.shadowNode.style.opacity=m(e,T),this.frontFlap.shadowNode.style.opacity=y(e,k),this.backFlap.shadowNode.style.opacity=y(e,I)):void 0):void 0},t}(l),q={},u=[],N=function(e,t,n){return e.style[f.animation]=""+t+" "+n+"ms linear both"},v=function(e,t,n){var i,r;return r=t/-Math.PI*S,i=n/-Math.PI*S,r=r>i?Math.floor(r):Math.ceil(r),""+e+"-"+r+"-"+i},L=function(e,t){var n,i,r,o,s,a;if(M){for(n=0,r=-Math.PI/S,a=[],i=o=0,s=S+1;s>=0?s>=o:o>=s;i=s>=0?++o:--o)g(e,n,0,t),g(e,n,-Math.PI,t),a.push(n+=r);return a}},g=function(e,t,n,i){var o,s,a,l,c,d,h,g,b,_,x,S,P,E,L,N,R,F,M,O,B,U,D,z,H,G,j,W,V,X,K;if(M=v(e,t,n),null==q[M]){for(q[M]=!0,P=[],s=[],B=[],z=[],L=[],l=[],P.push("@"+f.keyframesCSS+" flip-front-"+M+" {"),s.push("@"+f.keyframesCSS+" flip-back-"+M+" {"),B.push("@"+f.keyframesCSS+" shadow-left-"+M+" {"),z.push("@"+f.keyframesCSS+" shadow-right-"+M+" {"),L.push("@"+f.keyframesCSS+" shadow-front-"+M+" {"),l.push("@"+f.keyframesCSS+" shadow-back-"+M+" {"),j=f.jsToCss(f.transform),F=0,x=0;i>=x;)G=x,o=t,h=n-t,S=i,_=r(G,o,h,S),D=x/i,D=Math.min(1,D),D*=100,R=A(e,_),d=A(e,Math.PI+_),E=_<-Math.PI/2?0:1,a=_<-Math.PI/2?1:0,U=m(_,C),H=m(_,T),N=y(_,k),c=y(_,I),P.push(""+D+"% { "+j+": "+R+"; opacity: "+E+"; }"),s.push(""+D+"% { "+j+": "+d+"; opacity: "+a+"; }"),B.push(""+D+"% { opacity: "+U+"; }"),z.push(""+D+"% { opacity: "+H+"; }"),L.push(""+D+"% { opacity: "+N+"; }"),l.push(""+D+"% { opacity: "+c+"; }"),F+=1,x+=w;for(P.push("}"),s.push("}"),B.push("}"),z.push("}"),L.push("}"),l.push("}"),null==u&&(u=[]),X=[P,s,B,z,L,l],K=[],W=0,V=X.length;V>W;W++)O=X[W],b=""+O.join(""),g=p.createCSSRule(b),K.push(u.push(g));return K}},d=function(){for(var e;(null!=u?u.length:void 0)>0;)null!=(e=u.pop())&&e.destroy();return u=null},e.exports=o,e.exports.pregenerateKeyframes=L}),require.define("transitions/stack",function(e){var t,n,i,r,o,s,a,l,u,c,d,p={}.hasOwnProperty,h=function(e,t){function n(){this.constructor=e}for(var i in t)p.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=require("blend/dom"),u=require("blend/lang"),r=require("blend/events"),o=require("blend/features"),c=require("blend/tick"),n=require("transitions/base"),l=385,a=.98,s=.6,e.exports=t=function(e){function t(){return d=t.__super__.constructor.apply(this,arguments)}return h(t,e),t.defaultDuration=l,t.prototype.setup=function(){var e,t,n,i,r,o,s,a;for(this.axis=null!=(o=this.options.axis)?o:"x",s=this.fromNode.getBoundingClientRect(),n=s.width,e=s.height,this.size="y"===this.axis?e:n,a=[this.fromNode,this.toNode],i=0,r=a.length;r>i;i++)t=a[i],t.style.position="absolute",t.style.left="0",t.style.right="0";return this.reverse?(this.toNode.style.zIndex=10,this.fromNode.style.zIndex=20):(this.toNode.style.zIndex=20,this.fromNode.style.zIndex=10)},t.prototype.update=function(e){var t,n,i,r,l;return l=this.size*(1-e),l=u.clamp(l,0,this.size),n=Math.max(a,1-a*e),t=Math.max(s,1-s*e),r=this.reverse?this.toNode:this.fromNode,i=this.reverse?this.fromNode:this.toNode,this.translate(i,l),r.style[o.transform]="translate3d(0,0,0) scale("+n+","+n+")",r.style.opacity=t,this},t.prototype.execute=function(e,t,n){var i,s,a,l,u,c,d,p=this;if(null==t&&(t=this.duration),i=t>0,s=function(){var e,t,i,r,s;for(e=o.jsToCss,s=[p.fromNode,p.toNode],i=0,r=s.length;r>i;i++)t=s[i],t.style.removeProperty(e(o.transitionDuration)),t.style.removeProperty(e(o.transitionTimingFunction)),t.style.removeProperty(e(o.transitionProperty)),t.style.removeProperty(e(o.transform)),t.style.removeProperty("opacity"),t.style.removeProperty("z-index");return n()},a=this.reverse?0:1,i){for(d=[this.fromNode,this.toNode],u=0,c=d.length;c>u;u++)l=d[u],l.style[o.transitionDuration]=""+t+"ms",l.style[o.transitionTimingFunction]="ease-in-out",l.style[o.transitionProperty]=""+o.jsToCss(o.transform)+" opacity";r.once(this.toNode,o.transitionEnd,s),this.update(a)}else this.update(a),s();return this},t.prototype.translate=function(e,t){return e.style[o.transform]="y"===this.axis?"translate3d(0,"+t+"px,0)":"translate3d("+t+"px,0,0)"},t}(n)}),require.define("transitions",function(e,t){t.Flip=require("transitions/flip"),t.Stack=require("transitions/stack")}),require.define("app/base/view-transitions",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k;for(p=require("blend/features"),o=require("blend/dom"),a=require("blend/events"),v=require("blend/tick"),i=require("transitions"),c=null,u=null,d=!1,x=function(e,t){var n;return e+=1e3,null==c?(n=function(){return d||(console.debug("Animation didn't finish, using fallback timer."),t()),r()},d=!1,c=setTimeout(n,e)):void 0},r=function(){return clearTimeout(c),c=null,u=null,d=!0},n={duration:350,timingFunction:"ease-in-out",durationMultiplier:1},b=function(e){return n.timingFunction=e},y=function(e){return n.durationMultiplier=e},t.setTimingFunction=b,t.setDurationMultiplier=y,t.getDefaultDuration=function(){return n.duration*n.durationMultiplier},f=function(e,t,i,o){var s,l,u,c,d,h,f,m,g,y,b,w;return null==i&&(i={}),l=null!=(b=i.duration)?b:n.duration,l*=n.durationMultiplier,h=!1,c=i.fillMode,u=null!=(w=i.edge)?w:"right",m=i.reverse===!0,s="top"===u||"bottom"===u?"Y":"X",f="right"===u||"bottom"===u?"100%":"-100%",d=function(){return h?void 0:(h=!0,r(),(i.fillMode="forwards")||e.style.removeProperty(p.jsToCss(p.transform)),e.style.removeProperty(p.jsToCss(p.transitionDuration)),e.style.removeProperty(p.jsToCss(p.transitionProperty)),e.style.removeProperty(p.jsToCss(p.transitionTimingFunction)),o())},g=function(){var t;return t=m?f:"0",e.style[p.transitionDuration]=""+l+"ms",e.style[p.transitionProperty]=p.jsToCss(p.transform),e.style[p.transform]="translate"+s+"("+t+")",e.style[p.transitionTimingFunction]=n.timingFunction,a.once(e,p.transitionEnd,d),x(l,d)},y=m?"0":f,e.style[p.transform]="translate"+s+"("+y+")",v(g),p.forceAnimSetupLayout?e.offsetHeight:void 0},m=function(e){return function(t,n,i,r){return null==i&&(i={}),i.edge=e,f(t,n,i,r)}},t.flyout=f,k=["Left","Right","Top","Bottom"],S=0,I=k.length;I>S;S++)s=k[S],t["flyout"+s]=m(s.toLowerCase());_=function(e,t,n,o){var s,a,l;return null==n&&(n={}),null==n.duration&&(n.duration=i.Stack.defaultDuration),l=new i.Stack(t,e,n),a=!1,s=function(){return a?void 0:(a=!0,r(),l.destroy(),"function"==typeof o?o():void 0)},l.begin().finish().once("transition:end",s),x(n.duration,s)},t.stackSlide=_,h=function(e,t,n,r){var o;return null==n&&(n={}),o=new i.Flip(t,e,n),o.begin().finish().once("transition:end",function(){return o.destroy(),"function"==typeof r?r():void 0})},t.flip=h,l=function(e,t,i,o){var s,l,u,c,d,h,f;return null==i&&(i={}),s=null!=(h=i.duration)?h:n.duration,c=null!=(f=i.matchPosition)?f:!0,u=!1,d=t.getBoundingClientRect(),c&&(e.style.position="absolute",e.style.left=""+d.left+"px",e.style.top=""+d.top+"px"),e.style.opacity=0,l=function(){return u?void 0:(u=!0,r(),o())},v(function(){var n,i,r,o;for(o=[e,t],i=0,r=o.length;r>i;i++)n=o[i],n.style[p.transitionProperty]="opacity",n.style[p.transitionDuration]=""+s+"ms";return e.style.opacity=1,t.style.opacity=0,a.once(e,p.transitionEnd,l),x(s,l)})},t.fade=l,g=30,w=function(e,t,i,o){var s,l,u,c,d,h,f;return null==i&&(i={}),s=null!=(h=i.duration)?h:440,s*=n.durationMultiplier,c=null!=(f=i.matchPosition)?f:!0,u=!1,d=t.getBoundingClientRect(),c&&(e.style.position="absolute",e.style.left=""+d.left+"px",e.style.top=""+d.top+"px"),e.style.opacity=0,e.style[p.transform]=i.reverse?"translateX(-"+g+"px)":"translateX("+g+"px)",l=function(){var n,s,a,l;if(!u){for(u=!0,r(),l=[e,t],s=0,a=l.length;a>s;s++)n=l[s],"forwards"!==i.fillMode&&n.style.removeProperty(p.jsToCss(p.transform)),n.style.removeProperty(p.jsToCss(p.transitionProperty)),n.style.removeProperty(p.jsToCss(p.transitionDuration)),n.style.removeProperty(p.jsToCss(p.transitionTimingFunction));return o()}},v(function(){var i,r,o,u;for(u=[e,t],r=0,o=u.length;o>r;r++)i=u[r],i.style[p.transitionProperty]=""+p.jsToCss(p.transform)+", opacity",i.style[p.transitionDuration]=""+s+"ms",i.style[p.transitionTimingFunction]=n.timingFunction;return t.style.opacity=0,e.style.opacity=1,e.style[p.transform]="translateX(0)",a.once(e,p.transitionEnd,l),x(s,l)})},t.shift=w}),require.define("imageLoader",function(e){var t,n,i,r,o,s,a;n=require("blend/dom"),i=require("blend/events"),a=require("blend/lang"),r=require("blend/features"),s=5,o=!1,e.exports=t=function(){function e(e){this.node=null!=e?e:document.body,this.pending={},this.queue=[]}return e.prototype.process=function(e){var t,i,r,o,a,l;for(null==e&&(e=this.node),i=n.all("[data-fl-image],[data-fl-image-appear],[data-fl-image-src]",e),l=[],o=0,a=i.length;a>o;o++)t=i[o],r=this.extractSource(t),Object.keys(this.pending).length>=s?l.push(this.enqueuePendingImage(t,r)):l.push(this.beginListening(t,r));return l},e.prototype.extractSource=function(e){var t,n,i,r,o;if(e.hasAttribute("data-fl-image-appearing"))return null;if(r=null!=(o=e.tagName)?o.toLowerCase():void 0,n=e.getAttribute("data-fl-image-src"),("null"===n||"undefined"===n)&&(n=null),!n)switch(r){case"img":n=e.getAttribute("src");break;default:i=getComputedStyle(e),t=i.backgroundImage.match(/url\(\s*(['"]?)(.*?)\1\s*\)/),3===(null!=t?t.length:void 0)&&(n=t[2])}return n||console.warn("Unable to parse image source:",e),n},e.prototype.beginListening=function(e,t){var r,s;return this.pending[t]?(this.pending[t].nodes.push(e),void 0):(r=document.createElement("img"),this.pending[t]={},this.pending[t].nodes=[e],this.pending[t].loadHandle=i.on(r,"load",this.imageLoaded.bind(this)),this.pending[t].errorHandle=i.on(r,"error",this.imageLoadFailed.bind(this)),t&&(r.src=t),r.setAttribute("data-original-src",t),r.style.visibility="hidden",s=r.naturalHeight>0,this.pending[t].loaded=s,s?this.imageLoaded({target:r}):null==t?this.imageLoadFailed({target:r}):o?n.append(r):void 0)},e.prototype.enqueuePendingImage=function(e,t){return this.queue.push({image:e,src:t})},e.prototype.dequeuePendingImages=function(){var e,t;for(t=[];this.queue.length>0&&Object.keys(this.pending).length<s;)e=this.queue.shift(),t.push(this.beginListening(e.image,e.src));return t},e.prototype.imageLoaded=function(e){return this.imageLoadCompleted(e,!0),this.dequeuePendingImages()},e.prototype.imageLoadFailed=function(e){return this.imageLoadCompleted(e,!1),this.dequeuePendingImages()},e.prototype.imageLoadCompleted=function(e,t){var i,r,o,s,a,l,u,c,d,p,h,f,m,g;if(a=e.target.getAttribute("data-original-src"),o=this.pending[a]){for(f=o.nodes,l=0,d=f.length;d>l;l++){if(s=f[l],s.getAttribute("data-fl-image-src")){if(t)"img"===s.tagName.toLowerCase()?s.setAttribute("src",a):s.style.backgroundImage="url('"+a+"')";else if(s.hasAttribute("data-fl-image-load-failed-classes"))for(r=s.getAttribute("data-fl-image-load-failed-classes"),m=r.split(","),u=0,p=m.length;p>u;u++)i=m[u],s.classList.add(i);else s.classList.add("fl-image-load-failed");s.removeAttribute("data-fl-image-src")}t&&this.emit("image:loaded",{node:s,src:a}),s.hasAttribute("data-fl-image-appear")?this.appearAnimated(s,a,o.loaded):this.emit("image:appeared",{node:s,src:a,animated:!1})}for(g=o.nodes,c=0,h=g.length;h>c;c++)s=g[c],s.removeAttribute("data-fl-image");return o.loadHandle.detach(),o.errorHandle.detach(),n.remove(e.target),delete this.pending[a]}},e.prototype.appearAnimated=function(e,t,n){var o,s,a,l=this;return null==n&&(n=!1),a=r.requestAnimationFrame&&!n,a=a&&!r.android,o=function(){return l.emit("image:appeared",{node:e,src:t,animated:a}),e.removeAttribute("data-fl-image-appear"),e.removeAttribute("data-fl-image-appearing"),"undefined"!=typeof s&&null!==s?s.detach():void 0},a?(e.setAttribute("data-fl-image-appearing",""),s=i.on(e,r.animationEnd,o,!0)):o()},e}(),a.mixin(t,i.Emitter)}),require.define("app/base/view",function(e){var t,n,i,r,o,s,a,l,u,c,d,p=function(e,t){return function(){return e.apply(t,arguments)}},h=[].slice;l=require("blend/dom"),u=require("blend/events"),d=require("blend/lang"),c=require("blend/i18n"),i=require("blend/node"),a=require("blend/watch"),o=require("app/base/view-transitions"),n=require("imageLoader"),s=0,r={},e.exports=t=function(){function e(e){var t,n;null==e&&(e={}),this.autobind=p(this.autobind,this),this.renderWith=p(this.renderWith,this),this.events=[],this.children=[],this.uniqueId=s++,this.i18n=c,this.customSelector="";for(t in e)n=e[t],this[t]=n;this.createRenderingContext()}return d.mixin(e,u.Emitter),d.mixin(e,a),e.register=function(e){return r[e]=this},e.transitionStyle=null,e.events={},e.imageLoader=new n,e.property("node",{set:function(e){return e instanceof HTMLElement?(this._node=e,this._node.setAttribute("data-view-id",this.uniqueId)):void 0}}),e.prototype.destroy=function(){return this.off("*"),this.unwatch("*"),this.deactivate(),this.forwardMethod("destroy")},e.prototype.ready=function(){},e.prototype.beforeRender=function(){},e.prototype.afterRender=function(){},e.prototype.afterAttach=function(){},e.prototype.afterDetach=function(){},e.prototype.beforeShow=function(){},e.prototype.afterShow=function(){},e.prototype.beforeHide=function(){},e.prototype.afterHide=function(){},e.prototype.deactivate=function(){return this.unbindEvents(),this.forwardMethod("deactivate")},e.prototype.activate=function(){return this.bindEvents(),this.forwardMethod("activate")},e.prototype.forwardMethod=function(){var e,t,n,i,r,o,s;for(n=arguments[0],e=2<=arguments.length?h.call(arguments,1):[],o=this.children,s=[],i=0,r=o.length;r>i;i++)t=o[i],s.push(t[n].apply(t,e));return s},e.prototype.execRenderLifecycle=function(){var e;return e=null,this._ready||(this._ready=!0,this.ready()),this.execLifecycleEvent("beforeRender"),this.node=this.render(this.renderContext),this.execLifecycleEvent("afterRender"),this.node},e.prototype.execLifecycleEvent=function(e){switch(this[e](this.renderContext),e){case"afterShow":this.active=!0;break;case"beforeHide":this.active=!1;break;case"afterRender":this.processImages()}return this.emit("view:"+e)},e.prototype.processImages=function(t){return null==t&&(t=this.node),e.imageLoader.process(t)},e.prototype.render=function(){var e;return null!=this.node?this.node:(null!=this.constructor.template&&(e=this.templateHtml(),this.node=l.create(e)),this.node)},e.prototype.refresh=function(){var e,t,n,r,o,s;if(null!=this.node){for(this.execLifecycleEvent("beforeRender"),null!=this.constructor.template||null!=this.constructor.templateName?(t=this.templateHtml(),n=l.create(t)):n=this.render(this.renderContext),this.node.innerHTML=n.innerHTML,s=n.attributes,r=0,o=s.length;o>r;r++)e=s[r],this.node.setAttribute(e.name,e.value);return this.customSelector.length>0&&i.applySelector(this.customSelector,this.node),this.execLifecycleEvent("afterRender"),this}},e.prototype.update=function(){return this.refresh(),this},e.prototype.one=function(e){return l.one(e,this.node)},e.prototype.all=function(e){return l.all(e,this.node)},e.prototype.bindEvents=function(){var e,t,n,i,r,o,s,a,l,c,d,p,h,f;for(this.events.length>0&&this.unbindEvents(),e=this.constructor,n={};null!=e;){p=e.events;for(a in p)d=p[a],n[a]=d;e=null!=(h=e.__super__)?h.constructor:void 0}f=[];for(t in n)r=n[t],t=t.trim(),s=t.indexOf(" "),c=s>-1?t.substr(0,s):t,l=s>=0?t.substr(s+1).trim():null,o=null,i=this[r].bind(this),o="window"===l?u.on(window,c,i):"document"===l?u.on(document,c,i):(null!=l?l.length:void 0)>0?u.delegate(this.node,l,c,i):u.delegate(document.body,"[data-view-id='"+this.uniqueId+"']",c,i),f.push(this.events.push(o));return f},e.prototype.unbindEvents=function(){var e,t,n,i,r;for(r=null!=(i=this.events)?i:[],t=0,n=r.length;n>t;t++)e=r[t],e.detach();return this.events=[]},e.prototype.createRenderingContext=function(){var e,t,n,o=this;e=function(e,t){return o.renderContext[e]=function(){var e,n,r,s,a,l,u,c,d,p,f,m;for(n=1<=arguments.length?h.call(arguments,0):[],m=[null,{}],c=m[0],u=m[1],p=0,f=n.length;f>p;p++)if(e=n[p],"string"==typeof e)c=e;else if("object"==typeof e&&Object.keys(e).length>0)for(l in e)d=e[l],u[l]=d;a=new t,o.children.push(a),r={};for(l in u)d=u[l],a.hasProperty(l)?a[l]=d:r[l]=d;s=a.execRenderLifecycle();for(l in r)d=r[l],"className"===l?s.classList.add(d):s.setAttribute(l,d);return null!=c&&(a.customSelector=c,i.applySelector(c,s)),s}},this.renderContext=d.mixin({},i);for(n in r)t=r[n],e(n,t);return this.renderContext.autobind=this.autobind,this.renderContext["with"]=this.renderWith},e.prototype.renderWith=function(e,t){var n,i;if("string"==typeof e&&(e=this.one(e)),null!=e){for(n=this.renderContext.div(t),i=[];n.children.length>0;)i.push(e.appendChild(n.children[0]));return i}},e.prototype.autobind=function(){var e,t,n,i,r,o,s,a,l,u,c,d,p=this;for(r=arguments[0],e=2<=arguments.length?h.call(arguments,1):[],s=e[e.length-1],l=e.length>1?e[0]:null,a=null,t=function(){return p.renderContext.div({style:"display:none"})},o=function(e){var n,i,r,o,u,c,d,h,f,m,g,v,y;if("function"==typeof(null!=(v=p[e])?v.push:void 0)?(d=p[e].map(s),0===d.length&&(d=t())):(d=s(p[e]),null==d&&(d=t())),null!=a)if(r=null!=a.length?a:[a],c=r[0],u=c.parentNode,"function"==typeof l)l(d,a,u);else{for(n=null!=d.length?d:[d],h=0,m=n.length;m>h;h++)o=n[h],null!=u&&u.insertBefore(o,c);for(f=0,g=r.length;g>f;f++)i=r[f],null!=(y=i.parentNode)&&y.removeChild(i)}return a=d},i=Array.isArray(r)?r:[r],d=[],u=0,c=i.length;c>u;u++)n=i[u],this.watch(n,function(){return o(n),p.execLifecycleEvent("afterRender")}),d.push(o(n));return d},e.prototype.templateHtml=function(){var e;return e=null,this.constructor.template&&(e=this.constructor.template),e},e.prototype.addChild=function(e,t){var n,i;return null==t&&(t=this.node),e.controller=this.controller,e.parentView=this,e.execRenderLifecycle(),e.activate(),this.children.push(e),n=null!=(i=e.constructor.transitionStyle)?i:e.transitionStyle,this.presentChild(e,t,n)},e.prototype.removeChild=function(e){var t,n,i,r,o,s;for(o=this.children,s=[],n=i=0,r=o.length;r>i;n=++i){if(t=o[n],t===e){t.parentView=null,t.destroy(),l.remove(t.node),this.children.splice(n,1);break}s.push(void 0)}return s},e.prototype.presentChild=function(e,t,n){var i,r,s,a,u;return u=e.node,t.appendChild(u),e.execLifecycleEvent("afterAttach"),e.execLifecycleEvent("beforeShow"),i=null,e.dismiss=r=function(){var n;return e.execLifecycleEvent("beforeHide"),n={reverse:!0,fillMode:"forwards"},a(u,t,n,function(){return e.dismiss=null,e.execLifecycleEvent("afterHide"),e.destroy(),l.remove(u)})},s=function(){return e.execLifecycleEvent("afterShow")},a=o[n],"function"==typeof a?a(u,t,{},s):s()},e}()}),require.define("app/controls/control",function(e){var t,n,i,r,o,s=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("blend"),i=o.dom,r=o.events,t=require("app/base/view"),e.exports=n=function(e){function t(){this.internalClicked=s(this.internalClicked,this),t.__super__.constructor.apply(this,arguments),this._clickHandle=r.delegate(document.body,"[data-view-id='"+this.uniqueId+"']","click",this.internalClicked)}return l(t,e),t.property("context"),t.prototype.destroy=function(){var e,n,i,r,o,s;for(t.__super__.destroy.apply(this,arguments),this._clickHandle.detach(),o=null!=(r=this._handlerNames)?r:[],s=[],n=0,i=o.length;i>n;n++)e=o[n],s.push(this[e]=null);return s},t.controlEvent=function(e){return this.property(e,{set:function(t){var n;return n="_"+e+"Handlers",null==this[n]&&(this[n]=[],null==this._handlerNames&&(this._handlerNames=[]),this._handlerNames.push(n)),this[n].unshift(t)}})},t.controlEvent("click"),t.prototype.emitControlEvent=function(e,t,n){var i,r,o,s,a,l,u;if(null==n&&(n={}),r="_"+e+"Handlers",(null!=(a=this[r])?a.length:void 0)>0){for(l=this[r],u=[],o=0,s=l.length;s>o;o++)i=l[o],u.push(i(t,this,n));return u}},t.prototype.internalClicked=function(e){return this.emitControlEvent("click",e),this.clicked(e)},t.prototype.clicked=function(){},t}(t)}),require.define("app/controls/overlay",function(e){var t,n,i,r,o={}.hasOwnProperty,s=function(e,t){function n(){this.constructor=e}for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=require("app/controls/control"),t="fl-click-eater",e.exports=i=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments)}return s(n,e),n.register("overlay"),n.property("alpha",{"default":0}),n.prototype.render=function(e){return e.div("."+t,{style:"background-color: #000; opacity: "+this.alpha+";"})},n}(n),e.exports.CLASSNAME=t}),require.define("app/controls/dialog",function(e){var t,n,i,r,o,s,a,l,u,c,d={}.hasOwnProperty,p=function(e,t){function n(){this.constructor=e}for(var i in t)d.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("blend/dom"),s=require("blend/events"),u=require("blend/lang"),a=require("blend/features"),c=require("blend/tick"),l=require("blend/i18n"),r=require("app/controls/overlay"),n=require("app/controls/control"),t={hidden:"dialog-hidden",animate:"dialog-animate"},e.exports=i=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.windowResized=u.throttled(this.positionContent.bind(this),150),this.selfDestruct&&this.on("view:afterHide",this.destroy.bind(this))}return p(n,e),n.property("overlayAlpha",{"default":0}),n.property("clickToDismiss",{"default":!1}),n.property("overlayDismiss",{"default":!1}),n.property("html",{"default":""}),n.property("contentClass"),n.property("selfDestruct",{"default":!0}),n.property("minimumDuration",{"default":0}),n.property("positionAnchor"),n.events={"resize window":"windowResized","click *":"clicked"},n.prototype.render=function(e){var t=this;return e.div(".dialog-control",function(){return t.contentNode=t.renderContent(e),e.overlay({alpha:t.overlayAlpha,click:t.clickedOverlay.bind(t)})})},n.prototype.renderContent=function(e){var t=this;return e.div(".dialog",function(){var n;return n=e.div(".dialog-content"),null!=t.contentClass&&n.classList.add(t.contentClass),n.innerHTML=t.html})},n.prototype.afterAttach=function(){return this.positionContent()},n.prototype.show=function(){var e,n,i,l,u,d,p=this;if(null==(null!=(u=this.node)?u.parentNode:void 0)){for(this.lastShowTime=Date.now(),this.execRenderLifecycle(),n=this.one("."+r.CLASSNAME),d=[this.contentNode,n],i=0,l=d.length;l>i;i++)e=d[i],e.classList.add(t.hidden);return o.append(this.node),this.execLifecycleEvent("afterAttach"),c(function(){var i,r,o,l,u;for(p.execLifecycleEvent("beforeShow"),u=[p.contentNode,n],o=0,l=u.length;l>o;o++)e=u[o],e.classList.add(t.animate),e.classList.remove(t.hidden);return p.activate(),r=!1,i=function(){var i,o,s;if(!r){for(s=[p.contentNode,n],i=0,o=s.length;o>i;i++)e=s[i],e.classList.remove(t.animate);p.execLifecycleEvent("afterShow")}return r=!0},s.once(p.contentNode,a.transitionEnd,i),setTimeout(i,1e3,i)}),this}},n.prototype.hide=function(){var e,n,i,l,u,c,d,p,h=this;if(null!=this.lastShowTime&&Date.now()-this.lastShowTime<this.minimumDuration)return setTimeout(this.hide.bind(this),this.minimumDuration-(Date.now()-this.lastShowTime)),void 0;if(null!=(null!=(d=this.node)?d.parentNode:void 0)){for(this.execLifecycleEvent("beforeHide"),l=this.one("."+r.CLASSNAME),p=[this.contentNode,l],u=0,c=p.length;c>u;u++)i=p[u],i.classList.add(t.animate),i.classList.add(t.hidden);return n=!1,e=function(){var e,r,s;if(!n){for(o.remove(h.node),s=[h.contentNode,l],e=0,r=s.length;r>e;e++)i=s[e],i.classList.remove(t.animate),i.classList.remove(t.hidden);h.execLifecycleEvent("afterHide")}return n=!0},s.once(this.contentNode,a.transitionEnd,e),setTimeout(e,1e3),this}},n.prototype.positionContent=function(){var e,t,n,i,r,o;return this.contentNode.style.position="absolute",this.contentNode.style.display="block",this.contentNode.style.visibility="hidden",o=this.contentNode.getBoundingClientRect(),r=o.width,i=o.height,this.contentNode.style.display="none",this.contentNode.style.removeProperty("visibility"),n=window.innerHeight/2-i/2,t=window.innerWidth/2-r/2,null!=this.positionAnchor&&(e=this.positionAnchor.getBoundingClientRect(),n=Math.min(e.top-i,window.innerHeight-i),t=Math.min(e.left+e.width/2-r/2,window.innerWidth-r)),this.contentNode.style.top=""+Math.max(n,0)+"px",this.contentNode.style.left=""+Math.max(t,0)+"px",this.contentNode.style.removeProperty("display")},n.prototype.clickedOverlay=function(){return this.overlayDismiss?this.hide():void 0},n.prototype.clicked=function(){return this.clickToDismiss?this.hide():void 0},n.showToast=function(e,t){var i;return null==t&&(t=2.5),i=new n({html:e}),i.overlayDismiss=!0,i.clickToDismiss=!0,i.show(),setTimeout(i.hide.bind(i),1e3*t),i},n.showLoading=function(e,t,i){var r,o,s;return null==e&&(e=!0),null==t&&(t=l.t("loading")),null==i&&(i=0),o=["<span>"+t+"</span>"],e&&o.unshift('<progress class="spinny"></progress>'),o=o.join(""),r="dialog-loading",i&&(i*=1e3),s=new n({html:o,contentClass:r,minimumDuration:i}),s.show()},n}(n)}),require.define("app/controls/alert",function(e){var t,n,i,r,o,s,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=require("blend/async"),o=require("blend/features"),s=require("blend/lang"),n=require("app/controls/dialog"),i={close:"alert:close"},e.exports=t=function(e){function t(){var e=this;this.overlayDismiss=!0,this.overlayAlpha=.7,this.on(i.close,function(t){return t.halted()?void 0:e.hide()}),t.__super__.constructor.apply(this,arguments)}return l(t,e),t.register("alert"),t.property("title"),t.property("message"),t.property("closeButton",{"default":!0}),t.property("okButton",{"default":!1}),t.property("cancelButton",{"default":!1}),t.property("okText",{"default":"ok_button"}),t.property("cancelText",{"default":"cancel_button"}),t.property("buttons",{collection:Object}),t.events={"click .close":"clickedClose","click .cancel":"clickedCancel","click .okay":"clickedOk","click .custom":"clickedCustomButton"},t.prototype.renderContent=function(e){var t=this;return e.div(".alertbox",function(){return null!=t.title&&e.span(".title",t.title),null!=t.message&&e.p(".message",t.message),e.div(".button-wrap",function(){var n;return t.closeButton&&e.a(".close",{role:"button"},function(){return e.i(".icon-close")
}),t.cancelButton&&e.button(".fl-button.cancel",{tabIndex:"2"},t.i18n.t(t.cancelText)),t.okButton&&e.button(".fl-button.fl-done.okay",{tabIndex:"1"},t.i18n.t(t.okText)),t.buttons?null!=(n=t.buttons)?n.map(function(t,n){return e.button(".fl-button.custom",{"data-button-index":n},t.label)}):void 0:void 0})})},t.prototype.clickedClose=function(){return this.emit(i.close)},t.prototype.clickedCancel=function(){return this.emit(i.close,{ok:!1,id:"cancel"})},t.prototype.clickedOk=function(){return this.emit(i.close,{ok:!0,id:"ok"})},t.prototype.clickedCustomButton=function(e){var t,n;return n=e.matchedTarget.getAttribute("data-button-index"),t=this.buttons[n],this.emit(i.close,{id:t.id})},t.prototype.clickedOverlay=function(){return t.__super__.clickedOverlay.apply(this,arguments),this.emit(i.close)},t.showMessage=function(e,n){var i;return 1===arguments.length&&(n=e,e=null),i={title:e,message:n,closeButton:!0},new t(i).show()},t.showConfirm=function(e,n,o,a){var l,u,c,d,p;return p=r.defer(),c=p.promise,d=p.resolve,1===arguments.length&&(n=e,e=null),u={title:e,message:n,closeButton:!1,cancelButton:!0,cancelText:o,okButton:!0,okText:a},l=new t(u),s.merge(l,c),l.on(i.close,function(e){return d(e.ok)}),l.show()},t}(n),e.exports.EVENTS=i}),require.define("app/base/model",function(e){var t,n,i,r,o;o=require("blend/lang"),r=require("blend/events"),i=require("blend/watch"),t=function(){function e(e){this.update(e)}return e.autoProperties=!1,e.prototype.clone=function(){return new this.constructor(JSON.parse(JSON.stringify(this.encode())))},e.prototype.update=function(e){var t,n,i,r;if(null==e&&(e={}),"object"!=typeof e)return this;t=this.constructor.autoProperties,n=this.constructor.allProperties();for(i in e)r=e[i],t&&null==n[i]&&this.constructor.property(i),this.updateProperty(i,r),n[i]?this.updateProperty(i,r,n[i]):this[i]=r;return this},e.prototype.updateProperty=function(e,t,n){var i,r,o,s;if("function"==typeof(null!=n?n.collection:void 0)&&(null!=t?t.length:void 0)>0){for(i=[],o=0,s=t.length;s>o;o++)r=t[o],r instanceof n.collection||(r=new n.collection(r)),i.push(r);return this[e]=i}return this[e]=t},e.prototype.find=function(e){return null==e&&(e={}),new this.constructor(e)},e.prototype.encode=function(){var e,t,n,i,r;t={},i=this.constructor.allProperties();for(n in i)e=i[n],e.persist!==!1&&(r=this.encodeProperty(n,e),null!=r&&(t[n]=r));return t},e.prototype.encodeProperty=function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h;if(a=this[e],"function"==typeof(null!=a?a.encode:void 0)&&(a=a.encode()),t.collection&&(null!=a?a.length:void 0)>0){for(i=[],c=[0,a.length],s=c[0],n=c[1],"string"==typeof t.persist&&(d=t.persist.split(" "),r=d[0],n=d[1],"last"===r&&(s=a.length-n),s=Math.min(s,a.length-1)),p=a.slice(s,n),l=0,u=p.length;u>l;l++)o=p[l],i.push(null!=(h=null!=o?"function"==typeof o.encode?o.encode():void 0:void 0)?h:o);a=i}return a},e.prototype.decode=function(e){var t,n,i,r,o;t={},r=this.constructor.allProperties();for(i in e)o=e[i],null!=r[i]&&(n=r[i],o=this.decodeProperty(i,o,n)),t[i]=o;return t},e.prototype.decodeProperty=function(e,t,n){var i,r,o,s,a,l,u;if("function"==typeof(null!=(l=n.collection)?null!=(u=l.prototype)?u.decode:void 0:void 0)&&(null!=t?t.length:void 0)){for(i=[],s=0,a=t.length;a>s;s++)r=t[s],o=new n.collection,o.update(o.decode(r)),i.push(o);t=i}return t},e}(),n={teapot:"error:teapot"},o.mixin(t,r.Emitter),o.mixin(t,i),e.exports=t,e.exports.ERRORS=n}),require.define("devices",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C,T,q,P,E,L,A,N,R,F,M,O,B,U,D,z,H,G,j,W,V,X,K,Y,Q,J,Z={}.hasOwnProperty,$=function(e,t){function n(){this.constructor=e}for(var i in t)Z.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};l=require("blend/async"),c=require("blend/cache"),C=require("blend/http"),P=require("blend/lang"),q=require("blend/jsonp"),U=require("blend/router"),t=require("app/controls/alert"),o=require("app/base/model"),h=!0;try{window.external.notify(JSON.stringify({method:"HealthCheck",params:{}}))}catch(et){y=et,h=!1}for("undefined"!=typeof flipboardLocalStorage&&null!==flipboardLocalStorage&&c.setStorage(flipboardLocalStorage),i={},Q=["default","win8","winphone"],K=0,Y=Q.length;Y>K;K++)g=Q[K],i[g]=g;s="device_platform",n={base_url:{"default":"/app",win8:h?window.location.pathname:"/app",winphone:h?window.location.pathname:"/app"},include_toc:{"default":!1,win8:!0,winphone:!0},include_search:{"default":!1,win8:!0,winphone:!0},include_get_app_button:{"default":!0,win8:!1,winphone:!1},render_back_buttons:{"default":!1,win8:!0,winphone:!1},open_urls_with_external_notify:{"default":!1,win8:h,winphone:h},include_app_bars:{"default":!1,win8:!0},include_winphone_app_bar:{"default":!1,winphone:!0},cookie_login:{"default":!0,win8:!1,winphone:!1},duplo_theme:{"default":"default",win8:"windows",winphone:"windows"},support_in_app_navigation:{"default":!1,win8:!0,winphone:!0},has_system_dialog:{"default":!1,win8:h,winphone:h},has_pin_to_start:{"default":!1,win8:h,winphone:h},page_transition_type:{"default":"flip"},page_transition_axis:{"default":"x",winphone:"y"},page_hover_hints:{"default":!0,win8:!1,winphone:!1},has_local_resources:{"default":!1,win8:h,winphone:h},right_click_app_bars:{"default":!1,win8:h,winphone:h},log_external:{"default":!1,win8:h,winphone:h},jira_project_internal:{"default":"WEB",win8:"WIN",winphone:"WIN"},jira_project_external:{"default":null,win8:"EWB",winphone:"EWB"},has_live_tile:{"default":!1,win8:!0,winphone:!0},return_stringify_to_external:{"default":!1,win8:!0,winphone:!0},has_bug_attachments:{"default":!1,win8:h,winphone:h},view_anim_duration_multiplier:{"default":1,win8:1.4,winphone:1.4},view_anim_timing:{"default":"ease-in-out",win8:"cubic-bezier(0.1, 0.9, 0.2, 1)",winphone:"cubic-bezier(0.1, 0.9, 0.2, 1)"},has_external_tuuid_udid:{"default":!1,win8:h,winphone:h},show_default_avatar:{"default":!1,win8:!0,winphone:!0},view_on_web_target:{"default":"_blank",win8:"_windefaultbrowser",winphone:"_windefaultbrowser"},web_item_display_type:{"default":"iframe",win8:h?"webview":"iframe",winphone:h?"webview":"iframe"},has_audio_playback:{"default":!0,win8:function(){return k("Audio.SetPlaylist")},winphone:function(){return k("Audio.SetPlaylist")}},config_idiom:{"default":"web",win8:"windows",winphone:"winphone"},start_on_cover_stories:{"default":!1,winphone:!0},show_cover_page_in_cover_stories:{"default":!1,winphone:!0},enable_feed_cache:{"default":!1,win8:!0,winphone:!0}},w={},_=!1,u={},m=i["default"],V=c.create("device-values"),r=function(e){function t(){return J=t.__super__.constructor.apply(this,arguments)}return $(t,e),t.property("tuuid"),t.property("udid"),t.property("cgLocale"),t.property("cgLang"),t.property("internetConnection",{"default":!0,parseBool:!0}),t.property("device"),t.property("ver"),t.property("model"),t.property("manufacturer"),t.property("oempreload"),t.property("flipster"),t.property("shareTarget",{"default":!1,parseBool:!0}),t.property("forceServeAds",{"default":!1,parseBool:!0,internalSetting:!0,displayName:"Force Serve Ads"}),t.property("debugoutsets",{"default":!1,parseBool:!0,internalSetting:!0,displayName:"Show Hit Outsets"}),t.property("duplo_showLayouts",{"default":!1,parseBool:!0,internalSetting:!0,displayName:"Show Duplo Layouts"}),t.property("duplo_showScores",{"default":!1,parseBool:!0,internalSetting:!0,displayName:"Show Duplo Scores"}),t}(o),W=new r,x=function(e){var t,r,o;return e in n?(t=null!=(r=null!=(o=n[e][m])?o:n[e][i["default"]])?r:null,"function"==typeof t&&(t=t.call(this)),t):(console.warn("Unknown device platform value requested: "+e),null)},I=function(e){return W[e]},k=function(e){return u[e]===!0},D=function(e,t){return W[e]=t,V.set(e,t)},H=function(){return W.unwatch.apply(W,arguments)},X=function(){return W.watch.apply(W,arguments)},S=function(){var e,t,n,i;e=[],i=r.allProperties();for(t in i)n=i[t],n.internalSetting&&e.push({displayName:n.displayName||t,id:t,value:I(t),type:n.parseBool?"boolean":"string"});return x("return_stringify_to_external")&&(e=JSON.stringify(e)),e},v={},d=function(e,t){var n;if(null==t&&(t={}),h){n={method:e,params:t};try{return window.external.notify(JSON.stringify(n))}catch(i){y=i}}},p=function(e,t){var n,i,r;null==t&&(t={}),n=l.defer(),r=Math.random().toString().substring(2,12),v[r]=n,t.responseId=r,i={method:e,params:t};try{window.external.notify(JSON.stringify(i))}catch(o){y=o,n.reject(y)}return n.promise},N=function(e,t){var n;return n=v[e],delete v[e],null!=n?n.reject(t):void 0},R=function(e,t){var n;return n=v[e],null!=n?n.notify(t):void 0},F=function(e,t){var n;return n=v[e],delete v[e],null!=n?n.resolve(t):void 0},b=function(e){return function(){var t;return t=e.apply(this,arguments),x("return_stringify_to_external")&&(t=JSON.stringify(t)),t}},a=function(){return d("AppReady",{})},E=function(e){return x("log_external")?d("Console.Log",{message:null!=e?e.toString():void 0}):void 0},L=function(e){return h?d("Console.Error",e):void 0},A=function(e,t){return d("NotifyAppEvent",{eventName:e,eventData:t})},w.PhotoCaptureUpload=function(e){return p("PhotoCaptureUpload",e)},w.RateInAppStore=function(){return d("RateInAppStore")},M=function(){var e,t;return x("has_external_tuuid_udid")?(e=p("ResetTuuid",{}),e.then(function(e){return D("tuuid",e)}),e):(t=P.guid(),D("tuuid",t),D("udid",I("udid")),l.resolve(t))},w.RestartWebApp=function(){return d("RestartWebApp")},z=function(e,n,i){var r,o,s,a,u;return null==i&&(i=[]),x("has_system_dialog")?p("ShowDialog",{title:e,message:n,buttons:i}):(u=l.defer(),r=u.promise,o=u.resolve,a=s=!0,i.length>0&&(i=i.filter(function(e){return e.default_confirm?(a=!0,!1):e.default_cancel?(s=!0,!1):!0})),new t({title:e,message:n,closeButton:!1,cancelButton:s,okButton:a,buttons:i}).show().on("alert:close",function(e){return o(e.id)}),r)},w.ShowPopupMenu=function(e,t){var n,i;if(null==e&&(e=[]),null==t&&(t={}),n={items:e},null!=t.positionTarget)try{i=t.positionTarget.getBoundingClientRect(),n.positionX=i.left,n.positionY=i.top,n.positionWidth=i.width,n.positionHeight=i.height}catch(r){y=r,console.log("devices.ShowPopupMenu: couldn't get position from position target: "+y)}else null!=t.positionX&&(n.positionX=t.positionX),null!=t.positionY&&(n.positionY=t.positionY),null!=t.positionWidth&&(n.positionWidth=t.positionWidth),null!=t.positionHeight&&(n.positionHeight=t.positionHeight);return p("ShowPopupMenu",n)},w.SetClickOverlay=function(e){return p("SetClickOverlay",e)},w.ShowEditProfileFlyout=function(e){return null==e&&(e=!1),d("ShowEditProfileFlyout",{editAvatar:e})},w.UnsetClickOverlay=function(e){return d("UnsetClickOverlay",{id:e})},B={},O=function(e){var t,n,i,r,o,s,a,u;if(null!=B[e])return l.resolve(B[e]);if(x("has_local_resources"))o=p("GetResourceFile",{path:e});else{if(r={},!x("cookie_login"))for(u=["udid","tuuid","device","ver","model"],s=0,a=u.length;a>s;s++)n=u[s],t=I(n),null!=t&&(r[n]=t);i={path:"/resource/"+e,params:r},o=C.get(i)}return o.then(function(t){return B[e]=t}),o},G=function(e,t){return x("has_bug_attachments")?d("UploadBugAttachments",{url:e,attachments:t}):void 0},j=function(e){var t,n;return t={},(null!=e?e.isSignedIn():void 0)&&(t.userid=e.userid,t.name=e.name,t.email=e.email,t.profileImageURL=null!=(n=e.profileImage)?n.smallURL:void 0,t.description=e.description),d("UserUpdated",t)},f=function(){var e,t,n,r,o,a,l,u,c;t=C.parseQuery(window.location.search),t[s]in i&&(m=t[s]),a=W.constructor.allProperties();for(e in a)n=a[e],n.internalSetting&&(W[e]=V.get(e)),e in t&&(W[e]=t[e]);if(null==I("tuuid")&&D("tuuid",null!=(l=V.get("tuuid"))?l:P.guid()),null==I("udid")&&D("udid",null!=(u=V.get("udid"))?u:P.guid()),x("log_external")){for(c=["debug","dir","dirxml","error","info","log","trace","warn"],r=0,o=c.length;o>r;r++)e=c[r],window.console[e]=E;return C.setLogger(E),q.setLogger(E)}},f(),T=function(){return h&&!_?p("GetSupportedMethods",{}).then(function(t){var n,i,r,o;if(!_){for(_=!0,o=[],i=0,r=t.length;r>i;i++)n=t[i],u[n]=!0,w[n]?(null!=e.exports[n]&&console.warn("Devices: feature-detected native method `"+n+"` being overriden"),o.push(e.exports[n]=w[n])):o.push(void 0);return o}}):l.resolve()},e.exports={featureDetectedMethods:w,hasMethod:k,init:T,get:x,getValue:I,setValue:D,watchValue:X,unwatchValue:H,getInternalSettings:S,URL_PARAM:s,callExternal:d,callExternalWithResponse:p,provideFailureToJSCall:N,provideProgressToJSCall:R,provideResponseToJSCall:F,exposeMethod:b,appReady:a,log:E,logError:L,notifyAppEvent:A,resetTuuid:M,resource:O,showDialog:z,uploadBugAttachments:G,userUpdated:j}}),require.define("app/util/notifier",function(e){var t,n;n=require("blend/lang"),t=require("blend/events"),e.exports=n.mixin({},t.Emitter)}),require.define("app/lib/error",function(e){var t,n,i,r,o,s,a,l,u,c,d;n=require("devices"),c=require("blend/lang"),s=require("blend/i18n"),o=require("blend/http"),t={kFLHttpUnderMaintenanceStatusCode:418,kFLHttpServiceUnavailableStatusCode:503,kFLGenericErrorCode:1100,kFLDuplicateError:1101,kFLCancelErrorCode:1103,kFLAuthenticationErrorCode:1102,kFLTooManyMagazinesErrorCode:1106,kFLNoAssociatedAccountErrorCode:1105,kFLNoUsernameErrorcode:1107,kFLCantShareErrorCode:1108,kFLNeedToConfirmEmail:1109,kFLAccountWillLostAnonymouseData:2100},r={errorcode:t.kFLGenericErrorCode},u="under_construction_msg",l="SERVER_UNABLE_TO_SERVICE_YOUR_REQUEST",a="SORRY_WE_COULDNT_FIND_YOU_WERE_LOGING_FOR",d=function(e,t){var i,r;return r="",i=[],i.push({label:s.t("back_button"),id:"back",default_cancel:!0}),t&&i.push({label:t.label,id:t.id,default_confirm:!0}),n.showDialog(r,e,i).then(function(e){return e===(null!=t?t.id:void 0)||"ok"===e?t.callback():void 0})},i={showDialog:d,genericError:r},e.exports=c.mixin(i,t)}),require.define("app/lib/api",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I,k,C;c=require("blend/async"),d=require("blend/cookie"),w=require("blend/http"),r=require("app/util/notifier"),g=require("devices"),v=require("app/lib/error"),n="/api",a="/static/lib/http-worker.js",s="1"===(null!=(C=w.parseQuery(window.location.search))?C.worker:void 0),i=g.get("cookie_login"),o=["users/updateFeed","social/sectionSearch"],f=null,h=null,p=document.querySelector("input[id='_csrf']"),null!=p&&(h=p.value),_=function(){return h=null},S=function(){return w.get("/api/token").then(function(e){return h=e.token})},k=function(e){return f=e},b=function(){return h},y=function(e,t,n){return I("get",e,t,n)},x=function(e,t,n){return I("post",e,t,n)},m=function(e,t,n){return I("del",e,t,n)},I=function(e,t,n,o){var p,f,m,g,y,b,_,x;if(null==e&&(e="get"),null==n&&(n={}),null==o&&(o={}),x=c.defer(),g=x.promise,b=x.resolve,y=x.reject,m=x.notify,e=e.toLowerCase(),o.path=u(t),o.params=l(t,n,o),s&&(o.backgroundWorkerUrl=a),1===o.params.stream&&(o.streaming=!0),("post"===e||"del"===e)&&i){if(null==h)return S().then(function(){return I(e,t,n,o)});o.params._csrf=h}return _=d.get("regionalEdition"),_&&(p=JSON.parse(_),o.params.locale=p.locale,o.params.lang=p.language),f=w[e](o),f.progress(function(e){return m(e)}).then(function(e){return(null!=e?e.success:void 0)===!1?(e.errorcode===v.kFLNeedToConfirmEmail&&(e.suppressError=!0,r.emit("error:needsConfirmEmail",e)),y(e)):b(e)})["catch"](function(e){return e.status===v.kFLHttpUnderMaintenanceStatusCode&&(r.emit("error:teapot",e),e.suppressError=!0),y(e)}),g.abort=f.abort,g.getResponseHeader=f.getResponseHeader,g},u=function(e){return null==e&&(e=""),"/"!==e[0]&&(e="/"+e),e=n+e},l=function(e,t,n){var r,s,a,l,u,c,d;if(null==t&&(t={}),null==n&&(n={}),!i){for(d=["udid","tuuid","device","ver","model","flipster"],u=0,c=d.length;c>u;u++)s=d[u],r=g.getValue(s),null!=r&&(t[s]=r);f&&(t.userid=f.userid)}return null!=("undefined"!=typeof window&&null!==window?window.location:void 0)&&(a=w.parseQuery(window.location.search).lang,l=w.parseQuery(window.location.search).locale,null!=a&&null==t.lang&&(t.lang=a),null!=l&&null==t.locale&&(t.locale=l)),o.indexOf(e)>-1&&n.stream!==!1&&(t.stream=1),t},t.invalidateFormToken=_,t.refreshFormToken=S,t.setUser=k,t.getToken=b,t.get=y,t.post=x,t.del=m,t.params=l}),require.define("devices/windows",function(e,t){var n,i,r,o,s,a,l,u,c;r=require("blend/events"),o=require("blend/features"),a=require("blend/http"),n=require("app/lib/api"),i=require("devices"),c={},s=function(){return i.callExternalWithResponse("GetSecondaryTiles").then(function(e){var t,n,i,r;for(c={},r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(c[t]=!0);return r})},t.isPinnedToStart=function(e){return c[e]},t.pinToStart=function(e){var t;return null==e.roaming&&(e.roaming=!0),t=i.callExternalWithResponse("PinToStart",e),t.then(function(t){return t&&(c[e.id]=!0),s()}),t},t.sanitizeSecondaryTileId=function(e){return null==e?e:(/^[a-zA-Z0-9]/.test(e)||(e="A"+e),e.replace(/\+/g,".").replace(/\//g,"_").replace(/[^a-zA-Z0-9\\._]/g,"").substring(0,64))},t.unpinFromStart=function(e){var t;return t=i.callExternalWithResponse("UnpinFromStart",e),t.then(function(t){return t&&(c[e.id]=!1),s()}),t},t.clearLiveTile=function(){return i.callExternal("ClearLiveTile",{})},u=[],t.setLiveTileEndpoints=function(e){var t,n,r,o,s;for(n=!0,t=o=0,s=e.length;s>o;t=++o)r=e[t],r!==u[t]&&(n=!1);return n?void 0:(u=e,i.callExternal("SetLiveTileEndpoints",{urls:e}))},t.setLiveTileWithSection=function(e){var i,r,o,s;return i="users/updateFeed",r={limit:1,batchLimit:5,sections:e.remoteid,wantsMetadata:!1},o=function(){s=[];for(var e=0,t=r.batchLimit;t>=0?t>e:e>t;t>=0?e++:e--)s.push(e);return s}.apply(this).map(function(e){var t;return r.offset=e,t={path:"/livetile/"+i,params:n.params(i,r,{stream:!1})},a.parseUrl(a.defaultOptions(t,"GET")).href}),t.setLiveTileEndpoints(o)},i.featureDetectedMethods.ShowShareFlyout=function(){return i.callExternal("ShowShareFlyout",{})},l=function(){return i.get("has_pin_to_start")?(s(),r.on(document,o.pageVisibility.change,function(){return document[o.pageVisibility.hidden]?void 0:s()})):void 0},l()}),require.define("app/lib/section-cache",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m;r=require("blend/cache"),n={},l=/flipboard\/webNonce%2F(.*)/,m=function(e){return"flipboard/webNonce%2F"+e},d=function(e){return"flipboard/username%2F"+encodeURIComponent(e)},a=function(e){var t,i,r,o,s,a,l,p,h,f;if(null==e&&(e={}),r=u(e),o=c(e),null==r)return null;if(i=n[r],null==i&&null!=e.webNonce)for(s in n)if(a=n[s],s===m(e.webNonce)){i=a,null!=i&&i.update(e);break}if(null==i&&null!=e.remoteid)for(s in n)if(a=n[s],a.remoteid===e.remoteid||e.remoteid===m(a.webNonce)){i=a,l={};for(t in e)p=e[t],"remoteid"!==t&&(l[t]=p);null!=i&&i.update(l);break}if("profile"===e.feedType)for(s in n)if(a=n[s],"profile"===a.feedType){if(e.authorUsername&&s===d(e.authorUsername)){i=a,null!=i&&i.update(e);break}if(e.remoteid===d(a.authorUsername)){i=a,null!=i&&i.update(e);break}}if(null!=i)for(h=0,f=o.length;f>h;h++)t=o[h],n[t]=i;return i},f=function(e){var t;return null==e&&(e={}),t=u(e),null!=t?n[t]=e:void 0},s=function(e){return null==e&&(e={}),n[u(e)]=null},o=function(){return n={}},i=function(){return n},h=r.create("section"),p=function(e){var t,n;return null==e&&(e={}),n=a(e),null==n?(console.warn("Couldn't find section to save",e),void 0):(t=n.encode(),h.set(n.remoteid,t))},c=function(e){var t;return null==e&&(e={}),t=[e.remoteid],null!=e.webNonce&&t.push(m(e.webNonce)),"profile"===e.feedType&&t.push(d(e.authorUsername)),t},u=function(e){return null==e&&(e={}),c(e)[0]},t.get=a,t.set=f,t.del=s,t.save=p,t.clear=o,t.all=i,t.keys=c}),require.define("lib/urls",function(e,t){var n,i,r,o,s,a,l,u,c,d;s=["thenewsdesk","flipboardcn","flipboardau","flipboardbr","flipboardca","flipboardchina","flipboardde","flipboardes","flipboardfr","flipboardhk","flipboardit","flipboarditalia","flipboardja","flipboardjpn","flipboardko","flipboardkorea","flipboardhk","flipboardtw","flipboardnl","flipboarduk"],n="-",t.encodeNodeURIComponent=function(e){var t,n;n=null;try{n=encodeURIComponent(e).replace(/'/g,"%27")}catch(i){t=i,console.error("Error encoding URI: ",e)}return n},t.isWebNonce=function(e){return null==e&&(e=""),0===e.indexOf("__")||/^[ab][a-zA-Z0-9\+\/]{1,5}$/.test(e)},i=80,a=function(){return function(e){return e?e.toLowerCase().replace(/[!\*'\%\(\);:@&=\+\$,\.\/\?#\[\]\"\'\«\»]/g," ").trim().substr(0,i).replace(/\s+/g,n):e}}(this),t.getSectionDataFromSlug=function(e){var t,n,i;return null==e&&(e=""),i="",n=null,t=e.lastIndexOf("-"),t>-1?(i=e.substr(0,t),n=e.substr(t+1)):0===e.indexOf("__")?n=e:i=e,{title:a(i),sid:n}},t.sectionCanonicalUrl=function(e){var i,r,o,s,l;return i=null,e?(null==i&&(i=t.profileCanonicalUrl(e)),null==i&&(i=t.topicCanonicalUrl(e)),null==i&&(i=t.serviceCanonicalUrl(e)),null==i&&null!=e.ssid&&(s=e.displayName||e.title||e.sectionTitle||"",s=t.title(s),l=e.ssid.authorUsername,r=e.ssid.sid,o=s.substr(-1)===n?""+a(s)+r:""+a(s)+n+r,i=t.sectionCanonicalUrlFromSlug(o,l)),i):null},t.sectionCanonicalUrlFromSlug=function(e,n){var i;return null==e?null:i=null!=n?"/@"+t.encodeNodeURIComponent(n)+"/"+e:"/section/"+e},t.profileCanonicalUrl=function(e){var n,i,r;return i=null,null!=e&&("string"==typeof e?r=e:"flipboard"!==e.service||"profile"!==e.feedType&&"author"!==e.type&&!/^flipboard\/(user|username)%2F/.test(null!=(n=e.remoteid)?n:"")||(r=e.authorUsername||e.username),null!=r&&(i="/@"+t.encodeNodeURIComponent(r))),i},t.topicCanonicalUrl=function(e){var n,i,r;return"string"==typeof e?r=e:(n=null!=e?null!=(i=e.remoteid)?i.match("flipboard/topic%2F(.*)"):void 0:void 0,r=(null!=e?e.topicTag:void 0)||(null!=e?e.topic:void 0)||(null!=n?n[1]:void 0)),null==r?null:"/topic/"+t.encodeNodeURIComponent(r)},t.articleCanonicalUrl=function(e,n){var i,r,o,s;return null==n||"/"===n?n="/article/":"/"!==n.substr(-1)&&(n+="/"),i=t.title(null!=e?e.title:void 0),o=t.encodeNodeURIComponent(i),null===o?(console.error("Error encoding article title: ",i),null):(s=null!=e?e.sourceURLKey:void 0,r=t.encodeNodeURIComponent(s),null===r?(console.error("Error encoding article URL key: ",s),null):""+n+o+"/"+r)},t.serviceCanonicalUrl=function(e){var t;return"string"==typeof e?t=e:null!=e&&(e.remoteid==="auth/"+e.service||e.remoteid===e.service)&&(t=e.service),t?"/service/"+t:null},t.section=function(e,n,i){var r,o;return null==i&&(i=!0),n?(o=t.encodeNodeURIComponent(e.toLowerCase().replace(/\s+/g,"-")),o.length>0?(r=o+"-"+n,i&&(r="/section/"+r)):(r=""+n,i&&(r="/section/"+r)),r):"/section/404"},t.sectionFromData=function(e,n){var i,r,o,s,a,l,u,c,d;return null==n&&(n=!0),e?(i="auth/flipboard/coverstories"===e.remoteid?t.temporaryWebNonceForSection(e):null!=(r=e.webNonce)?r:t.temporaryWebNonceForSection(e),d=t.section(null!=(o=null!=(s=null!=(a=e.displayName)?a:null!=(l=e.section)?l.title:void 0)?s:null!=(u=e.sectionCover)?null!=(c=u.mainItem)?c.title:void 0:void 0)?o:"",i,n),{url:d,valid:Boolean(i)}):{url:"/section/404",valid:!1}},t.temporaryWebNonceForSection=function(e){var n,i,r;return r=null!=(n=null!=(i=e.section)?i.remoteid:void 0)?n:e.remoteid,r?t.encodeNodeURIComponent("__"+o(r)):null},t.sectionFromWebNonce=function(e){return null==e&&(e=""),0===e.indexOf("__")?r(decodeURIComponent(e.substring(2))):/^[ab][a-zA-Z0-9\+\/]*$/.test(e)&&e.length>1?"flipboard/webNonce%2F"+e:null},o=function(e){return e=unescape(encodeURIComponent(e)),"undefined"!=typeof Buffer?new Buffer(e).toString("base64"):"undefined"!=typeof("undefined"!=typeof window&&null!==window?window.btoa:void 0)?window.btoa(e):d(e)},r=function(e){var t;return"undefined"!=typeof Buffer?t=new Buffer(e,"base64").toString("ascii"):"undefined"!=typeof("undefined"!=typeof window&&null!==window?window.atob:void 0)&&(t=window.atob(e)),decodeURIComponent(escape(t))},t.refToSection=function(e){var n,i;return u(e)||l(e)?e:(i=e.split("-"),n=e,i.length>0&&(n=i[i.length-1]),t.sectionFromWebNonce(n))},u=function(e){var t;return t=e.indexOf("/"),-1===t?!1:e.indexOf("user")===t+1?!0:!1},l=function(e){return 0===e.indexOf("auth/")?!0:!1},t.user=function(e,n){return n&&-1!==s.indexOf(n.toLowerCase())?null:n&&n.length>0?"/profile/"+t.encodeNodeURIComponent(n.trim()):"/profile/u/"+(null!=e?e:0)},t.userFromData=function(e){var n,i;return e.authorUsername||e.userid?t.user(e.userid,e.authorUsername):(null!=(n=e.profile)?n.authorUsername:void 0)||(null!=(i=e.profile)?i.userid:void 0)?t.user(e.profile.userid,e.profile.authorUsername):null},t.userSectionFromItem=function(e){var t,n,i,r;if(e.sectionLinks)for(i=e.sectionLinks,t=0,n=i.length;n>t;t++)if(r=i[t],"author"===r.type)return"/section/"+encodeURIComponent(r.remoteid);return null},t.flipboardSection=function(e){return e.isProfile?"flipboard://showSection/"+escape(e.sectionID)+"?title="+encodeURIComponent(e.authorDisplayName):"flipboard://showSection/"+escape(e.remoteid)+"?title="+encodeURIComponent(e.title)},t.shareableUrl=function(e,t,n,i){var r,o,s;if(null==t&&(t="flipboard.com"),null==n&&(n=!0),null==i&&(i=!0),s=n?"https://":"http://",i&&(o=e.split("-"),o.length>0)){if(r=o[o.length-1],/^b/.test(r))return"http://flip.it/"+r.substring(1);if(/^a/.test(r))return"http://flpbd.it/"+r.substring(1)}return[s,t,e].join("")},c=function(e){return e.replace(/([\uE000-\uF8FF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDDFF])/g,"")},t.title=function(e,t){return null==t&&(t=80),e=e||n,e=c(e),e=e.replace(/[%]/,""),e=e.replace(/,/,""),e=e.toLowerCase().replace(/^\s+/,"").replace(/\s+$/,""),e.substr(0,t).replace(/\s+/g,n)},t.pathFromFlipboardProtocol=function(e){var t,n,i,r,o,s,a;if(a=null,i=null!=e?e.match(/^flipboard:\/\/([a-zA-Z]*)(\/[^\?]*)?(\?.*)?/):void 0,null!=i)switch(t=i[0],n=i[1],s=i[2],r=i[3],n){case"showSection":o=null!=s?s.replace(/^\//,""):void 0,o=decodeURIComponent(o),o.match(/^resolve\/flipboard\/url\%2F/)?(o=o.replace(/^resolve\/flipboard\/url\%2F/,""),a=decodeURIComponent(o)):(o=encodeURIComponent(o),a="/section/"+o);break;case"addSection":case"showContentGuide":case"showSignIn":case"showSignUp":case"showLightbox":case"audio":case"email":}return a},d=function(e){var t,n,i,r,o,s,a;for(s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i="",r="",n=t=0,o=e.length-1;o>=0?o>=t:t>=o;n=o>=0?++t:--t){for(a=e.charCodeAt(n).toString(2);a.length<8;)a="0"+a;for(i+=a;i.length>=6;)r+=s[parseInt(i.substring(0,6),2)],i=i.substring(6)}return 4===i.length&&(a=i+"00",r+=s[parseInt(a,2)],r+="="),2===i.length&&(a=i+"0000",r+=s[parseInt(a,2)],r+="=="),r},t.iosSmartBannerUrl=function(e){var t,n;return t=encodeURIComponent("/"+encodeURIComponent(e)),n="resolve/flipboard/url"+t,"flipboard://showSection/"+encodeURIComponent(n)}}),require.define("app/lib/helpers",function(e,t){var n,i,r,o,s,a;i=require("devices"),a=require("lib/urls"),r=require("blend/http"),o=require("blend/router"),n="",s=function(e){return n=e?e:i.get("base_url")},s(),t.url=function(e,t,i){var s,a,l;return null==t&&(t=!1),null==i&&(i={}),s=n,a=new RegExp("^"+s),t&&(s+=o.getLastPath(),"/"!==s[s.length-1]&&(s+="/"),"/"===e[0]&&(e=e.substr(1))),l=a.test(e)?e:""+s+e,"object"==typeof i&&Object.keys(i).length>0&&(l+=r.stringifyQuery(i)),l},t.startUrl=function(e,i,o){var s,a;return e=t.url(e,i,o),a=t.location,s=""+a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")+n+a.search,r.addOrReplaceQueryParam(s,"start_url",e)},t.relativeUrl=function(e){return null!=e?e.replace(new RegExp("^"+n),""):void 0},t.sectionUrl=function(e,n){var i,r;return r=null,i=a.sectionFromData(e),i.valid?r=t.url(i.url,!1,n):console.error("Invalid URL for section",e),r},t.itemUrl=function(e,n){var i,r,o,s;return"section"===e.type&&e.section?r=t.sectionUrl(e.section):(o=t.sectionUrl(n),s=encodeURIComponent(e.sourceURL),i=encodeURIComponent(e.id),""+o+"/item/"+i+"/"+s)},t.isChinaWeb=function(){var e;return e=r.parseUrl({url:window.location.href}),e.hostname.indexOf("flipboard.cn")>=0},t.location=window.location,t.setBaseUrl=s}),require.define("app/models/item",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var i in t)m.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},v=[].slice;p=require("lib/urls"),a=require("blend/date"),s=require("blend/async"),d=require("blend/tick"),o=require("app/lib/api"),c=require("app/lib/helpers"),i=require("app/lib/section-cache"),n=require("app/base/model"),l=require("devices"),r={image:"image",post:"post",album:"album",video:"video",audio:"audio",section:"section",group:"group",status:"status",sectionCover:"sectionCover"},t=function(e){function t(){return this.share=f(this.share,this),this.unlike=f(this.unlike,this),this.like=f(this.like,this),this.reply=f(this.reply,this),h=t.__super__.constructor.apply(this,arguments)}return g(t,e),t.autoProperties=!0,t.property("itemId",{get:function(){return this.id},persist:!1}),t.property("displayImage",{get:function(){var e,t,n,i,r,o,s,a;return null!=(e=null!=(t=null!=(n=null!=(i=null!=(r=this.image)?r:this.inlineImage)?i:this.posterImage)?n:this.albumArtImage)?t:null!=(o=this.section)?o.tileImage:void 0)?e:null!=(s=this.items)?null!=(a=s.filter(function(e){return null!=(null!=e?e.displayImage:void 0)})[0])?a.displayImage:void 0:void 0},persist:!1}),t.property("items",{collection:t,persist:"first 3"}),t.property("deleted",{persist:!1}),t.property("usageType",{get:function(){var e;return null!=this._usageType?this._usageType:"post"===this.type?(null!=(e=this.article)?e.url:void 0)?"post-magazine":this.rssText?"post-rss":"post-embeddedWebview":this.type},persist:!1}),t.property("loaded",{"default":!0,persist:!1}),t.property("flippedByItem",{persist:!1,get:function(){var e,t,n;return null!=this._flippedByItem?this._flippedByItem:"flipboard"!==this.service?this._flippedByItem=null:(t=null!=(n=this.referredByItems)?n.filter(function(e){return e.type===r.status}):void 0,e=null!=t?t[0]:void 0,this._flippedByItem=this.getAttrItem(e))}}),t.property("attributionItem",{persist:!1,get:function(){var e,t;if(null!=this._attributionItem)return this._attributionItem;if(e=this.referredByItems?this.referredByItems[0]:this,e.original)for(;e.original;)e=e.original;else e=null!=(t=e.originalFlip)?t:e;return this._attributionItem=this.getAttrItem(e)}}),t.property("attr",{persist:!1,get:function(){return this.attributionItem}}),t.property("html",{persist:!1,get:function(){return this._html||(this._html=l.get("support_in_app_navigation")?this.textToHtml():null),this._html}}),t.property("topics",{persist:!1,get:function(){var e;return this._topics||(this._topics=null!=(e=this.sectionLinks)?e.filter(function(e){return"topic"===e.type}):void 0,null==this._topics&&(this._topics=[])),this._topics}}),t.property("canReply",{"default":!0}),t.property("customizers",{persist:!1}),t.property("hasMultipleFlips",{persist:!1,get:function(){return this.referredByItems?this.referredByItems.length>1:!1}}),t.property("paginated",{persist:!1,get:function(){return null!=this.article}}),t.prototype.duplicateFlipItems=function(e){var t=this;return this.referredByItems?this.referredByItems.filter(function(n){return n.magazineTarget===e&&n.id!==t.id}):[]},t.prototype.moveItems=function(e){var t,n,i=this;return this.referredByItems?(n=this.referredByItems.filter(function(t){return t.magazineTarget===e}),n=n.filter(function(e){return e.id!==i.id}),t=[this].concat(v.call(n)),t.sort(function(e,t){return e.dateCreated<t.dateCreated?-1:e.dateCreated>t.dateCreated?1:0})):[this]},t.prototype.getAttrItem=function(e){var n,i,r;return e?(r=function(e,t){var n,i,r,o,s,a;return n=t[0],r=t[1],s=t[2],i=t[3],a=t[4],o=t[5],e.authorDisplayName=n,e.authorImage=r,e.authorURL=s,e.authorID=i,e.authorUsername=a},n={service:e.service,id:e.id,sourceURL:e.sourceURL,authorID:e.userid,authorUsername:e.authorUsername,authorImage:e.authorImage,dateCreated:e.dateCreated,authorDisplayName:e.authorDisplayName,authorURL:"flipboard"===e.service?p.userSectionFromItem(e):e.authorURL,showServiceIcon:!0,title:e.title,image:e.image,inlineImage:e.inlineImage,posterImage:e.posterImage,albumArtImage:e.albumArtImage},e.flipboardSocialId&&(n.flipboardSocialId=e.flipboardSocialId),"status"===e.type&&(n.text=e.text),e.sectionLinks&&(n.sectionLinks=e.sectionLinks),null!=e.originalFlip&&(n.originalFlip=e.originalFlip),e.sectionLinks&&(i=this.getAuthorFromSectionLinks(e.sectionLinks)),e.id!==this.id||this.referredByItems||"status"===e.type?null!=i&&l.get("support_in_app_navigation")&&r(n,i):(null!=i?r(n,i):(delete n.authorImage,delete n.authorDisplayName),n.showServiceIcon=!1,"googlereader"===n.service&&(n.service="flipboard")),this._attr=new t(n),this._attr):null
},t.prototype.textToHtml=function(){var e,t,n,i,r,o,s,a,l,u;if(null==this.text)return null;for(t=this.text,u=null!=(l=this.sectionLinks)?l:[],s=0,a=u.length;a>s;s++)r=u[s],r.referringText&&(o=c.sectionUrl(r),n=r.referringText,n="#"===n[0]||"@"===n[0]?"<s>"+n[0]+"</s><b>"+n.substr(1)+"</b>":"<b>"+n+"</b>",e='<a href="'+o+'" role="link">'+n+"</a>",i=new RegExp(r.referringText,"g"),t=t.replace(i,e));return t},t.fetch=function(e,n){return u(e,n).then(function(e){var n;return n=null,null!=e&&(n=new t(e)),n})},t.prototype.load=function(){var e=this;return u(this.id,this.sourceURL).then(function(t){return null!=t&&(t.loaded=!0,e.update(t)),e})},t.prototype.getAuthorFromSectionLinks=function(e){var t,n,r,o,s,a,l,u,d;if(e)return t=function(){var t,n,i;for(i=[],t=0,n=e.length;n>t;t++)l=e[t],"author"===l.type&&i.push(l);return i}()[0],t?(n=null!=(d=t.title)?d:"",o=t.image,r=t.userID,a=t.username,t.remoteid?(u=i.get({remoteid:t.remoteid}),null==u&&(u={remoteid:t.remoteid}),s=c.sectionUrl(u)):s=void 0,[n,o,s,r,a]):void 0},t.prototype.item=function(e){var t,n,i,r;for(r=this.items,n=0,i=r.length;i>n;n++)if(t=r[n],t.id===e)return t},t.batchLoadCommentary=function(e){var t,n,i,r,a,l,u=this;return l=s.defer(),n=l.promise,a=l.resolve,i=l.reject,null==this._commentaryRequestQueue&&(this._commentaryRequestQueue=[],r=function(){return this._commentaryRequestQueue.map(function(){}),i=args.reject,i()},t=function(){var t,n;return n=u._commentaryRequestQueue,t=n.map(function(t){return e=t.item,e.flipboardSocialId||e.id}),o.get("social/activity",{oid:t}).then(function(t){var i,o,s,l;if(t.success){for(i={},l=t.items,o=0,s=l.length;s>o;o++)e=l[o],i[e.id]=e;return n.map(function(t){return e=t.item,a=t.resolve,e.commentaryLoaded(i),a()}),n=null}return r()})["catch"](r)},d(t)),this._commentaryRequestQueue.push({item:e,resolve:a,reject:i}),n},t.prototype.commentaryLoaded=function(e){var n,i;return e[this.id]?(this.commentary=e[this.id],i=e[this.id].commentary,this.comments=function(){var e,r,o;for(o=[],e=0,r=i.length;r>e;e++)n=i[e],"comment"===n.type&&o.push(new t(n));return o}(),this.likes=function(){var e,r,o;for(o=[],e=0,r=i.length;r>e;e++)n=i[e],"like"===n.type&&o.push(new t(n));return o}(),this.shares=function(){var e,r,o;for(o=[],e=0,r=i.length;r>e;e++)n=i[e],"share"===n.type&&o.push(new t(n));return o}()):void 0},t.prototype.loadCommentary=function(e){var t,n,i,r,a,l,u,c,d=this;return null==e&&(e=!0),c=s.defer(),r=c.promise,l=c.resolve,a=c.reject,n={oid:this.flipboardSocialId||this.id,service:this.service},u=function(e){return d.commentaryLoaded(e),l()},t=function(e){return a(e)},i=e?"social/activity":"social/commentary",o.get(i,n).then(u)["catch"](t),r},t.prototype.reply=function(e,n){var i,r,s,a=this;return r={oid:this.flipboardSocialId||this.id,text:e,service:this.service},s=null!=n,s&&(i=new t({authorDisplayName:n.name,authorImage:n.profileImage,text:e,dateCreated:Date.now()}),null==this.comments&&(this.comments=[]),this.comments.push(i)),o.post("social/reply",r)["catch"](function(){return s?a.comments=a.comments.filter(function(e){return e!==i}):void 0})},t.prototype.like=function(e){var n,i,r,s=this;return i={oid:this.flipboardSocialId||this.id,service:this.service},r=null!=e,r&&(n=new t({authorDisplayName:e.authorDisplayName,authorImage:e.authorImage,userid:e.userid}),null==this.likes&&(this.likes=[]),this.likes.push(n)),o.post("social/like",i)["catch"](function(){return r?s.likes=s.likes.filter(function(e){return e!==n}):void 0})},t.prototype.unlike=function(e){var t,n,i,r,s=this;return n={oid:this.flipboardSocialId||this.id,service:this.service},i=null!=e,r=0,t=null,i&&null!=this.likes&&(this.likes=this.likes.filter(function(n,i){return parseInt(n.userid,10)===parseInt(e.userid,10)?(r=i,t=n,!1):!0})),o.post("social/unlike",n)["catch"](function(){return i&&null!=t?s.likes.splice(r,0,t):void 0})},t.prototype.share=function(){var e;return e={oid:this.flipboardSocialId||this.id,service:this.service},o.post("social/share",e)},t}(n),u=function(e){var t,n,i;return t=e.split("-".slice(1..join("-"))),i="a-"+t+"/0",n="flipboard/itemlink/"+encodeURIComponent(i),o.get("users/updateFeed",{sections:n},{stream:!1}).then(function(t){var n,i;return n=null,null!=(i=t.filter(function(t){return t.id===e}))?i[0]:void 0})},e.exports=t,e.exports.TYPES=r}),require.define("lib/feed",function(e,t){var n;t.getCoverItems=function(e,i,r){var o,s,a,l,u,c,d,p,h;if(null==r&&(r=!1),p=void 0,o=[],(null!=e?e.mainItem:void 0)&&(p=n(e.mainItem)),void 0===p&&(null!=i?i.length:void 0))for(s=0,c=i.length;c>s;s++)if(l=i[s],"sectionCover"!==l.type&&(!r||l.title)&&(a=t.getItemImage(l),void 0!==a)){p=n(l);break}for("post"===(null!=p?p.type:void 0)||r||null!=p&&(p.title=null),h=null!=e?e.section:void 0,!(null!=p?p.image:void 0)&&(null!=h?h.tileImage:void 0)&&(null!=p&&(p.image=t.largestAvailableImage(h.tileImage)),(null!=p?p.image:void 0)&&(p.imageAttribution=t.prettyDomain(p.image))),u=0,d=i.length;d>u;u++)l=i[u],o.length>=2||l.title&&"sectionCover"!==l.type&&l.id&&l.id!==(null!=p?p.id:void 0)&&o.push(n(l));return[p,o]},t.getSectionImage=function(e){var n,i,r,o;if(!e)return null;for(n=0,o=e.length;o>n;n++)if(r=e[n],"sectionCover"!==r.type&&(i=t.getItemImage(r),(null!=i?i.largeURL:void 0)||(null!=i?i.mediumURL:void 0)||(i=void 0),void 0!==i))return i},t.getItemImage=function(e){var t;return t=function(){var t,n;switch(e.type){case"image":return e.image;case"post":return e.inlineImage;case"video":return e.posterImage;case"audio":return e.albumArtImage;case"section":return null!=(t=e.section)?t.tileImage:void 0;case"album":return null!=(n=e[0])?n.image:void 0;default:return void 0}}()},t.largestAvailableImage=function(e){var t;return null==e&&(e={}),t=void 0,t=e.largeURL,null==t&&(t=e.mediumURL),null==t&&(t=e.smallURL),t},t.siteAttributionText=function(e){var n;return n="section"===e.type&&e.authorDisplayName?e.authorDisplayName:e.hostDisplayName,!n&&e.sourceURL&&(n=t.prettyDomain(e.sourceURL)),n},t.getPhotoAttribution=function(e){var n,i;return i=t.getItemImage(e),i&&(n=i.attribution||t.siteAttributionText(e)),n},t.isValidFeed=function(e){var t,n,i,r;for(t=!0,n=0,r=e.length;r>n;n++)if(i=e[n],"metadata"===i.type&&i.EOS&&!i.success&&null!=i.errormessage){if(i.errormessage.indexOf("quick load")<0)throw new Error(i.errormessage);t=!1}return{cacheable:t,items:e}},t.prettyDomain=function(e){var t,n,i,r;return t=e,i=new RegExp("://(.[^/]+)"),n=null!=(r=e.match(i))?r:[],n.length>1&&(t=n[1]),t.replace("www.","")},n=function(e){var n,i,r,o;return n=t.getItemImage(e),o={},o.id=e.id,o.type=e.type,o.title=e.title,o.sourceURL=e.sourceURL,o.image=t.largestAvailableImage(n),o.attribution=t.siteAttributionText(e),o.authorDisplayName=null!=(i=e.authorDisplayName)?i:null!=(r=e.referredByItems)?r[0].authorDisplayName:void 0,o.image&&(o.imageAttribution=t.getPhotoAttribution(e)),o},t.isSupportedSection=function(e){var t,n,i;return i=null!=(t=null!=(n=e.section)?n.remoteid:void 0)?t:e.remoteid,i&&(/(?:auth\/)?flipboard\//.test(i)||0===i.indexOf("sid"))}}),require.define("app/models/dynConfig",function(e){var t,n,i,r,o,s,a,l,u=function(e,t){return function(){return e.apply(t,arguments)}};r=require("blend/async"),o=require("blend/cache"),l=require("blend/lang"),n=require("blend/watch"),a=require("devices"),i=require("app/lib/api"),s=null,t=function(){function e(){this.findService=u(this.findService,this)}return l.mixin(e,n),e.property("services"),e.property("config"),e.prototype.loadServiceIfNeeded=function(){var e=this;if(null==this.services)return null!=this.pendingServiceFetch?this.pendingServiceFetch:this.pendingServiceFetch=a.resource("services.json").then(function(t){return e.services=t,e.pendingServiceFetch=null})["catch"](function(t){return e.pendingServiceFetch=null})},e.prototype.load=function(){return this.loadServiceIfNeeded()},e.prototype.findService=function(e){var t,n;return null!=(n=function(){var n,i,r,o,s,a;for(s=null!=(r=null!=(o=this.services)?o.services:void 0)?r:[],a=[],n=0,i=s.length;i>n;n++)t=s[n],t.id===e&&a.push(t);return a}.call(this))?n[0]:void 0},e}(),e.exports=new t}),require.define("app/models/section",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_={}.hasOwnProperty,x=function(e,t){function n(){this.constructor=e}for(var i in t)_.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v=require("blend/i18n"),p=require("blend/async"),h=require("blend/cache"),d=require("app/lib/api"),t=require("app/lib/section-cache"),o=require("app/base/model"),r=require("app/models/item"),s=require("app/util/notifier"),w=require("lib/urls"),g=require("lib/feed"),f=require("devices"),m=require("app/models/dynConfig"),y=0,c=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.items=[]}return x(n,e),n.autoProperties=!0,n.property("displayName",{get:function(){var e,t,n;return(null!=(n=this._displayName)?n.length:void 0)>0||("flipsearch"===this.service&&0===this.remoteid.indexOf("flipsearch/article%2F")?(e=this.remoteid.replace("flipsearch/article%2F",""),e=e.replace(/\+/g," "),this._displayName="’"+e+"’"):this.remoteid===i.coverStories||this.remoteid===l.coverStories?this._displayName=v.t("cover_stories_section_name"):(t=this.remoteid===this.service&&m.findService(this.remoteid),this._displayName=t?v.t(t.displayNameKey):this.sectionTitle||this.title||"")),this._displayName},persist:!1}),n.property("resolvedAuthorUsername",{get:function(){var e;return this.authorDisplayName||(null!=(e=this.author)?e.authorDisplayName:void 0)||this.authorUsername},persist:!1}),n.property("sectionImage",{get:function(){var e,t,n;return e=null!=(t=null!=(n=this.brick)?n.imageURL:void 0)?t:this.imageURL,(null!=e?e.length:void 0)>0?{smallURL:e}:this.image},persist:!1}),n.property("latestItemImage",{persist:!1}),n.property("webNonceOrTemp",{get:function(){var e;return null!=(e=this.webNonce)?e:w.temporaryWebNonceForSection(this)},persist:!1}),n.property("items",{collection:r,persist:"first 20"}),n.property("scrollPageNumber",{"default":0,persist:!1}),n.property("sidebarGroups",{collection:Object,persist:"first 3"}),n.property("loading",{"default":!1,persist:!1}),n.property("failedToLoad",{"default":!1,persist:!1}),n.property("lastUpdateTime",{persist:!1}),n.property("subscribed",{"default":!1,persist:!1}),n.property("shouldPersist",{"default":f.get("enable_feed_cache"),persist:!1}),n.property("needsReload",{"default":!1,persist:!1}),n.property("coverItems",{get:function(){var e,t;return null==this._coverItems&&(t=g.getCoverItems(void 0,this.items,!0),e=t[0],this._coverItems=t[1],null!=e&&this._coverItems.unshift(e)),this._coverItems},persist:!1}),n.property("pageKey",{get:function(){var e,t,n,i;if(n=null,!this.needsReload&&this.items.length>0){for(t=this.items.length-1,e=this.items[t];"folder"===e.type||void 0===e.type;)t--,e=this.items[t];n=null!=(i=e.nextPageKey)?i:e.id}return n},persist:!1}),n.property("metadata",{get:function(){var e,t,n,i,r,o;for(t={},o=null!=(r=this.metadataKeys)?r:[],n=0,i=o.length;i>n;n++)e=o[n],t[e]=this[e];return t.sectionTitle=t.title=this.displayName,null==t.remoteid&&(t.remoteid=this.remoteid),null==t.service&&(t.service=this.service),t},persist:!1}),n.property("shareableUrl",{get:function(){var e;return null==this.webNonce&&null!=this._shareableUrlShortened?this._shareableUrlShortened:(e=w.sectionFromData(this).url,w.shareableUrl(e))},persist:!1}),n.property("magazineCanBeDeleted",{get:function(){return null!=this._magazineCanBeDeleted?this._magazineCanBeDeleted:null!=this._magazineTarget?!this._magazineIsProfile:!1}}),n.cache=h.create("section"),n.find=function(e){var i,r,o;return null==e&&(e={}),"string"==typeof e&&(e={remoteid:e},a[e.remoteid]&&(e.ssid={remoteidEnc:a[e.remoteid]})),o=t.get(e),null==o&&(o=new n,o.update(e),t.set(o),o.remoteid&&(r=n.cache.get(o.remoteid),null!=r&&(i=o.decode(r),o.update(i)))),o},n.multiFetch=function(e,t,i){var r,o,s,a,l,u,c,h,f,m,g,v,y,w=this;for(null==e&&(e=[]),null==t&&(t={}),m=[],o=null,g=0,v=e.length;v>g;g++)f=e[g],f.loading?(console.warn("Tried to reload a feed in progress: "+f.remoteid),null==o&&(y=p.defer(),a=y.promise,h=y.resolve,l=y.reject,o=a),null==n.pendingPromises&&(n.pendingPromises={}),n.pendingPromises[f.remoteid]=[h,l]):(u=!f.canLoadMore()||null==f.lastUpdateTime||f.needsReload,f.loading=!0,f.shouldReplaceItems=u,f.needsReload=!1,m.push(f.remoteid));return s=t,null==s.limit&&(s.limit=30),s.sections=m.join(","),null==s.pageKey&&(s.wantsMetadata=!0),0===m.length?null!=o?o:p.resolve():(r=function(t,i){var r,o,s,a,l,u;for(o=0,a=e.length;a>o;o++)f=e[o],(null!=(u=n.pendingPromises)?u[f.remoteid]:void 0)&&(r=t?1:0,n.pendingPromises[f.remoteid][r](),delete n.pendingPromises[f.remoteid]);if(t)for(s=0,l=e.length;l>s;s++)f=e[s],f.loadFinished(t);return f.loading&&f.loadFinished(),w.pendingFetches?w.pendingFetches=w.pendingFetches.filter(function(e){return e!==i}):void 0},c=d.get("users/updateFeed",s),c.progress(function(e){return b(e,i,c)}).then(function(){return r(null,c)})["catch"](function(e){return r(e,c)}),null==this.pendingFetches&&(this.pendingFetches=[]),this.pendingFetches.push(c),c)},n.cancelPendingFetches=function(){var e,t,n,i,r;for(r=null!=(i=this.pendingFetches)?i:[],t=0,n=r.length;n>t;t++)e=r[t],e.abort();return this.pendingFetches=null},n.prototype.save=function(){return this.shouldPersist&&!y?n.cache.set(this.remoteid,this.encode()):void 0},n.prototype.del=function(){return n.cache.del(this.remoteid)},n.prototype.update=function(e){return null==e&&(e={}),n.__super__.update.apply(this,arguments),"object"==typeof e&&(this.metadataKeys=Object.keys(e),delete this.metadataKeys.items),this},n.prototype.item=function(e){var t,n,i,r,o,s,a,l;for(a=this.items,i=0,o=a.length;o>i;i++){if(t=a[i],t.id===e)return t;if(null!=t.items)for(l=t.items,r=0,s=l.length;s>r;r++)if(n=l[r],n.id===e)return n}},n.prototype.itemBySourceURLKey=function(e){var t,n,i,o,s,a,l,u,c;for(l=this.items,i=0,s=l.length;s>i;i++){if(t=l[i],(null!=t?t.sourceURLKey:void 0)===e)return t;if(null!=t.items)for(u=t.items,o=0,a=u.length;a>o;o++){if(n=u[o],"activity"===n.type&&(null!=(c=n.refersTo)?c.sourceURLKey:void 0)===e)return new r(n.refersTo);if(n.sourceURLKey===e)return n}}},n.prototype.group=function(e){var t,n;return null!=(n=function(){var n,i,r,o;for(r=this.items,o=[],n=0,i=r.length;i>n;n++)t=r[n],t.groupId===e&&o.push(t);return o}.call(this))?n[0]:void 0},n.prototype.profileItem=function(){var e,t;return null!=(t=function(){var t,n,i,r;for(i=this.items,r=[],t=0,n=i.length;n>t;t++)e=i[t],"profile"===e.type&&r.push(e);return r}.call(this))?t[0]:void 0},n.prototype.removeItem=function(e){var t;return t=this.item(e),null!=t?t.deleted=!0:void 0},n.prototype.removeGroupItem=function(e){return this.items=this.items.filter(function(t){return t.groupId!==e})},n.prototype.loadItems=function(e,t){var i;return null==e&&(e={}),this.canLoadMore()&&(i=this.pageKey),i&&(e.pageKey=i),n.multiFetch([this],e,t)},n.prototype.loadFinished=function(e){return this.lastUpdateTime=Date.now(),e&&(this.failedToLoad=!0),this.loading=!1,e||(this.needsReload=!1),this.scrollPageNumber+=1,this.subscribed&&null==e?this.save():void 0},n.prototype.canLoadMore=function(){return null==this.lastUpdateTime?!0:this.lastUpdateTime>0&&!this.neverLoadMore},n.prototype.isEmpty=function(){return this.sectionEOS&&!this.needsReload&&0===this.items.length},n.prototype.provenanceString=function(e,t){var n,i,r,o,s,a,l,u,c;for(null==e&&(e=this.items),null==t&&(t=4),r="",i=[],a=0,u=e.length;u>a;a++)s=e[a],n=s.attr.authorDisplayName,(null!=n?n.length:void 0)>0&&i.push(n);if(1===i.length)r=v.t("from")+(" "+i[0]);else if(i.lengh<=t)for(r=v.t("from")+(" "+i[0]),o=l=0,c=i.length;c>l;o=++l)n=i[o],0!==o&&(r+=o<i.length-1?", "+n:"& "+n);else i.length>t&&(i=i.slice(0,+t+1||9e9),r=v.t("from")+(" "+i.join(", ")),r+=" & "+v.t("more"));return r},n.prototype.getShareableUrlWithShortening=function(){var e,t,n,i,r,o,s,a,l,u,c=this;return r=p.defer(),t=r.promise,i=r.resolve,n=r.reject,null!=this.webNonce||null!=this._shareableUrlShortened?i(this.shareableUrl):(e={sectionid:this.remoteid,title:this.displayName,imageURL:null!=(o=null!=(s=null!=(a=this.sectionImage)?a.mediumURL:void 0)?s:null!=(l=this.sectionImage)?l.smallURL:void 0)?o:null!=(u=this.sectionImage)?u.thumbnailURL:void 0,defaultUser:!0},d.post("social/shortenSection",e).then(function(e){return e.success&&null!=e.result?(c._shareableUrlShortened=e.result,i(c.shareableUrl)):n()})["catch"](function(){return n()})),t},n}(o),i={coverStories:"auth/flipboard/coverstories",notifications:"auth/flipboard/curator%2Fnotifications",picks:"flipboard/curator%2Fmagazine%2FQoPvHvDeSou2BBflTeJjtg%3Am%3A3153968",dailyEdition:"flipboard/curator%2Fmagazine%2FGprEmCNkTBKyT3ITUDHzxA%3Am%3A142274591",travelCommunity:"auth/flipboard/community/1874065657"},l={coverStories:"sid/9c5m2uqk25jki1at",notifications:"sid/26l71bvl6mq7j1r3"},a={},a[l.coverStories]="PKLHstDB2bwOkvS3XV6pGV9BdOD8CSNgIv3URVYTaI0",c.coverStoriesSection=function(){return c.find(i.coverStories)},c.notificationsSection=function(){return c.find(i.coverStories)},c.profileSection=function(e){return c.find("flipboard/user%2F"+e.userid)},u=["title","description","magazineCategory","magazineVisibility"],b=function(e,t,n){var i,o,a,l,d,p,h,f,m,g,y,b,w,_,x,S,I,k,C,T,q,P,E,L,A,N,R,F,M,O,B,U,D;if(null==e&&(e={}),0!==Object.keys(e).length)switch(S=e.sectionID,"metadata"===e.type&&null!=e.section&&(e.section.remoteid=e.sectionID,e.section.webNonce=e.webNonce,S=e.section),_=c.find(S),_.shouldReplaceItems&&(_.shouldReplaceItems=!1,_.items=[]),e.scrollPageNumber=_.scrollPageNumber,T=null!=t?t.userid:void 0,e.type){case"metadata":if(e.section){if(x=e.section,x.webNonce=e.webNonce,null!=e.invite&&(x.invite=e.invite),g={},Number(x.userid)===T)for(q=0,E=u.length;E>q;q++)m=u[q],g[m]=_[m];_.update(x),_.update(g),x.remoteid!==e.sectionID&&(_=c.find(e.sectionID),delete x.remoteid,_.update(x)),a=null!=(A=_.items)?A.filter(function(e){return"profile"===e.type}):void 0,a&&0!==a.length||"profile"!==x.feedType||(_.title=null!=(N=_.authorDisplayName)?N:_.authorUsername,b=new r(x),b.image=x.authorImage,b.type="profile",b.metrics=x.metrics,b.emptyMessage=Number(x.userid)===T?v.cleanStr(v.t("profile_view_current_user_has_no_magazines_message")):v.t("profile_view_user_has_no_magazines_message_format",x.authorDisplayName),delete b.groups,c.find(x).items.push(b))}if(e.EOS){if("resetUser"===e.action)return l={reason:"updateFeed forced resetUser",response:n},s.emit("user:needsReset",l);if(_.neverLoadMore=e.neverLoadMore||e.errormessage,_.noItemsText=e.noItemsText,_.noItemStatus=e.noItemStatus,_.sectionEOS=!0,!_.shouldWaitForSidebar||_.shouldWaitForSidebar&&_.sidebarEOS)return _.loadFinished()}break;case"sidebar":if("sidebar"===e.sidebarType){for(_.metrics=null!=(R=e.groups)?null!=(F=R[0])?F.metrics:void 0:void 0,k={},_.sidebarGroups=e.groups.filter(function(e){return e.groupId.match(/RecommendedMagmakers/)&&FEATURE_FLAGS?!0:null==e.title||k[e.title]?!1:(k[e.title]=!0,!0)}),M=_.sidebarGroups,D=[],P=0,L=M.length;L>P;P++)I=M[P],D.push(function(){var n,i,s,a,l,u,c,d,p;for(a=I.renderHints,p=[],n=0,i=a.length;i>n;n++)w=a[n],"profile"===w.style?(h=Number(_.userid)===T,b=_.profileItem(),b||(b=new r(b),_.items.push(b)),h?(b.authorDisplayName=null!=(l=t.name)?l:e.authorDisplayName,b.image=null!=(u=t.profileImage)?u:e.authorImage):b.image=e.authorImage,b.type="profile",b.metrics=I.metrics,delete b.groups,y=new r(I),h&&t?(t&&(C=null!=(c=t.magazines)?c:[],o=null!=(d=t.contributorMagazines)?d.map(function(e){return e.magazineVisibility="contributor",e}):void 0,y.items=C.concat(o)),_.profileHasMagazines=(null!=(s=y.items)?s.length:void 0)>0):y.checkForProfileItems=!0,p.push(_.items.push(y))):p.push(void 0);return p}());return D}if("group"===e.sidebarType)return i=[],e.items&&(i=e.items.map(function(e){var t,n,i,r,o;return"googlereader"===e.service&&"folder"===e.type&&"Folder Feed"===(null!=(n=e.items)?null!=(i=n[0])?i.title:void 0:void 0)&&"feed"===(null!=(r=e.items[0].items)?null!=(o=r[0])?o.type:void 0:void 0)&&(t=e,e=e.items[0].items[0],e.image=t.image),e}),i=i.filter(function(e){return"folder"!==e.type})),p=_.group(e.groupId),!p||p.items&&0!==p.items.length||(p.items=i),p&&p.checkForProfileItems&&(null!=(O=p.items)?O.length:void 0)>0&&(_.profileHasMagazines=!0),I=null!=(B=function(){var t,n,i,r;for(i=_.sidebarGroups,r=[],t=0,n=i.length;n>t;t++)d=i[t],d.groupId===e.groupId&&r.push(d);return r}())?B[0]:void 0,null!=I?I.items=(null!=p?null!=(U=p.items)?U.length:void 0:void 0)>0?p.items:i:void 0;if("EOS"!==e.sidebarType)return console.warn("Unhandled sidebarType",e.sidebarType);if(_.sidebarEOS=!0,_.sectionEOS)return _.loadFinished();break;default:if(f=new r(e),!_.item(f.id))return _.items.push(f)}},s.on("user:needsReset",function(){return c.cancelPendingFetches()}),n={teapot:"error:teapot"},e.exports=c,e.exports.processItem=b,e.exports.IDENTIFIERS=i,e.exports.SSID=l,e.exports.ERRORS=n,e.exports.STALE_METADATA_KEYS=u}),require.define("ui/lightBox",function(e){var t,n,i,r,o,s=function(e,t){return function(){return e.apply(t,arguments)}};n=require("blend/dom"),i=require("blend/events"),o=require("blend/lang"),r=require("blend/features"),t=function(){function e(e,t){var i,r,a,l;if(this.contentNode=e,null==t&&(t={}),this.close=s(this.close,this),"string"==typeof e&&(e=n.one(e)),!e)return console.warn("node doesn't exist."),void 0;for(a=this.contentNode;(a=a.previousSibling)&&1!==a.nodeType;);this.contentNodeStates={parentNode:this.contentNode.parentNode,previousSibling:a,cssText:this.contentNode.style.cssText,loadingAnimation:!1},i={overlayAlpha:.7,isIFrame:!1,autoCenter:!0,tapable:!0,overlayAnimation:!0,hostNode:document.body},o.merge(t,i);for(r in t)l=t[r],this[r]=l;"iframe"===this.contentNode.tagName.toLowerCase()&&(this.isIFrame=!0),this.handles=[],this.cssRules=[],this.init()}return e.prototype.showLoading=function(){},e.prototype.show=function(){return this.positionContentNode()},e.prototype.init=function(){return this.autoCenter&&(this.contentNode.style.display="none"),this.createOverlay(),this.positionContentNode(),this.isIFrame&&this.setupCrossFrameMessaging(),this.autoCenter&&this.handles.push(i.on(window,r.touch?"orientationchange":"resize",o.throttled(this.positionContentNode.bind(this),100))),this.emit("lightbox:opened")},e.prototype.positionContentNode=function(){var e,t,n,i;if(this.autoCenter)return this.contentNode.style.display="block",this.contentNode.style.visibility="hidden",i=this.contentNode.getBoundingClientRect(),n=i.width,e=i.height,this.contentNode.style.display="none",this.contentNode.style.removeProperty("visibility"),t=this.lightbox.getBoundingClientRect(),this.contentNode.style.position="absolute",this.contentNode.style.top=Math.max(t.height/2-e/2,0)+"px",this.contentNode.style.left=Math.max(t.width/2-n/2,0)+"px",this.contentNode.style.display="block"},e.prototype.createOverlay=function(){var e=this;return this.lightbox=n.create('<div class="lightbox-wrapper fixed" style="position: fixed"></div>'),this.overlay=n.create('<div class="lightbox-overlay"></div>'),this.lightbox.appendChild(this.overlay),this.lightbox.appendChild(this.contentNode),this.hostNode.appendChild(this.lightbox),this.overlay.style.cssText="opacity: "+(this.overlayAnimation?0:1)+";background-color:rgba(0, 0, 0, "+this.overlayAlpha+");",this.overlayAnimation&&setTimeout(function(){return e.overlay.style.opacity=1},0),this.tapable?this.handles.push(i.on(this.overlay,"click",function(){return e.close()})):void 0},e.prototype.freeze=function(){return this.detach()},e.prototype.setupCrossFrameMessaging=function(){var e;return e=function(e){var t;switch(t=e.data.split("-"),t[0]){case"close":return this.close()}},this.handles.push(i.on(window,"message",e.bind(this)))},e.prototype.detach=function(){var e,t,n,i,r;for(i=this.handles,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(e.detach());return r},e.prototype.close=function(e){var t,i,r,o;for(null==e&&(e=!0),o=this.cssRules,i=0,r=o.length;r>i;i++)t=o[i],t.destroy();return this.detach(),this.contentNodeStates.previousSibling?this.contentNodeStates.previousSibling.parentNode.insertBefore(this.contentNode,this.contentNodeStates.previousSibling.nextSibling):this.contentNodeStates.parentNode&&this.contentNodeStates.parentNode.appendChild(this.contentNode),this.contentNode.style.cssText=this.contentNodeStates.cssText,this.contentNode.style.display=this.contentNodeStates.display,n.remove(this.lightbox),this.lightbox=null,this.emit("lightbox:closed",{trackClose:e})},e}(),o.mixin(t,i.Emitter),e.exports=t}),require.define("duplo/abuseReporter",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_,x,S,I;c=require("blend/dom"),d=require("blend/events"),g=require("blend/http"),v=require("blend/i18n"),i=require("blend/async"),o=require("blend/cache"),n=require("ui/lightBox"),s=null,m=[],S=null,b=null,_=null,h="inappropriate",p={},r=null,f=function(){var e,t;r||(r=o.create({key:"fl-flag-items"}));try{e=r.get(h)}catch(n){t=n,console.log(t)}return e||(e={}),e},I=function(e){var t;return t=f(),t[e.itemId]=e,r.set(h,t)},x=function(){return S=c.create('<div class="abuse-report-confirm">\n    <span class="abuse-report-header">'+v.t("flag_inappropriate_confirm_title")+"</span>\n    <p>"+v.t("flag_inappropriate_confirm_message")+'</p>\n    <div class="button-wrap">\n        <button id="abuse-report-cancel" class="fl-button">'+v.t("cancel_button")+'</button>\n        <button id="abuse-report-save" class="fl-button">'+v.t("flag_inappropriate_confirm_button")+"</button>\n    </div>\n</div>"),b=new n(S),b.on("lightbox:closed",u),m=[d.on(c.one("#abuse-report-cancel",S),"click",b.close),d.on(c.one("#abuse-report-save",S),"click",w)]},u=function(){var e,t,n,i;for(i=[],t=0,n=m.length;n>t;t++)e=m[t],i.push(e.detach);return i},w=function(){var e,t,n,i,r;return t=c.ancestor(_,function(e){return e.classList.contains("status-entry")?!0:e.classList.contains("item")?!0:!1}),t&&p.itemId&&p.section?(r=function(e){if(console.log(e),e.success===!0)return t.style.backgroundColor="#eee",t.style.backgroundImage=null,c.setInnerHTML(t,'<p style="margin: 0 0;padding: 0 0;color:#ccc;height:100%;line-height:'+t.offsetHeight+'px;text-align:center">'+v.t("hidden_item_text_marked_inappropriate")+"</p>"),I(p),b.close();throw Error("flag item error.")},e=function(e){return console.log(e),b.close(),alert("Failed to report. Plese try again later.")},i=g.parseQuery(window.location.search),n={path:"/api/social/flagItem",params:{id:p.itemId,oid:p.itemId,url:p.url,section:p.section,type:h}},g.post(n).then(r,e)):void 0},a=function(e){var t;return t=e.matchedTarget,_=t,e.stopPropagation(),e.preventDefault(),p.itemId=t.getAttribute("data-fl-item-id"),p.section=t.getAttribute("data-fl-section"),p.url=t.getAttribute("data-fl-item-url"),x()},y=function(){var e;if(!s)return e=document.documentElement,s=d.delegate(e,".report-abuse-button","click",a)},l=function(){return null!=s?s.detach():void 0},t.init=y,t.getFlagItems=f,t.setFlagItem=I,t.destroy=l}),require.define("app/models/user",function(e){var t,n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b,w,_={}.hasOwnProperty,x=function(e,t){function n(){this.constructor=e}for(var i in t)_.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};y=require("blend/lang"),f=require("blend/events"),m=require("blend/http"),g=require("blend/i18n"),c=require("blend/cookie"),l=require("blend/async"),u=require("blend/cache"),b=require("blend/tick"),h=require("devices"),w=require("devices/windows"),a=require("app/lib/api"),r=require("app/models/section"),n=require("app/util/notifier"),s=require("duplo/abuseReporter"),t=require("app/base/model"),p=null,d=function(){return null!=p?p:p=new o},v=30,i=["twitter","facebook","renren","linkedin","googleplus","tumblr","weibo","tcweibo","qzone"],o=function(e){function t(){var e;t.__super__.constructor.apply(this,arguments),this.signintime=c.get("ts"),this.cache=u.create("user"),this.cache.del("userInfo"),h.get("cookie_login")&&(this.userid=Number(null!=(e=c.get("userid"))?e:0),this.cache.set("userid",this.userid))}return x(t,e),t.property("userid",{"default":0}),t.property("screenname"),t.property("revision"),t.property("name"),t.property("email"),t.property("profileImage"),t.property("description"),t.property("magazines",{collection:r}),t.property("tocSections",{collection:r}),t.property("contributorMagazines",{collection:r}),t.property("services",{collection:Object}),t.property("isAnonymous"),t.property("loaded",{"default":!1,persist:!1}),t.property("mutedAuthors",{collection:Object}),t.property("mutedAuthorsForSectionIdentifiers",{"default":{}}),t.property("notifications",{collection:Object,persist:!1}),t.property("notificationUnreadCount",{persist:!1}),t.property("following",{collection:Object,persist:!1}),t.property("followers",{collection:Object,persist:!1}),t.replaceCurrent=function(e){var n,i,r,o;return o=[null,{}],r=o[0],n=o[1],null!=p&&(r=p.userState,i=Object.keys(p.constructor.allProperties()),n={},i.forEach(function(e){return n[e]=p[e]})),p=new t,p.update(n),p.updateUserState(r),p.revision=e.revision,p},t.prototype.update=function(){return t.__super__.update.apply(this,arguments),a.setUser(this)},t.prototype.encodeProperty=function(e){return"tocSections"===e?this.encodeTocSections():t.__super__.encodeProperty.apply(this,arguments)},t.prototype.decodeProperty=function(e,n){return"tocSections"===e?this.updateTocSections(n,!1):t.__super__.decodeProperty.apply(this,arguments)},t.prototype.isSignedIn=function(){return h.get("cookie_login")?0!==this.userid&&Number(this.userid)===Number(c.get("userid")):0!==this.userid},t.prototype.sessionChanged=function(){var e,t,n;return d=null!=(t=this.userid)?t:0,e=null!=(n=this.cache.get("userid"))?n:0,d!==e},t.prototype.restoreAvailable=function(){var e;return e=this.cache.get("state"),null!=e},t.prototype.restore=function(){var e;return e=this.cache.get("state"),e&&this.update(this.decode(e)),this.isSignedIn()?(this.reload(),l.resolve()):this.load()},t.prototype.save=function(){return this.cache.set("userid",this.userid),this.cache.set("state",this.encode())},t.prototype.reset=function(e){return this.cache.del("state"),this.cache.set("userid",0),this.userid=0,this.loaded=!1,h.get("has_live_tile")&&w.clearLiveTile(),p=null,p=new t,null!=e&&(p.updateFromUserInfo(e),n.emit("user:reset",{user:p})),p},t.prototype.load=function(){return this.loadUserInfo()},t.prototype.reload=function(){return this.loadUserInfo(!0)},t.prototype.loadUserInfo=function(e){var t,n,i,o,s,u,c=this;return null==e&&(e=!1),u=l.defer(),s=u.resolve,o=u.reject,i=u.promise,this.isSignedIn()&&!this.loaded||e?(t=function(e){return o()},n={},n.states="user",a.get("flipboard/userInfo",n,{user:this}).then(function(e){var n;return e.success?(n=null!=e?e.userInfo:void 0,n?(c.updateFromUserInfo(n),h.get("has_live_tile")&&w.setLiveTileWithSection(r.find(r.IDENTIFIERS.coverStories)),s()):t(new Error("server didn't return user info"))):(console.warn("User info request failed",e),c.userid=0,s(),void 0)},t)):(this.loaded=!0,s()),i},t.prototype.isSubscribed=function(e){var t,n,i,r;for(r=this.tocSections,n=0,i=r.length;i>n;n++)if(t=r[n],e.remoteid===t.remoteid)return!0;return!1},t.prototype.subscribe=function(e){var t,n,i=this;return null==e||null==e.remoteid?l.reject():(n=function(t,n){var o,s,a,l,u;return null==t&&(t=!0),null==n&&(n=!0),o=!1,e.subscribed=t,t?(s=null!=(null!=(u=function(){var t,n,i,r;for(i=this.tocSections,r=[],t=0,n=i.length;n>t;t++)a=i[t],a.remoteid===e.remoteid&&r.push(a);return r}.call(i))?u[0]:void 0),s||(l=i.tocSections.filter(function(e){return e.remoteid!==r.IDENTIFIERS.coverStories}),l.unshift(e),i.updateTocSections(l,!1),o=!0)):i.tocSections=i.tocSections.filter(function(t){return s=e.remoteid===t.remoteid,s&&(o=!0),!s}),n?i.emit("user:updated"):void 0},n(!0,!1),t=this.putTocSectionsToState().then(function(e){return n(!0),e})["catch"](function(e){return n(!1)}))},t.prototype.unsubscribe=function(e){var t,n=this;return this.tocSections=this.tocSections.filter(function(t){return t.remoteid!==e.remoteid
}),t=this.putTocSectionsToState(),t.then(function(e){return e.success?n.emit("user:updated"):void 0}),t},t.prototype.updateFromUserInfo=function(e){var t,n,i,o,s,l,u,c,d;return null==e&&(e={}),i=null!=(s=e.myServices)?s:{},t=null!=(l=function(){var e,t,r;for(r=[],e=0,t=i.length;t>e;e++)n=i[e],"flipboard"===n.service&&r.push(n);return r}())?l[0]:void 0,o=null!=(u=function(){var t,i,r,o,s;for(o=null!=(r=e.states)?r:[],s=[],t=0,i=o.length;i>t;t++)n=o[t],"user"===n.type&&s.push(n);return s}())?u[0]:void 0,this.loaded=!0,this.isAnonymous=null==t,this.isAnonymous&&console.log("Got Anonymous userInfo userid:"+e.userid+",  name:"+e.name+" services:"+JSON.stringify(i)),this.isAnonymous&&this.userid===e.userid||(this.services=i),this.isAnonymous||(this.description=t.description,this.profileImage=t.profileImage,this.email=t.email,this.screenname=t.screenname),this.contributorMagazines=(null!=(c=e.contributorMagazines)?c:[]).map(r.find),this.userid=e.userid,this.name=e.name,this.magazines=(null!=(d=e.magazines)?d:[]).map(function(e){var t,n,i,o,s;for(n=r.find(e),s=r.STALE_METADATA_KEYS,i=0,o=s.length;o>i;i++)t=s[i],n[t]=e[t];return n}),this.updateUserState(o),this.save(),a.setUser(this)},t.prototype.updateUserState=function(e){var t,n,i;return this.userState=null!=e?e:{data:{}},this.mutedAuthors=null!=(i=null!=e?e.data.mutedAuthors:void 0)?i:[],this.mutedAuthorsForSectionIdentifiers=null!=e?e.data.mutedAuthorsForSectionIdentifiers:void 0,this.updateTocSections(null!=e?e.data.tocSections:void 0,!1),e&&(t=e.revision,n=t!==this.revision,this.revision=t,n)?this.emit("user:updated"):void 0},t.prototype.updateTocSections=function(e,t){var n,i,o,s,a,l,u,c,d;if(null==t&&(t=!0),null==e)return[];for(o=this.tocSections,n=r.find(r.IDENTIFIERS.coverStories),this.tocSections=e.map(function(e){return e instanceof r?e:(null==e.displayName&&(e.displayName=e.title),r.find(e.remoteid).update(e))}),this.tocSections=this.tocSections.filter(function(e){return null!=e.remoteid}),this.tocSections.unshift(n),d=this.tocSections,l=u=0,c=d.length;c>u;l=++u)a=d[l],a.subscribed=!0,l>=v&&(a.shouldPersist=!1);return t&&(null!=o?o.length:void 0)>0&&(i=o.map(function(e){return e.remoteid}),s=this.tocSections.map(function(e){return e.remoteid}),y.arrayCompare(i,s)||this.emit("user:updated")),this.tocSections},t.prototype.encodeTocSections=function(){return this.tocSections.filter(function(e){return e.remoteid!==r.IDENTIFIERS.coverStories}).map(function(e){return e.metadata})},t.prototype.putState=function(e,t){var n,i,r,o,s=this;if(null==t&&(t={}),null!=this.userState){for(n in e)o=e[n],this.userState.data[n]=o;i={type:"user",revision:this.revision,data:JSON.stringify(this.userState.data)};for(n in t)o=t[n],i[n]=o;return r=a.post("social/putState",i),r.then(function(e){return e.success?(s.revision=e.revision,s.save()):void 0})["catch"](function(e){null!=e.success&&e.state&&e.state.revision>s.revision&&s.updateUserState(e.state)}),r}},t.prototype.putTocSectionsToState=function(){var e;return e=this.encodeTocSections(),this.putState({tocSections:e})},t.prototype.isSectionProfile=function(e){return e.remoteid==="flipboard/user%2F"+this.userid},t.prototype.invalidateProfileSection=function(){var e;return null!=(e=r.profileSection(this))?e.needsReload=!0:void 0},t.prototype.updateAccountProfile=function(e){var t,n,i,r,o,s,u,c=this;return this.isSignedIn()?(r={},i="name"in e?e.name:this.name,i&&(r.realName=i),t="description"in e?e.description:this.description,t&&(r.description=t),n="profileImageURL"in e?e.profileImageURL:null!=(s=this.profileImage)?s.smallURL:void 0,n&&(r.image=n),r.realName===this.name&&r.description===this.description&&r.image===(null!=(u=this.profileImage)?u.smallURL:void 0)?l.resolve():(o=a.post("flipboard/updateAccountProfile",r),o.then(function(e){return e.success?(c.name=r.realName,c.description=r.description,c.profileImage={smallURL:r.image},c.emit("user:updated"),h.userUpdated(c)):void 0}),o)):l.reject()},t.prototype.hasMagazines=function(){return this.magazines.length>0},t.prototype.ownsMagazine=function(e){var t;return null!=e&&null!=function(){var n,i,r,o,s;for(o=null!=(r=this.magazines)?r:[],s=[],n=0,i=o.length;i>n;n++)t=o[n],t.remoteid===e.remoteid&&s.push(t);return s}.call(this)[0]},t.prototype.addMagazine=function(e){return null==this.magazines&&(this.magazines=[]),this.magazines.unshift(e),this.invalidateProfileSection()},t.prototype.removeMagazine=function(e){var t;return(null!=(t=this.magazines)?t.length:void 0)>0?(this.magazines=this.magazines.filter(function(t){return t.magazineTarget!==e.magazineTarget}),this.reload(),this.invalidateProfileSection()):void 0},t.prototype.getMagazine=function(e){var t,n,i,r,o;for(o=null!=(r=this.magazines)?r:[],n=0,i=o.length;i>n;n++)if(t=o[n],t.remoteid===e)return t;return null},t.prototype.getMagazineByTarget=function(e){var t,n,i,r,o;for(o=null!=(r=this.magazines)?r:[],n=0,i=o.length;i>n;n++)if(t=o[n],t.magazineTarget===e)return t;return null},t.prototype.flagHelper=function(e){var t,n,i,r,o;return null==e&&(e={}),o=l.defer(),r=o.resolve,i=o.reject,n=o.promise,t=[],t.push({label:g.t("cancel_button"),id:"cancel",default_cancel:!0}),t.push({label:g.t("flag_inappropriate_confirm_button"),id:"ok",default_confirm:!0}),h.showDialog(g.t("flag_inappropriate_confirm_title"),g.t("flag_inappropriate_confirm_message"),t).then(function(t){return"ok"===t?(e.type="inappropriate",a.post("social/flagItem",e).then(function(e){return r()})["catch"](function(e){return i()})):void 0}),n},t.prototype.flagItem=function(e){var t;return t={oid:e.id,url:e.sourceURL,section:e.sectionID},this.flagHelper(t).then(function(){return s.setFlagItem(e)})},t.prototype.flagSection=function(e){var t;return t={section:e.remoteid},this.flagHelper(t)},t.prototype.loadNotifications=function(){var e,t=this;return e=r.find(r.IDENTIFIERS.notifications),e.loadItems().then(function(){return e=r.find(r.IDENTIFIERS.notifications),t.notifications=e.items,t.emit("user:notificationsUpdated")})},t.prototype.loadUnreadCounts=function(){var e=this;return a.get("social/unreadCount",{service:"flipboard"}).then(function(t){var n;if(t.success)return n=t.unreadcounts[r.IDENTIFIERS.notifications],e.notificationUnreadCount=n,e.emit("user:notificationUnreadCountUpdated",{unreadCount:n})})},t.prototype.updateNotificationUnreadCount=function(e){var t,n,i;if((null!=(i=this.notifications)?i.length:void 0)>0)return n=null,this.notificationUnreadCount=e,this.emit("user:notificationUnreadCountUpdated",{unreadCount:e}),t={service:"flipboard",sectionid:r.IDENTIFIERS.notifications,oid:this.notifications.map(function(e){return e.id})},a.post("social/read",t)},t.prototype.isItemMutedInList=function(e,t){var n,i,r;for(null==t&&(t=[]),i=0,r=t.length;r>i;i++)if(n=t[i],y.strExistMatch(n.serviceName,e.service)){if(y.strExistMatch(n.authorUsername,e.authorUsername))return!0;if(y.strExistMatch(n.authorID,e.authorID))return!0}return!1},t.prototype.isItemMutedInSectionOrGlobally=function(e,t){return null==e?!1:this.isItemMutedInList(e,this.mutedAuthorsForSectionIdentifiers[t])?!0:this.isItemMutedInList(e,this.mutedAuthors)?!0:!1},t.prototype.isItemMuted=function(e){return this.isItemMutedInSectionOrGlobally(e,e.sectionID)?!0:this.isItemMutedInSectionOrGlobally(e.attr,e.sectionID)?!0:!1},t.prototype.unmutedSectionItems=function(e){var t=this;return e.items.filter(function(e){return!t.isItemMuted(e)})},t.prototype.updateServices=function(e){var t=this;return this.services=e,this.save(),b(function(){return t.emit("user:updated")})},t.prototype.addService=function(e){var t=this;return this.findService(e)||this.services.push(e),this.save(),b(function(){return t.emit("user:updated")})},t.prototype.removeService=function(e,t){var n,i,r,o,s,u=this;return s=l.defer(),o=s.resolve,r=s.reject,i=s.promise,n=[],n.push({label:g.t("cancel_button"),id:"cancel",default_cancel:!0}),n.push({label:g.t("SIGN_OUT_LINK"),id:"ok",default_confirm:!0}),h.showDialog(g.t("confirm_sign_out_title_format",t),g.t("confirm_sign_out_msg_format",t),n).then(function(t){var n;return"ok"===t?(n={service:e},a.post("users/removeService",n).then(function(t){var n,i,r,s,a;if(!(null!=t?t.success:void 0))throw new Error("Failed removing service");for(a=u.services,n=r=0,s=a.length;s>r;n=++r)if(i=a[n],i.service===e){u.services.splice(n,1);break}return u.tocSections=u.tocSections.filter(function(t){return null==t.service||t.service!==e}),u.putTocSectionsToState(),o(t),b(function(){return u.emit("user:updated")})})["catch"](function(e){return r()})):void 0}),i},t.prototype.shareableServices=function(){return this.services.filter(function(e){return i.indexOf(e.service)>-1})},t.prototype.findService=function(e){var t,n;return null!=(n=function(){var n,i,r,o,s;for(o=null!=(r=this.services)?r:[],s=[],n=0,i=o.length;i>n;n++)t=o[n],t.service===e&&s.push(t);return s}.call(this))?n[0]:void 0},t.prototype.isServiceConnected=function(e){return null!=this.findService(e)},t.prototype.flipItem=function(e,t,n){var i,r,o,s;return null==n&&(n={}),s=l.defer(),i=s.promise,o=s.resolve,r=s.reject,n.url=e.sourceURL,n.oid=e.id,null==n.target&&(n.target=[]),n.target.push(t.magazineTarget),a.post("social/shareWithComment",n).then(function(e){return e.success?o():r("Unable to flip item")})["catch"](function(e){return r(e)}),i},t.prototype.createMagazine=function(e,t,n,i){var o,s,u,c,d,p=this;return d=l.defer(),s=d.promise,c=d.resolve,u=d.reject,o={},o.title=e,o.description=t,null!=n&&(o.magazineCategory=n),o.magazineVisibility=i?"public":"private",a.post("curator/createMagazine",o).then(function(e){var t;return e.success?(t=r.find(e.magazine),p.addMagazine(t),p.reload(),c(t)):u("Unable to create magazine")})["catch"](function(e){return u(e)}),s},t.prototype.getId=function(e){var t;return null!=(t=e.userID)?t:e.userid},t.prototype.isFollowing=function(e){var t,n,i,r;for(r=this.following,n=0,i=r.length;i>n;n++)if(t=r[n],this.getId(t)===this.getId(e))return!0;return!1},t.prototype.loadFollowing=function(){var e,t=this;return e={service:"flipboard",serviceUserid:this.userid},a.get("social/follows",e).then(function(e){return e.success?(t.following=e.items,t.save()):void 0})["catch"](function(e){return console.error(e)})},t.prototype.loadFollowers=function(){var e,t=this;return e={service:"flipboard",serviceUserid:this.userid},a.get("social/followers",e).then(function(e){return e.success?(t.followers=e.items,t.save()):void 0})["catch"](function(e){return console.error(e)})},t.prototype.followUser=function(e){var t,n,i=this;return t={service:"flipboard",serviceUserid:this.getId(e)},n=a.post("social/follow",t),n.then(function(t){return t.success?(i.following.push(e),i.save()):void 0})["catch"](function(e){return console.error(e)}),n},t.prototype.unfollowUser=function(e){var t,n,i=this;return t={service:"flipboard",serviceUserid:this.getId(e)},n=a.post("social/unfollow",t),n.then(function(t){return t.success?(i.following=i.following.filter(function(t){return t.userID!==e.userID}),i.save()):void 0})["catch"](function(e){return console.error(e)}),n},t.prototype.subscribeAll=function(e){var t,n,i=this;return null==e&&(e=[]),e=e.filter(function(e){return null!=e.remoteid&&!i.isSubscribed(e)}),e.length>0?(n=function(t,n){var o,s,a,l,u,c,d;if(null==t&&(t=!0),null==n&&(n=!0),o=!1,t){for(a=i.tocSections.filter(function(e){return e.remoteid!==r.IDENTIFIERS.coverStories}),l=0,c=e.length;c>l;l++)s=e[l],s.subscribed=t,a.unshift(s);i.updateTocSections(a,!1),o=!0}else for(u=0,d=e.length;d>u;u++)s=e[u],i.tocSections=i.tocSections.filter(function(e){return o||(o=s.remoteid===e.remoteid)});return n?i.emit("user:updated"):void 0},n(!0,!1),t=this.putTocSectionsToState().then(function(e){return n(!0),e})["catch"](function(e){return n(!1)})):l.reject()},t}(t),y.mixin(o,f.Emitter),e.exports=o,e.exports.current=d}),require.define("app/lib/usage",function(e,t){var n,i,r,o,s,a,l,u,c,d,p,h,f,m,g,v,y,b=function(e,t){return function(){return e.apply(t,arguments)}};p=require("blend/jsonp"),d=require("blend/i18n"),r=require("blend/async"),a=require("blend/events"),l=require("blend/features"),c=require("blend/http"),i=require("app/models/user"),s=require("devices"),u=require("app/lib/helpers"),o=null,h="1.0.0",f=12,g=13,m=14,n=function(){function e(e){null==e&&(e={}),this.processQueue=b(this.processQueue,this),this.emit=b(this.emit,this),this.sessionInit=b(this.sessionInit,this),this.host=e.host||"ue.flipboard.com",this.prod_type=e.prod_type||"windows",this.appmode=e.appmode,this.queue=[],this.statePromise=void 0,this.session=null,this.protocol="https:"===window.location.protocol?"https:":"http:",this.gitSHA=v(),null!=e.abTests&&(this.abTests=e.abTests)}return e.prototype.sessionInit=function(){var e=this;return this.statePromise||(this.statePromise=p.request({url:""+this.protocol+"//"+this.host+"/setcookie"}),this.statePromise.then(function(t){e.session=t})),this.statePromise},e.prototype.emit=function(e,t,n,i){var r,o;return null==n&&(n={}),null==i&&(i=!0),r={time:Math.round(Date.now()),uid:this.userId(),app_version:s.getValue("ver"),git_version:this.gitSHA,lang:d.languageCode(),device_model:s.getValue("manufacturer"),device_version:s.getValue("model"),time_offset:-(new Date).getTimezoneOffset(),refer_url:document.referrer,appmode:s.getValue("device"),win_size:""+window.innerWidth+"x"+window.innerHeight},null!=this.appmode&&(r.appmode=this.appmode),(null!=(o=this.abTests)?o.length:void 0)&&(r.ab_tests=this.abTests.join(",")),s.getValue("oempreload")&&(r.oem_preload=s.getValue("oempreload")),this.queue.push({event_action:e,event_category:t,event_data:n,properties:r}),i?this.processQueue():null},e.prototype.userId=function(){return i.current().isSignedIn()?i.current().userid:0},e.prototype.processQueue=function(){var e,t=this;return e=this.sessionInit(),e.then(function(){var n;return 0===t.queue.length?e:(n={params:{data:JSON.stringify(t.queue),prod_type:t.prod_type,unique_id:t.session.unique_id.toString(),session_id:t.session.session_id.toString()},url:""+t.protocol+"//"+t.host+"/usage"},t.queue=[],p.request(n))})},e.prototype.gaSetCustomDimension=function(e,t){var n;return n=window.ga,null!=n?n("set","dimension"+e,t):void 0},e.prototype.gaEmit=function(e,t,n){var r,o,s,a,l;return null==n&&(n=""),s=window.ga,null!=s?(a={},a["dimension"+g]=1,s("send","event",e,t,n,a)):(o=["_setCustomVar",g,"User",i.current().isSignedIn(),3],r=["_trackEvent",e,t,n],l=null!=window._gaq?window._gaq:window._gaq=[],l.push(o),l.push(r))},e.prototype.gaPageView=function(e){var t,n,i,r,o,s;return r=window.location.protocol+"//"+window.location.hostname+window.location.pathname+window.location.search,s=window.location.pathname+window.location.search,o={location:r,page:s},o.title=(null!=e?e.title:void 0)||document.title,o["dimension"+g]=1,null!=e&&(n=e.feedType,i=e.isNglPromoted,t=i?""+n+"-nglPromoted":n,o["dimension"+f]=t),"function"==typeof ga?ga("send","pageview",o):void 0},e.prototype.gaSetTrackingId=function(e){return"function"==typeof ga?ga("create",e,"auto"):void 0},e.prototype.gaEmitButtonClick=function(e){var t,n;return n="button",t="click",this.gaEmit(n,t,e)},e.prototype.gaEmitFormSubmit=function(e){var t,n;return n="form",t="submit",this.gaEmit(n,t,e)},e.prototype.gaEmitEventTriggered=function(e){var t,n;return n="event",t="triggered",this.gaEmit(n,t,e)},e.prototype.setABTests=function(e){var t;return this.abTests=e,null!=this.abTests?(t=e.reduce(function(e,t,n){var i;return i=0===n?"":",",t?""+e+i+t:e},""),this.gaSetCustomDimension(m,t)):void 0},e}(),v=function(){var e,t;return t="HEAD",e=document.querySelector("meta[name='version']"),null!=e&&(t=e.content),t},t.current=function(){var e,t;return o||(t=c.parseQuery(u.location.search,!0),e={},t.ue_host&&(e={host:t.ue_host}),o=new n(e)),o},t.resetUsage=function(){return o=null},t.emit=function(e,n,i,r){return null==i&&(i={}),null==r&&(r=!0),t.current().emit(e,n,i,r)},t.gaEmit=function(){return t.current().gaEmit.apply(t.current(),arguments)},t.gaEmitButtonClick=t.current().gaEmitButtonClick,t.gaEmitFormSubmit=t.current().gaEmitFormSubmit,t.gaEmitEventTriggered=t.current().gaEmitEventTriggered,t.section=function(e,t){return e.section_id=null!=t?t.remoteid:void 0,e.partner_id=null!=t?t.partnerId:void 0,e},t.item=function(e,n,i){return t.section(e,i),e.item_id=n.id,e.item_partner_id=null!=n?n.partnerID:void 0,e},t.setUsage=function(e){return o=e},y={host:"undefined"!=typeof TEST_USAGE&&null!==TEST_USAGE?"ue-test.flipboard.com":"ue.flipboard.com",prod_type:"web"},t.webUsage=new n(y),t.Usage=n}),require.define("magazineCover",function(){var e,t,n,i,r,o;r=require("app/lib/usage"),n={prod_type:"webwidget"},i=null,document.referrer&&(i=document.referrer.match(/https?\:\/\/([-\w\.]*)/)),id1&&id2&&(e={section_id:id2,web_nonce_section_id:id1,url:document.location.href,partner_id:"",refer_url:""},i&&i.length>1&&(e.refer_url=i[1]),o=new r.Usage(n),r.setUsage(o),o.emit("display","widget",e,!0),t=document.getElementById("maglink"),t.addEventListener("click",function(t){var n,i;for(i=t.target||t.currentTarget;"a"!==i.tagName.toLowerCase()&&i.parentElement;)i=i.parentElement;return n=i.href,o.emit("click","widget",e,!0)},!1))});